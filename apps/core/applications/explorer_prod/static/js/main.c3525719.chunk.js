(this.webpackJsonpexplorer=this.webpackJsonpexplorer||[]).push([[0],{15:function(e,t){e.exports={"@primary-color":"#0F97E4","@default-bg":"#FFF","@default-text-color":"#000","@error-color":"#e02020","@divider-color":"rgba(0, 0, 0, 6%)","@item-active-bg":"#e5e5e5","@item-hover-bg":"#f5f5f5","@btn-primary-bg":"transparent linear-gradient(180deg, #2CCEFF 0%, #0A8EE0 100%) 0% 0% no-repeat padding-box","@card-background":"@default-bg","@table-bg":"@default-bg","@pagination-item-bg":"@default-bg","@pagination-item-bg-active":"@default-bg","@pagination-item-link-bg":"@default-bg","@pagination-item-input-bg":"@default-bg","@border-color-base":"#D9D9D9","@border-radius-base":"4px","@list-footer-background":"@background-color-light","@background-color-light":"#FAFAFA","@leav-secondary-bg":"#f0f0f0","@leav-secondary-action-bg":"#F4F4F4","@leav-background-active":"#DEF4FF","@leav-view-panel-label-background-active":"#C6E2FF","@leav-view-panel-background-title":"#F4F4F4","@leav-primary-btn-border":"0.699999988079071px solid #0F97E4","@leav-primary-btn-bg-hover":"transparent linear-gradient(0deg, #2cceff 0%, #0a8ee0 100%) 0% 0% no-repeat padding-box","@leav-secondary-divider-color":"#C7C7C7","@leav-secondary-gradient-bg":"transparent linear-gradient(180deg, #FFFFFF 0%, #F4F4F4 100%) 0% 0% no-repeat padding-box;","@leav-secondary-item-background":"#FAFAFA","@leav-small-shadow":"0px 3px 6px #58585812;","@leav-border":"0.699999988079071px solid #C7C7C7;","@leav-header-height":"3rem","@leav-secondary-font-color":"rgba(0, 0, 0, 0.5)","@leav-navigation-column-width":"20rem","@leav-navigation-column-details-width":"30rem"}},310:function(e,t,n){e.exports={loginBackground:"login_loginBackground__2-wQB",Gradient:"login_Gradient__1f0hc",loginContainer:"login_loginContainer__29Lqv",loginHeader:"login_loginHeader__BmrW1",loginBlock:"login_loginBlock__3QeEo"}},378:function(e,t){},513:function(e,t,n){},570:function(e,t){},571:function(e,t){},579:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorTypes=void 0,function(e){e.VALIDATION_ERROR="VALIDATION_ERROR",e.PERMISSION_ERROR="PERMISSION_ERROR",e.INTERNAL_ERROR="INTERNAL_ERROR"}(t.ErrorTypes||(t.ErrorTypes={}))},580:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FORM_ROOT_CONTAINER_ID=t.TabsDirection=t.FormFieldTypes=t.FormUIElementTypes=void 0,function(e){e.DIVIDER="divider",e.FIELDS_CONTAINER="fields_container",e.TAB_FIELDS_CONTAINER="tab_fields_container",e.TEXT_BLOCK="text_block",e.TABS="tabs"}(t.FormUIElementTypes||(t.FormUIElementTypes={})),function(e){e.TEXT_INPUT="input_field",e.DATE="date",e.CHECKBOX="checkbox",e.ENCRYPTED="encrypted",e.DROPDOWN="dropdown",e.LINK="link",e.TREE="tree"}(t.FormFieldTypes||(t.FormFieldTypes={})),function(e){e.HORIZONTAL="horizontal",e.VERTICAL="vertical"}(t.TabsDirection||(t.TabsDirection={})),t.FORM_ROOT_CONTAINER_ID="__root"},581:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},582:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.isFileAllowed=t.getGraphqlQueryNameFromLibraryName=t.getGraphqlTypeFromLibraryName=void 0;var i=n(65),a=r(n(583));t.getGraphqlTypeFromLibraryName=function(e){return i.flow([i.camelCase,i.upperFirst,i.trimEnd,i.partialRight(i.trimEnd,"s")])(e)};t.getGraphqlQueryNameFromLibraryName=function(e){return i.flow([i.camelCase,i.trimEnd])(e)};t.isFileAllowed=function(e,t,n,r){t.length||(t=["**"]);var i=t.some((function(t){return a.default(r,"".concat(e,"/").concat(t))}));return!n.some((function(t){return a.default(r,"".concat(e,"/").concat(t))}))&&i}},59:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(579),t),i(n(580),t),i(n(581),t),i(n(582),t)},716:function(e,t,n){},717:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(242),l=n(53),c=n.n(l),o=n(10),s="accessToken";function d(){var e=window.sessionStorage;return{getToken:function(){var t;return null!==(t=e.getItem(s))&&void 0!==t?t:""},saveToken:function(t){e.setItem(s,t)},deleteToken:function(){e.removeItem(s)}}}var u,b,j,v,O,f,p,h,m,g,x,y,E,_,T,S,w,I=n(759),k=n(760),R=n(761),A=n(753),C=n(739),N=n(747),L=n(754),V=n(255),D=n(69),F=n(755),P=n(310),U=n.n(P),B=n(1),H=function(e){return function(t){e(t.target.value)}},z=function(e){var t=e.onSuccess,n=e.message,i=e.url,a=Object(F.a)().t,l=Object(r.useState)(""),c=Object(o.a)(l,2),s=c[0],d=c[1],u=Object(r.useState)(""),b=Object(o.a)(u,2),j=b[0],v=b[1],O=Object(r.useState)(!1),f=Object(o.a)(O,2),p=f[0],h=f[1],m=Object(r.useState)(""),g=Object(o.a)(m,2),x=g[0],y=g[1],E=i,_=Object(r.useCallback)((function(){h(!0),y(""),setTimeout((function(){!function(e,t,n,r,i,a){fetch(e,{method:"POST",headers:new Headers([["Content-Type","application/json"]]),body:JSON.stringify({login:t,password:n})}).then((function(e){if(e.ok)return e;if(401===e.status)throw new Error("bad_credentials");throw new Error("no_server_response")}),(function(e){throw new Error("no_server_response")})).then((function(e){return e.json()})).then((function(e){r(!1),i(e.token)})).catch((function(e){r(!1),a(e.message)}))}(E,s,j,h,t,y)}),2e3)}),[t,E,s,j]);return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("div",{className:U.a.loginBackground}),Object(B.jsx)("div",{className:U.a.loginContainer,children:Object(B.jsxs)(A.a,{title:Object(B.jsx)("h2",{children:a("login.header")}),style:{width:"30rem"},children:[Object(B.jsxs)(C.a,{children:[Object(B.jsx)(C.a.Item,{children:Object(B.jsx)(N.a,{prefix:Object(B.jsx)(I.a,{}),type:"text",name:"email",placeholder:a("login.email"),autoFocus:!0,value:s,onChange:H(d)})}),Object(B.jsx)(C.a.Item,{children:Object(B.jsx)(N.a,{prefix:Object(B.jsx)(k.a,{}),type:"password",name:"password",placeholder:a("login.password"),value:j,onChange:H(v)})}),Object(B.jsx)(C.a.Item,{children:p?Object(B.jsx)(L.a,{message:a("login.loading.header"),description:a("login.loading.text"),icon:Object(B.jsx)(V.a,{}),type:"warning",showIcon:!0}):Object(B.jsx)(D.a,{size:"large",type:"primary",loading:p,disabled:p,onClick:_,htmlType:"submit",icon:Object(B.jsx)(R.a,{}),block:!0,children:a("login.submit")})})]}),x?Object(B.jsx)(L.a,{message:a("login.apologize"),description:a("login.error."+x),type:"error",showIcon:!0}):null,n?Object(B.jsx)(L.a,{message:a("login.apologize"),description:a(n),type:"warning",showIcon:!0}):null]})})]})},G=n(122),M=n(109),$=n(6);!function(e){e.boolean="boolean",e.date="date",e.date_range="date_range",e.encrypted="encrypted",e.extended="extended",e.numeric="numeric",e.text="text"}(u||(u={})),function(e){e.advanced="advanced",e.advanced_link="advanced_link",e.simple="simple",e.simple_link="simple_link",e.tree="tree"}(b||(b={})),function(e){e.field="field",e.layout="layout"}(j||(j={})),function(e){e.BEGIN_WITH="BEGIN_WITH",e.BETWEEN="BETWEEN",e.CLASSIFIED_IN="CLASSIFIED_IN",e.CONTAINS="CONTAINS",e.END_AFTER="END_AFTER",e.END_BEFORE="END_BEFORE",e.END_ON="END_ON",e.END_WITH="END_WITH",e.EQUAL="EQUAL",e.GREATER_THAN="GREATER_THAN",e.IS_EMPTY="IS_EMPTY",e.IS_NOT_EMPTY="IS_NOT_EMPTY",e.LAST_MONTH="LAST_MONTH",e.LESS_THAN="LESS_THAN",e.NEXT_MONTH="NEXT_MONTH",e.NOT_CLASSIFIED_IN="NOT_CLASSIFIED_IN",e.NOT_CONTAINS="NOT_CONTAINS",e.NOT_EQUAL="NOT_EQUAL",e.START_AFTER="START_AFTER",e.START_BEFORE="START_BEFORE",e.START_ON="START_ON",e.TODAY="TODAY",e.TOMORROW="TOMORROW",e.VALUES_COUNT_EQUAL="VALUES_COUNT_EQUAL",e.VALUES_COUNT_GREATER_THAN="VALUES_COUNT_GREATER_THAN",e.VALUES_COUNT_LOWER_THAN="VALUES_COUNT_LOWER_THAN",e.YESTERDAY="YESTERDAY"}(v||(v={})),function(e){e.AND="AND",e.CLOSE_BRACKET="CLOSE_BRACKET",e.OPEN_BRACKET="OPEN_BRACKET",e.OR="OR"}(O||(O={})),function(e){e.asc="asc",e.desc="desc"}(f||(f={})),function(e){e.BIG="BIG",e.MEDIUM="MEDIUM",e.SMALL="SMALL"}(p||(p={})),function(e){e.cards="cards",e.list="list",e.timeline="timeline"}(h||(h={})),function(e){e.library="library",e.tree="tree"}(m||(m={})),function(e){e.tiny="tiny",e.small="small",e.medium="medium",e.big="big",e.huge="huge",e.pages="pages"}(g||(g={})),function(e){e.small="small",e.medium="medium",e.big="big"}(x||(x={})),function(e){e.en="en",e.fr="fr"}(y||(y={})),function(e){e.filter="filter",e.separator="separator"}(E||(E={})),function(e){e.ATTRIBUTE="ATTRIBUTE",e.TREE="TREE",e.LIBRARY="LIBRARY"}(_||(_={})),function(e){e.AND="AND",e.OR="OR",e.OPEN_BRACKET="OPEN_BRACKET",e.CLOSE_BRACKET="CLOSE_BRACKET"}(T||(T={})),function(e){e.CLASSIFIED_IN="CLASSIFIED_IN",e.NOT_CLASSIFIED_IN="NOT_CLASSIFIED_IN"}(S||(S={})),function(e){e.THROUGH="THROUGH"}(w||(w={}));var W,Y,q,Q,K,X,J,Z=Object($.a)(Object($.a)({},v),w);!function(e){e.DESC="DESC",e.ASC="ASC"}(W||(W={})),function(e){e.basic="basic",e.success="success",e.warning="warning",e.error="error"}(Y||(Y={})),function(e){e.low="low",e.medium="medium",e.high="high"}(q||(q={})),function(e){e.trigger="trigger",e.passive="passive"}(Q||(Q={})),function(e){e.filters="filters",e.view="view"}(K||(K={})),function(e){e[e.navigation=0]="navigation",e[e.search=1]="search"}(X||(X={})),function(e){e.HOME="home",e.LIBRARY="library",e.TREE="tree"}(J||(J={}));var ee,te,ne=Object(M.b)({name:"activePanel",initialState:J.HOME,reducers:{setActivePanel:function(e,t){return t.payload}}}),re=ne.actions.setActivePanel,ie=ne.reducer,ae={side:{visible:!1,type:K.filters}},le=Object(M.b)({name:"display",initialState:ae,reducers:{setDisplaySide:function(e,t){e.side=t.payload}}}),ce=le.actions.setDisplaySide,oe=le.reducer,se=Object(M.b)({name:"display",initialState:{activeTree:"",path:[]},reducers:{setNavigationActiveTree:function(e,t){e.activeTree!==t.payload&&(e.activeTree=t.payload,e.path=[])},setNavigationPath:function(e,t){e.path=t.payload}}}),de=se.actions,ue=de.setNavigationActiveTree,be=de.setNavigationPath,je=se.reducer,ve=n(21),Oe={stack:[],base:{content:"",type:Y.basic}},fe=Object(M.b)({name:"notifications",initialState:Oe,reducers:{setNotificationBase:function(e,t){e.base=t.payload},setNotificationStack:function(e,t){e.stack=t.payload},addNotification:function(e,t){e.stack=[].concat(Object(ve.a)(e.stack),[t.payload])}}}),pe=fe.actions,he=pe.setNotificationBase,me=pe.setNotificationStack,ge=pe.addNotification,xe=fe.reducer,ye=function(e,t){if(e.selected.find((function(e){return e.id===t.elementSelected.id&&e.library===t.elementSelected.library}))){if(t.selectionType===X.navigation)return{parent:t.parent,type:t.selectionType,selected:e.selected.filter((function(e){return e.id!==t.elementSelected.id||e.library!==t.elementSelected.library}))};if(t.selectionType===X.search)return{allSelected:!1,type:t.selectionType,selected:e.selected.filter((function(e){return e.id!==t.elementSelected.id||e.library!==t.elementSelected.library}))}}return t.selectionType===X.navigation?{parent:t.parent,type:t.selectionType,selected:[].concat(Object(ve.a)(e.selected),[t.elementSelected])}:t.selectionType===X.search?{allSelected:!1,type:t.selectionType,selected:[].concat(Object(ve.a)(e.selected),[t.elementSelected])}:e},Ee={selection:{type:X.search,selected:[]},searchSelection:{type:X.search,selected:[]}},_e=Object(M.b)({name:"filters",initialState:Ee,reducers:{setSelection:function(e,t){e.selection=t.payload},resetSelection:function(e){e.selection.selected=[],e.selection.type===X.search&&e.selection.allSelected&&(e.selection.allSelected=!1)},setSelectionAllSelected:function(e,t){e.selection.type===X.search&&(e.selection.allSelected=t.payload)},setSelectionToggleSelected:function(e,t){e.selection=ye(e.selection,t.payload)},setSearchSelection:function(e,t){e.searchSelection=t.payload},resetSearchSelection:function(e){e.searchSelection.selected=[],e.searchSelection.allSelected=!1},setSelectionToggleSearchSelectionElement:function(e,t){var n=ye(e.searchSelection,{selectionType:X.search,elementSelected:t.payload});n.type===X.search&&(e.searchSelection=n)}}}),Te=_e.actions,Se=Te.setSelection,we=Te.resetSelection,Ie=(Te.setSelectionAllSelected,Te.setSelectionToggleSelected),ke=Te.setSearchSelection,Re=Te.resetSearchSelection,Ae=Te.setSelectionToggleSearchSelectionElement,Ce=_e.reducer,Ne=Object(M.a)({reducer:{display:oe,selection:Ce,navigation:je,notification:xe,activePanel:ie}}),Le=G.d,Ve=function(){return Object(G.c)()},De=Ne,Fe=n(427),Pe=n(424),Ue=n(741),Be=n(36),He=n(729),ze=n(407),Ge=n(728),Me=n.n(Ge),$e=n(30),We=n(762),Ye=n(763),qe=n(748),Qe=n(8),Ke=n(9),Xe=n(15),Je=n.n(Xe),Ze=Object(Ke.a)((function(e){return Object(B.jsx)(D.a,Object($.a)(Object($.a)({type:"primary"},e),{},{children:e.children}))}))(ee||(ee=Object(Qe.a)(["\n    &&& {\n        border: ",";\n        font-weight: 600;\n\n        &&&&:hover {\n            background: ",";\n        }\n\n        &&&&:active {\n            box-shadow: 0px 3px 6px #5858584d;\n            background: ",";\n        }\n\n        &&&&:focus {\n            box-shadow: 0px 3px 6px #5858584d;\n            background: ",";\n        }\n    }\n"])),Je.a["@leav-primary-btn-border"],Je.a["@leav-primary-btn-bg-hover"],Je.a["@leav-primary-btn-bg-hover"],Je.a["@btn-primary-bg"]),et=n(72);!function(e){e.ERROR="error",e.PERMISSION_ERROR="permission_error"}(te||(te={}));var tt=function(e){var t,n=e.message,r=e.actionButton,i=e.showActionButton,a=void 0===i||i,l=e.type,c=void 0===l?te.ERROR:l,o=Object(F.a)().t,s=Object(et.f)(),d=(t={},Object($e.a)(t,te.ERROR,{title:o("error.error_occurred"),icon:Object(B.jsx)(We.a,{color:"red"}),message:"",actionButton:null}),Object($e.a)(t,te.PERMISSION_ERROR,{title:o("error.access_denied"),icon:Object(B.jsx)(Ye.a,{color:"red"}),message:o("error.access_denied_details"),actionButton:a?Object(B.jsx)(Ze,{onClick:function(){return s.replace("/")},children:o("global.go_back_home")}):null}),t);return Object(B.jsx)(qe.a,{title:d[c].title,subTitle:null!==n&&void 0!==n?n:d[c].message,status:"error",icon:d[c].icon,extra:null!==r&&void 0!==r?r:d[c].actionButton})},nt=n(22),rt=n.n(nt),it=n(38),at="Unauthorized";var lt,ct,ot,st,dt,ut,bt,jt=function(e){var t=e.token,n=e.children,i=e.onTokenInvalid,a=Object(F.a)().t,l=Ve(),c=function(e,t){var n=Object(r.useState)(!0),i=Object(o.a)(n,2),a=i[0],l=i[1],c=Object(r.useState)(),s=Object(o.a)(c,2),d=s[0],u=s[1],b=Object(r.useState)(),j=Object(o.a)(b,2),v=j[0],O=j[1],f=Object(r.useCallback)(Object(it.a)(rt.a.mark((function n(){var r,i,a;return rt.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,fetch(e,{method:"POST",headers:{"Content-Type":"application/json",Authorization:t},body:JSON.stringify({variables:{},query:"\n                  {\n                    __schema {\n                      types {\n                        kind\n                        name\n                        possibleTypes {\n                          name\n                        }\n                      }\n                    }\n                  }\n                "})});case 3:if(401!==(r=n.sent).status){n.next=6;break}throw new Error(at);case 6:return n.next=8,r.json();case 8:i=n.sent.data,a=i.__schema.types.reduce((function(e,t){return t.possibleTypes?Object($.a)(Object($.a)({},e),{},Object($e.a)({},t.name,t.possibleTypes.map((function(e){return e.name})))):e}),{}),l(!1),O(a),n.next=18;break;case 14:n.prev=14,n.t0=n.catch(0),l(!1),u(String(n.t0));case 18:case"end":return n.stop()}}),n,null,[[0,14]])}))),[e,t]);return Object(r.useEffect)((function(){f()}),[f]),{loading:a,error:d,possibleTypes:v}}(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_URL,t),s=c.loading,d=c.error,u=c.possibleTypes;if(s)return Object(B.jsx)(V.a,{});if(d)return d.includes(at)?(i(),Object(B.jsx)(B.Fragment,{})):Object(B.jsx)(tt,{message:d});var b=Object(ze.a)((function(e){var t=e.graphQLErrors,n=e.networkError;if(t&&t.map((function(e){var t,n=e.message,r=e.locations,i=e.path,c=e.extensions,o=a("error.graphql_error_occurred",{error:n,interpolation:{escapeValue:!1}});switch(c.code){case"INTERNAL_ERROR":t={content:o,type:Y.error,channel:Q.trigger};break;case"VALIDATION_ERROR":case"PERMISSION_ERROR":default:t={content:o,type:Y.error,channel:Q.passive}}return l(ge(t)),"[GraphQL error]: Message: ".concat(n,", Location: ").concat(r,", Path: ").concat(i)})),n){401===n.statusCode&&i();var r={content:a("error.network_error_occurred"),type:Y.error,channel:Q.trigger};l(ge(r))}if(!t&&!n){var c={content:a("error.error_occurred"),type:Y.error,channel:Q.trigger};l(ge(c))}})),j=new Fe.a({link:Pe.a.from([b,Me()({uri:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_URL,headers:{Authorization:t}})]),cache:new Ue.a({dataIdFromObject:function(e){if(!u||!u.Record.includes(e.__typename)||!e._id&&!e.id)return Object(Be.b)(e);var t=e._id||e.id;return"".concat(e.__typename,":").concat(String(t))},typePolicies:{EmbeddedAttribute:{keyFields:!1},RecordIdentity:{keyFields:["id","library",["id"]]},Library:{fields:{gqlNames:{merge:function(e,t){return Object($.a)(Object($.a)({},e),t)}}}},Query:{fields:{treeContent:{merge:function(e,t){return Object(ve.a)(t)}}}},Form:{keyFields:["id","library",["id"]]},UserData:{keyFields:["global"],fields:{data:{merge:function(e,t){return Object($.a)(Object($.a)({},e),t)}}}},Tree:{fields:{permissions:{merge:!0}}},TreeNode:{fields:{children:{merge:function(e,t){return t}}}},RecordForm:{keyFields:["id","recordId","library",["id"]]},FormElementWithValues:{keyFields:!1}},possibleTypes:u})});return Object(B.jsx)(He.a,{client:j,children:n})},vt=(n(513),n(412)),Ot=n(42),ft=Object(Ot.b)(lt||(lt=Object(Qe.a)(["\n    fragment RecordIdentity on Record {\n        id\n        whoAmI {\n            id\n            label\n            color\n            library {\n                id\n                label\n                gqlNames {\n                    query\n                    type\n                }\n            }\n            preview {\n                tiny\n                small\n                medium\n                big\n                huge\n                pages\n            }\n        }\n    }\n"]))),pt=Object(Ot.a)(ct||(ct=Object(Qe.a)(["\n    ","\n\n    query ME {\n        me {\n            login\n            ...RecordIdentity\n        }\n    }\n"])),ft),ht=Object(Ot.a)(ot||(ot=Object(Qe.a)(["\n    query GET_ACTIVE_LIBRARY {\n        activeLib @client {\n            id @client\n            name @client\n            filter @client\n            attributes @client\n            gql @client {\n                searchableFields @client\n                query @client\n                type @client\n            }\n            trees\n            permissions @client {\n                access_library @client\n                access_record @client\n                create_record @client\n                edit_record @client\n                delete_record @client\n            }\n        }\n    }\n"]))),mt={id:"",name:"",filter:"",gql:{searchableFields:"",query:"",type:""},attributes:[],trees:[],permissions:{access_library:!0,access_record:!0,create_record:!0,edit_record:!0,delete_record:!0}},gt=function(){var e=Object(vt.a)(ht),t=e.data,n=e.client;return[Object(r.useMemo)((function(){var e;return null!==(e=null===t||void 0===t?void 0:t.activeLib)&&void 0!==e?e:mt}),[t]),Object(r.useCallback)((function(e){n.writeQuery({query:ht,data:{activeLib:Object($.a)(Object($.a)({},e),{},{trees:e.trees.filter((function(e){return e.permissions.access_tree}))})}})}),[n])]},xt=Object(Ot.a)(st||(st=Object(Qe.a)(["\n    query GET_LANG_ALL {\n        lang @client\n        availableLangs @client\n        defaultLang @client\n    }\n"]))),yt=(Object(Ot.a)(dt||(dt=Object(Qe.a)(["\n    query GET_LANG {\n        lang @client\n    }\n"]))),Object(Ot.a)(ut||(ut=Object(Qe.a)(["\n    query GET_AVAILABLE_LANGS {\n        availableLangs @client\n        lang @client\n    }\n"]))),function(){var e=Object(vt.a)(xt),t=e.data,n=e.client,i=Object(r.useMemo)((function(){return(null===t||void 0===t?void 0:t.lang)||[]}),[t]),a=Object(r.useMemo)((function(){return(null===t||void 0===t?void 0:t.availableLangs)||[]}),[t]),l=(null===t||void 0===t?void 0:t.defaultLang)||"",c=Object(r.useCallback)((function(e){var t=(null===e||void 0===e?void 0:e.lang)||i,r=(null===e||void 0===e?void 0:e.availableLangs)||a,c=(null===e||void 0===e?void 0:e.defaultLang)||l;n.writeQuery({query:xt,data:{lang:t,availableLangs:r,defaultLang:c}})}),[n,i,a,l]);return[{lang:i,availableLangs:a,defaultLang:l},c]}),Et=Object(Ot.a)(bt||(bt=Object(Qe.a)(["\n    query GET_USER {\n        userId @client\n        userName @client\n        userPermissions @client\n    }\n"]))),_t=function(){var e=Object(vt.a)(Et),t=e.data,n=e.client;return[t,Object(r.useCallback)((function(e){n.writeQuery({query:Et,data:e})}),[n])]},Tt=n(65),St=n.n(Tt),wt="selection-column",It="infos",kt="22.5rem",Rt={field:"id",order:f.asc},At="fields",Ct={id:"default-view",label:{fr:"Vue par d\xe9faut",en:"Default view"},owner:!0,display:{type:h.list,size:p.MEDIUM},shared:!1,filters:[],sort:Rt},Nt=[u.boolean],Lt=u.text,Vt=20;function Dt(e){return Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_CORE_URL+e}var Ft=function(e){var t=e.replace(/#/g,"");return(299*parseInt(t.substr(0,2),16)+587*parseInt(t.substr(2,2),16)+114*parseInt(t.substr(4,2),16))/1e3>=128?"#000000":"#FFFFFF"},Pt=function(e,t,n){var r=Ut(e,t,n),i=Object(o.a)(r,3),a=i[0],l=i[1],c=i[2],s=function(e){var t=e.toString(16);return 1===t.length?"0"+t:t};return"#".concat(s(a)).concat(s(l)).concat(s(c))},Ut=function(e,t,n){var r,i,a;if(e/=360,n/=100,0===(t/=100))r=i=a=n;else{var l=n<.5?n*(1+t):n+t-n*t,c=2*n-l;r=Bt(c,l,e+1/3),i=Bt(c,l,e),a=Bt(c,l,e-1/3)}return[Math.round(255*r),Math.round(255*i),Math.round(255*a)]},Bt=function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e},Ht=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hsl",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:80,i=0,a=0;a<e.length;a++)i=e.charCodeAt(a)+((i<<5)-i);var l=i%360;switch(t){case"hex":return Pt(l,n,r);case"rgb":var c=Ut(l,n,r),s=Object(o.a)(c,3),d=s[0],u=s[1],b=s[2];return"rgb(".concat(d,",").concat(u,",").concat(b,")");case"hsl":default:return"hsl(".concat(l,", ").concat(n,"%, ").concat(r,"%)")}};var zt,Gt,Mt=function(e,t){if(!e)return"";var n=t[0],r=t[1]?t[1]:"";return e[n]||e[r]||e[Object.keys(e)[0]]||""},$t=function(e){return e===b.simple_link||e===b.advanced_link},Wt=function(e){switch(e){case p.SMALL:return x.small;case p.MEDIUM:return x.medium;case p.BIG:return x.big;default:return x.small}},Yt=[5,10,20,50,100],qt=function(e,t){switch(e.priority){case q.low:switch(t.priority){case q.low:return 0;case q.medium:return 1;case q.high:default:return 1}case q.medium:switch(t.priority){case q.low:return-1;case q.medium:return 0;case q.high:default:return 1}case q.high:switch(t.priority){case q.low:case q.medium:return-1;case q.high:default:return 0}}},Qt=function(e,t){return Object($.a)(Object($.a)({},Object(Tt.pick)(e,["id","label","format","type","multiple_values"])),t)},Kt=Ot.b,Xt=function(e){switch(e){case u.boolean:case u.date:case u.numeric:return Z.EQUAL;case u.encrypted:return Z.IS_EMPTY;case u.text:case u.date_range:case u.extended:default:return Z.CONTAINS}},Jt=function(e){return"".concat(e.whoAmI.library.id,"/").concat(e.id)},Zt=function(e){return"/library/".concat(e)},en=function(e){return"/tree/".concat(e)},tn=function(e,t){return t("record_edition.date_range_value",Object($.a)(Object($.a)({},e),{},{interpolation:{escapeValue:!1}}))},nn=n(734),rn=n(770),an=n(764),ln=n(765),cn=n(771),on=n(772),sn=n(730),dn=n(137),un=n(318),bn=n.n(un),jn=n(769),vn=n(743),On=n(736),fn=n(86),pn=n(264),hn=n(155),mn=n.n(hn),gn=n.p+"static/media/svgEllipsis.773f43ad.svg",xn=Ke.a.img(zt||(zt=Object(Qe.a)(["\n    transform: translate(0px, -1px);\n"]))),yn=function(){return Object(B.jsx)("div",{children:Object(B.jsx)(xn,{src:gn,alt:"icon ellipsis"})})},En=Ke.a.div(Gt||(Gt=Object(Qe.a)(["\n    position: absolute;\n    z-index: 1000;\n    right: 0;\n    top: 0;\n\n    display: flex;\n    justify-content: space-around;\n    padding: 0.5rem;\n\n    & > * {\n        margin: 0 0.2rem;\n        box-shadow: 0px 2px 6px #0000002f;\n    }\n\n    ","\n"])),(function(e){return e.overrideStyle}));var _n,Tn,Sn,wn=function(e){var t=e.actions,n=e.moreActions,r=e.style,i=e.size,a=void 0===i?"small":i,l=Object(F.a)().t;return Object(B.jsxs)(En,{"data-testid":"floating-menu",className:"floating-menu",style:r,onClick:function(e){e.stopPropagation(),e.preventDefault()},children:[t.map((function(e){var t;return Object(B.jsx)(fn.a,{title:e.title,children:null!==(t=e.button)&&void 0!==t?t:Object(B.jsx)(mn.a,{shape:"circle",size:e.size,icon:e.icon,onClick:e.onClick})},e.title)})),(null===n||void 0===n?void 0:n.length)&&Object(B.jsx)(fn.a,{title:l("items_list.table.actions-tooltips.more"),children:Object(B.jsx)(pn.a,{placement:"bottomRight",overlay:Object(B.jsx)(dn.a,{className:"floating-menu-overlay",children:n.map((function(e){return Object(B.jsxs)(dn.a.Item,{children:[e.icon," ",e.title]},e.title)}))}),children:Object(B.jsx)(mn.a,{size:a,icon:Object(B.jsx)(yn,{}),"aria-label":l("floating_menu.more_actions"),title:l("floating_menu.more_actions"),shape:"circle"})})})]})},In=wn,kn=Object(Ot.a)(_n||(_n=Object(Qe.a)(["\n    mutation SAVE_USER_DATA($key: String!, $value: Any, $global: Boolean!) {\n        saveUserData(key: $key, value: $value, global: $global) {\n            global\n            data\n        }\n    }\n"]))),Rn=Object(Ot.a)(Tn||(Tn=Object(Qe.a)(["\n    query GET_USER_DATA($keys: [String!]!, $global: Boolean) {\n        userData(keys: $keys, global: $global) {\n            global\n            data\n        }\n    }\n"]))),An=Object(Ot.a)(Sn||(Sn=Object(Qe.a)(["\n    query GET_LIBRARIES_LIST {\n        libraries {\n            list {\n                id\n                label\n                gqlNames {\n                    query\n                    filter\n                    searchableFields\n                }\n                permissions {\n                    access_library\n                    access_record\n                    create_record\n                    edit_record\n                    delete_record\n                }\n            }\n        }\n    }\n"])));function Cn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onlyAllowed,n=void 0===t||t,i=Object(r.useState)(),a=Object(o.a)(i,2),l=a[0],c=a[1],s=Object(vt.a)(An,{onCompleted:function(e){var t=Object($.a)(Object($.a)({},e),{},{libraries:{list:e.libraries.list.filter((function(e){return!n||e.permissions.access_library}))}});c(t)}});return Object($.a)(Object($.a)({},s),{},{loading:s.loading||!s.loading&&void 0===typeof l,data:l})}var Nn,Ln=n(127),Vn=Ke.a.span(Nn||(Nn=Object(Qe.a)(["\n    cursor: pointer;\n    display: ",";\n\n    ","\n"])),(function(e){return e.isFavorite?"inline":"none"}),(function(e){return e.hoverTrigger?"".concat(e.hoverTrigger,":hover > & {\n        display: inline;\n    }"):""}));var Dn,Fn,Pn,Un,Bn,Hn=function(e){var t=e.isFavorite,n=e.onToggle,r=e.hoverTrigger;return Object(B.jsx)(Vn,{onClick:function(e){e.stopPropagation(),n(t)},isFavorite:t,hoverTrigger:r,"data-testid":"favorite-star",children:t?Object(B.jsx)(an.a,{}):Object(B.jsx)(ln.a,{})})},zn=n(766),Gn=n(767),Mn=n(768),$n=n(751),Wn=n(737),Yn=n(740),qn=n(425),Qn=n(756),Kn=n(222),Xn=n(223),Jn=n(128),Zn=n.n(Jn),er=n(316),tr=n(819),nr=Object(tr.a)(Dn||(Dn=Object(Qe.a)(["\n    query GET_ATTRIBUTES_BY_LIB($library: String!) {\n        attributes(filters: {libraries: [$library]}) {\n            list {\n                id\n                type\n                format\n                label\n                multiple_values\n                ... on LinkAttribute {\n                    linked_library {\n                        id\n                    }\n                }\n                ... on TreeAttribute {\n                    linked_tree {\n                        id\n                        label\n                    }\n                }\n                ... on StandardAttribute {\n                    embedded_fields {\n                        id\n                        format\n                        label\n                    }\n                }\n            }\n        }\n    }\n"]))),rr=Object(Ot.a)(Fn||(Fn=Object(Qe.a)(["\n    mutation IMPORT_EXCEL($file: Upload!, $library: String!, $mapping: [String]!, $key: String) {\n        importExcel(file: $file, library: $library, mapping: $mapping, key: $key)\n    }\n"]))),ir=$n.a.Step,ar=Wn.a.Dragger,lr=Yn.a.Title;!function(e){e[e.SELECT_FILE=0]="SELECT_FILE",e[e.CONFIG=1]="CONFIG",e[e.PROCESSING=2]="PROCESSING",e[e.DONE=3]="DONE"}(Bn||(Bn={}));var cr=Ke.a.div(Pn||(Pn=Object(Qe.a)(["\n    margin-top: 2em;\n"]))),or=Ke.a.div(Un||(Un=Object(Qe.a)(["\n    text-align: center;\n"]))),sr={data:[],mapping:[],key:null,file:null,keyChecked:!1,currentStep:Bn.SELECT_FILE,okBtn:!1};var dr,ur=function(e){var t,n=e.onClose,i=e.open,a=e.library,l=Object(F.a)().t,c=Object(r.useReducer)((function(e,t){return Object($.a)(Object($.a)({},e),t)}),sr),s=Object(o.a)(c,2),d=s[0],u=s[1],j=d.data,v=d.mapping,O=d.key,f=d.file,p=d.keyChecked,h=d.currentStep,m=d.okBtn,g=Ve(),x=yt(),y=Object(o.a)(x,1)[0].lang,E=Object(vt.a)(nr,{variables:{library:a}}).data,_=(null===E||void 0===E||null===(t=E.attributes)||void 0===t?void 0:t.list.filter((function(e){return e.type===b.simple||e.type===b.advanced})).map((function(e){var t;return{id:e.id,label:null!==(t=Mt(null===e||void 0===e?void 0:e.label,y))&&void 0!==t?t:e.id}})))||[],T=Object(sn.a)(rr,{fetchPolicy:"no-cache",onCompleted:function(){u({currentStep:Bn.DONE})},onError:function(e){var t={type:Y.error,priority:q.high,channel:Q.passive,content:"".concat(l("error.error_occurred"),": ").concat(e.message)};g(ge(t)),u({currentStep:Bn.DONE})}}),S=Object(o.a)(T,2),w=S[0],I=S[1].error,k=function(){var e=Object(it.a)(rt.a.mark((function e(){return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u({currentStep:Bn.PROCESSING}),!f){e.next=4;break}return e.next=4,w({variables:{file:f,library:a,mapping:v,key:p?O:null}});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R={name:"file",multiple:!1,accept:".xlsx",showUploadList:!1,beforeUpload:function(e){var t=new FileReader;return t.readAsBinaryString(e),t.onload=function(n){var r=function(e){var t=er.read(e,{type:"binary"}),n=[];for(var r in t.Sheets)if(t.Sheets.hasOwnProperty(r)){n=er.utils.sheet_to_json(t.Sheets[r]);break}return n.length?(u({data:n,mapping:Array(Object.keys(n[0]).length).fill(null)}),!0):(qn.b.error(l("import.empty_file")),!1)}(t.result);r&&u({file:e}),u({okBtn:r})},!0}},A=function(){var e=Object(it.a)(rt.a.mark((function e(){return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=h,e.next=e.t0===Bn.SELECT_FILE?3:e.t0===Bn.CONFIG?6:9;break;case 3:return u({okBtn:!1}),u({currentStep:Bn.CONFIG}),e.abrupt("break",11);case 6:return e.next=8,k();case 8:return e.abrupt("break",11);case 9:return n(),e.abrupt("return");case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=l(h===Bn.SELECT_FILE?"import.file_configuration":h===Bn.CONFIG?"import.start":"global.close");return Object(B.jsxs)(Zn.a,{title:l("import.title"),okText:C,cancelText:l("global.cancel"),onOk:A,onCancel:n,visible:i,closable:!0,width:"90vw",centered:!0,confirmLoading:h===Bn.PROCESSING,bodyStyle:{height:"calc(100vh - 10rem)"},okButtonProps:{disabled:!m,className:"submit-btn"},cancelButtonProps:{disabled:h===Bn.DONE},destroyOnClose:!0,children:[Object(B.jsxs)($n.a,{current:h,style:{marginBottom:"2em"},children:[Object(B.jsx)(ir,{title:l("import.file_selection")}),Object(B.jsx)(ir,{title:l("import.file_configuration")}),Object(B.jsx)(ir,{title:l("import.in_progress"),icon:h===Bn.PROCESSING?Object(B.jsx)(zn.a,{}):null}),Object(B.jsx)(ir,{title:l("import.import_done"),status:I?"error":void 0})]}),Object(B.jsxs)(cr,{children:[h===Bn.SELECT_FILE&&Object(B.jsxs)(ar,Object($.a)(Object($.a)({},R),{},{children:[Object(B.jsx)("p",{className:"ant-upload-drag-icon",children:Object(B.jsx)(Gn.a,{})}),Object(B.jsx)("p",{className:"ant-upload-text",children:(null===f||void 0===f?void 0:f.name)||l("import.file_selection_instruction")})]})),h===Bn.CONFIG&&Object(B.jsxs)(Qn.b,{direction:"vertical",align:"center",children:[Object(B.jsx)(On.a,{title:function(){return Object(B.jsx)(lr,{level:5,children:l("import.data_overview")})},bordered:!1,tableLayout:"fixed",columns:Object.keys(j[0]).map((function(e,t){return{title:e,dataIndex:e}})),dataSource:j.slice(0,3).map((function(e,t){return Object($.a)(Object($.a)({},e),{},{key:t})})),size:"small",pagination:{hideOnSinglePage:!0}}),Object(B.jsx)(On.a,{title:function(){return Object(B.jsx)(lr,{level:5,children:l("import.mapping")})},tableLayout:"fixed",bordered:!1,columns:Object.keys(j[0]).map((function(e){return{title:e,dataIndex:e}})),dataSource:[Object.assign.apply(Object,[{key:"mapping_attributes"}].concat(Object(ve.a)(Object.keys(j[0]).map((function(e,t){return Object($e.a)({},e,Object(B.jsx)(Kn.a,{style:{width:"100%"},placeholder:l("import.attribute_selection"),value:v[t],allowClear:!0,onClear:function(){return function(e){v[e]=null,u({mapping:Object(ve.a)(v)})}(t)},onSelect:function(e){return function(e,t){v[e]=t,u({mapping:Object(ve.a)(v),okBtn:v.length===Object.keys(j[0]).length&&(!p||!!O),key:O&&v.includes(O)?O:null,keyChecked:!!O&&v.includes(O)})}(t,e)},children:_.map((function(e){return Object(B.jsx)(Kn.a.Option,{value:e.id,children:e.label||e.id},e.id)}))}))})))))],size:"small",pagination:{hideOnSinglePage:!0}}),Object(B.jsxs)(Qn.b,{direction:"vertical",align:"center",children:[Object(B.jsxs)(Qn.b,{direction:"horizontal",align:"baseline",children:[Object(B.jsx)(Xn.a,{defaultChecked:p,checked:p,onChange:function(e){return u({keyChecked:e.target.checked,okBtn:v.length===Object.keys(j[0]).length&&(!e.target.checked||!!O)})}}),Object(B.jsxs)(lr,{level:5,children:[l("import.key")," ",Object(B.jsx)(Mn.a,{})]})]}),Object(B.jsx)(Kn.a,{disabled:!p,placeholder:"Select a key",value:O||void 0,onSelect:function(e){return u({key:e,okBtn:v.length===Object.keys(j[0]).length&&(!p||!!e)})},children:_.filter((function(e){return v.includes(e.id)})).map((function(e){return Object(B.jsx)(Kn.a.Option,{value:e.id,children:e.label||e.id},e.id)}))})]})]}),h===Bn.PROCESSING&&Object(B.jsx)(or,{"data-test-id":"processing",children:l("global.processing")+"..."}),h===Bn.DONE&&Object(B.jsx)(qe.a,{status:I?"error":"success",title:l(I?"import.import_failure":"import.import_success")})]})]})},br="favorites_libraries_ids",jr=Ke.a.div(dr||(dr=Object(Qe.a)(["\n    & table .label-cell:not(:hover) .floating-menu {\n        display: none;\n    }\n"])));var vr,Or=function(){var e,t,n,i,a,l,c,s,d=Object(F.a)().t,u=yt(),b=Object(o.a)(u,1)[0].lang,j=Ve(),v=Object(r.useState)(),O=Object(o.a)(v,2),f=O[0],p=O[1],h=Cn(),m=Object(vt.a)(Rn,{variables:{keys:[br]}}),g=Object(sn.a)(kn),x=Object(o.a)(g,1)[0];if(Object(r.useEffect)((function(){var e={content:d("notification.base-message"),type:Y.basic};j(he(e))}),[d,j]),h.error||m.error)return Object(B.jsx)(tt,{message:(null===(c=h.error)||void 0===c?void 0:c.message)||(null===(s=m.error)||void 0===s?void 0:s.message)});var y=null!==(e=null===(t=h.data)||void 0===t||null===(n=t.libraries)||void 0===n?void 0:n.list)&&void 0!==e?e:[],E=null!==(i=null===(a=m.data)||void 0===a||null===(l=a.userData)||void 0===l?void 0:l.data.favorites_libraries_ids)&&void 0!==i?i:[],_=y.map((function(e){return{key:e.id,id:e.id,label:Mt(e.label,b),isFavorite:E.includes(e.id)}})).sort((function(e,t){return Number(t.isFavorite)-Number(e.isFavorite)})),T=[{title:d("home.label"),dataIndex:"label",key:"label",className:"label-cell",render:function(e,t){var n=[{title:d("import.title"),icon:Object(B.jsx)(jn.a,{size:20}),onClick:function(){return p(t.id)}}];return Object(B.jsxs)(Ln.b,{to:Zt(t.id),style:{display:"inline-block",width:"100%",color:"inherit"},children:[Object(B.jsx)(rn.a,{})," ",e,Object(B.jsx)(In,{style:{right:"28px"},actions:n})]})}},{dataIndex:"isFavorite",key:"isFavorite",width:20,render:function(e,t){var n=function(){var e=Object(it.a)(rt.a.mark((function e(n){var r;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.id,e.next=3,x({variables:{key:br,value:n?E.filter((function(e){return e!==r})):E.concat([r]),global:!1}});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsx)(Hn,{isFavorite:e,onToggle:n,hoverTrigger:".ant-table-cell"})}}];return Object(B.jsxs)(jr,{className:"wrapper-page",children:[Object(B.jsx)(vn.a,{avatar:{icon:Object(B.jsx)(rn.a,{}),shape:"square",style:{background:"none",color:"#000"}},title:d("home.libraries")}),Object(B.jsx)(On.a,{bordered:!0,columns:T,dataSource:_,loading:h.loading,pagination:!1}),f&&Object(B.jsx)(ur,{library:f,open:!!f,onClose:function(){return p("")}})]})},fr=Object(Ot.a)(vr||(vr=Object(Qe.a)(["\n    query GET_TREE_LIST_QUERY($treeId: ID) {\n        trees(filters: {id: $treeId}) {\n            list {\n                id\n                label\n                libraries {\n                    library {\n                        id\n                        label\n                    }\n                }\n                permissions {\n                    access_tree\n                    edit_children\n                }\n            }\n        }\n    }\n"])));function pr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(r.useState)(),n=Object(o.a)(t,2),i=n[0],a=n[1],l=e.treeId,c=e.onlyAllowed,s=void 0===c||c,d=e.skip,u=void 0!==d&&d,b={};l&&(b.treeId=l);var j=Object(vt.a)(fr,{variables:b,skip:u,onCompleted:function(e){var t=Object($.a)(Object($.a)({},e),{},{trees:{list:e.trees.list.filter((function(e){return!s||e.permissions.access_tree}))}});a(t)}});return Object($.a)(Object($.a)({},j),{},{loading:j.loading||!j.loading&&void 0===typeof i,data:i})}var hr="favorites_trees_ids";var mr,gr,xr,yr,Er,_r,Tr=function(){var e,t,n,i,a,l,c=Object(F.a)().t,s=yt(),d=Object(o.a)(s,1)[0].lang,u=Ve(),b=pr(),j=Object(vt.a)(Rn,{variables:{keys:[hr]}}),v=Object(sn.a)(kn,{ignoreResults:!0}),O=Object(o.a)(v,1)[0];if(Object(r.useEffect)((function(){var e={content:c("notification.base-message"),type:Y.basic};u(he(e))}),[c,u]),b.error||j.error)return Object(B.jsx)(tt,{message:b.error.message||j.error.message});var f=null!==(e=null===(t=b.data)||void 0===t||null===(n=t.trees)||void 0===n?void 0:n.list)&&void 0!==e?e:[],p=null!==(i=null===(a=j.data)||void 0===a||null===(l=a.userData)||void 0===l?void 0:l.data.favorites_trees_ids)&&void 0!==i?i:[],h=f.map((function(e){return{key:e.id,id:e.id,label:Mt(e.label,d),isFavorite:!!p.includes(e.id)}})).sort((function(e,t){return Number(t.isFavorite)-Number(e.isFavorite)})),m=[{title:c("home.label"),dataIndex:"label",key:"label",render:function(e,t){return Object(B.jsxs)(Ln.b,{to:en(t.id),style:{display:"inline-block",width:"100%",color:"inherit"},children:[Object(B.jsx)(cn.a,{})," ",e]})}},{dataIndex:"isFavorite",key:"isFavorite",width:20,render:function(e,t){var n=function(){var e=Object(it.a)(rt.a.mark((function e(n){var r;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.id,e.next=3,O({variables:{key:hr,value:n?p.filter((function(e){return e!==r})):p.concat([r]),global:!1}});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsx)(Hn,{isFavorite:e,onToggle:n,hoverTrigger:".ant-table-cell"})}}];return Object(B.jsxs)("div",{className:"wrapper-page",children:[Object(B.jsx)(vn.a,{avatar:{icon:Object(B.jsx)(cn.a,{}),shape:"square",style:{background:"none",color:"#000"}},title:c("home.trees")}),Object(B.jsx)(On.a,{bordered:!0,columns:m,dataSource:h,loading:b.loading,pagination:!1})]})},Sr=Object(Ot.a)(mr||(mr=Object(Qe.a)(["\n    query GET_ACTIVE_TREE {\n        activeTree @client {\n            id @client\n            libraries @client {\n                id @client\n            }\n            label @client\n            permissions @client {\n                access_tree @client\n                edit_children @client\n            }\n        }\n    }\n"]))),wr=function(){var e=Object(vt.a)(Sr),t=e.data,n=e.client;return[null===t||void 0===t?void 0:t.activeTree,Object(r.useCallback)((function(e){n.writeQuery({query:Sr,data:{activeTree:e}})}),[n])]},Ir=Ke.a.div(gr||(gr=Object(Qe.a)(["\n    height: ",";\n    background: #0f2027;\n    color: #fff;\n    text-align: center;\n    line-height: 3rem;\n    font-size: 1.5rem;\n    cursor: pointer;\n"])),Je.a["@leav-header-height"]),kr=Ke.a.div(xr||(xr=Object(Qe.a)(["\n    height: 100%;\n"]))),Rr=Ke.a.span(yr||(yr=Object(Qe.a)(["\n    display: inline-flex;\n    flex-direction: row;\n    justify-content: space-between;\n    align-items: center;\n    min-width: 200px;\n"]))),Ar=Ke.a.span(Er||(Er=Object(Qe.a)(["\n    flex-grow: 1;\n"]))),Cr=Ke.a.span(_r||(_r=Object(Qe.a)(["\n    display: ",";\n\n    ",":hover > & {\n        display: inline;\n    }\n"])),(function(e){return e.isFavorite?"inline":"none"}),Rr);var Nr,Lr,Vr,Dr,Fr,Pr=function(){var e,t,n,r,i,a,l,c,s,d,u,b,j,v,O,f,p=Object(F.a)().t,h=yt(),m=Object(o.a)(h,1)[0].lang,g=gt(),x=Object(o.a)(g,1)[0],y=wr(),E=Object(o.a)(y,1)[0],_=Object(et.f)(),T=Le((function(e){return e})).activePanel,S=Cn(),w=pr(),I=Object(vt.a)(Rn,{variables:{keys:[br,hr]}}),k=Object(sn.a)(kn),R=Object(o.a)(k,1)[0],A=(null!==(e=null===E||void 0===E?void 0:E.libraries)&&void 0!==e?e:[]).map((function(e){return e.id})),C=null!==(t=null===x||void 0===x?void 0:x.trees.map((function(e){return e.id})))&&void 0!==t?t:[],N=null!==(n=null===I||void 0===I||null===(r=I.data)||void 0===r||null===(i=r.userData)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.favorites_libraries_ids)&&void 0!==n?n:[],L=null!==(l=null===I||void 0===I||null===(c=I.data)||void 0===c||null===(s=c.userData)||void 0===s||null===(d=s.data)||void 0===d?void 0:d.favorites_trees_ids)&&void 0!==l?l:[],D=(null!==(u=null===S||void 0===S||null===(b=S.data)||void 0===b||null===(j=b.libraries)||void 0===j?void 0:j.list)&&void 0!==u?u:[]).reduce((function(e,t){var n=Object($.a)({},e);return A.includes(t.id)?n.related.push(t):N.includes(t.id)?n.favorites.push(t):n.others.push(t),n}),{related:[],favorites:[],others:[]}),P=(null!==(v=null===w||void 0===w||null===(O=w.data)||void 0===O||null===(f=O.trees)||void 0===f?void 0:f.list)&&void 0!==v?v:[]).reduce((function(e,t){var n=Object($.a)({},e);return C.includes(t.id)?n.related.push(t):L.includes(t.id)?n.favorites.push(t):n.others.push(t),n}),{related:[],favorites:[],others:[]}),U=function(e,t,n){var r=Object(ve.a)("library"===n?N:L);e?r=r.filter((function(e){return e!==t})):r.push(t),R({variables:{key:"library"===n?br:hr,value:r,global:!1}})},H=function(e){return _.push(e)},z=function(){(null===x||void 0===x?void 0:x.id)&&H(Zt(x.id))},G=function(){(null===E||void 0===E?void 0:E.id)&&H(en(E.id))},M=S.loading||I.loading?Object(B.jsx)(dn.a.Item,{children:Object(B.jsx)(V.a,{})}):S.error||I.error?Object(B.jsx)(tt,{message:(S.error||I.error).message}):Object(B.jsx)(B.Fragment,{children:Object.keys(D).map((function(e){return D[e].length?Object(B.jsx)(dn.a.ItemGroup,{title:p("sidebar.".concat(e,"_libraries")),children:D[e].map((function(e){var t=N.includes(e.id);return Object(B.jsx)(dn.a.Item,{icon:Object(B.jsx)(rn.a,{}),children:Object(B.jsxs)(Rr,{children:[Object(B.jsx)(Ar,{onClick:function(){return H(Zt(e.id))},children:Mt(e.label,m)}),Object(B.jsx)(Cr,{onClick:function(n){n.preventDefault(),n.stopPropagation(),U(t,e.id,"library")},isFavorite:t,children:t?Object(B.jsx)(an.a,{}):Object(B.jsx)(ln.a,{})})]})},"library.".concat(e.id))}))},"".concat(e,"_libraries")):null}))}),W=w.loading||I.loading?Object(B.jsx)(dn.a.Item,{children:Object(B.jsx)(V.a,{})}):w.error||I.error?Object(B.jsx)(tt,{message:(w.error||I.error).message}):Object(B.jsx)(B.Fragment,{children:Object.keys(P).map((function(e){return P[e].length?Object(B.jsx)(dn.a.ItemGroup,{title:p("sidebar.".concat(e,"_trees")),children:P[e].map((function(e){var t=L.includes(e.id);return Object(B.jsx)(dn.a.Item,{icon:Object(B.jsx)(cn.a,{}),children:Object(B.jsxs)(Rr,{children:[Object(B.jsx)(Ar,{onClick:function(){return H(en(e.id))},children:Mt(e.label,m)}),Object(B.jsx)(Cr,{onClick:function(n){n.preventDefault(),n.stopPropagation(),U(t,e.id,"tree")},isFavorite:t,children:t?Object(B.jsx)(an.a,{}):Object(B.jsx)(ln.a,{})})]})},"tree.".concat(e.id))}))},"".concat(e,"_trees")):null}))});return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(Ir,{onClick:function(){return H("/")},children:Object(B.jsx)(on.a,{role:"button"})}),Object(B.jsx)(kr,{children:Object(B.jsxs)(dn.a,{style:{width:"100%"},selectedKeys:[T,"".concat(T,".").concat((null===x||void 0===x?void 0:x.id)||(null===E||void 0===E?void 0:E.id))],activeKey:T,children:[Object(B.jsx)(bn.a,{icon:Object(B.jsx)(rn.a,{onClick:z}),title:(null===x||void 0===x?void 0:x.name)?x.name:p("sidebar.library"),onTitleClick:z,children:M},"library"),Object(B.jsx)(bn.a,{icon:Object(B.jsx)(cn.a,{onClick:G}),title:(null===E||void 0===E?void 0:E.label)?E.label:p("sidebar.tree"),onTitleClick:G,children:W},"tree")]})})]})},Ur=n(159),Br=n(773),Hr=n(749),zr=Ke.a.div(Nr||(Nr=Object(Qe.a)(["\n    padding: 0.3rem 1rem;\n    min-width: 25%;\n    width: auto;\n    text-overflow: hidden;\n    font-weight: 600;\n    line-height: 1em;\n\n    background: #0d1e26 0% 0% no-repeat padding-box;\n    border: 1px solid #70707031;\n    border-radius: 3px;\n\n    display: flex;\n    flex-flow: row wrap;\n    justify-content: space-between;\n\n    height: 3.5ch;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n"]))),Gr=Object(Ke.a)(Hr.a)(Lr||(Lr=Object(Qe.a)(["\n    margin: 0 0.3rem;\n    & > * {\n        border: none;\n        box-shadow: none;\n    }\n"])));var Mr=Ke.a.span(Vr||(Vr=Object(Qe.a)(["\n    color: #e02020;\n    font-weight: 800;\n"]))),$r=Ke.a.span(Dr||(Dr=Object(Qe.a)(["\n    color: orange;\n    font-weight: 600;\n"]))),Wr=Ke.a.span(Fr||(Fr=Object(Qe.a)(["\n    color: greenyellow;\n    font-weight: 600;\n"]))),Yr=function(e){var t=e.notification;switch(t.type){case Y.error:return Object(B.jsx)(Mr,{children:t.content});case Y.warning:return Object(B.jsx)($r,{children:t.content});case Y.success:return Object(B.jsx)(Wr,{children:t.content});case Y.basic:default:return Object(B.jsx)("span",{children:t.content})}},qr=function(e){var t=e.message,n=e.activeTimeouts,i=e.cancelNotification,a=e.triggerNotifications,l=e.setTriggerNotifications,c=Le((function(e){return{stack:e.notification.stack}})).stack;return Object(r.useEffect)((function(){if(a.length){var e=Object(Ur.a)(a),t=e[0],n=e.slice(1);switch(t.type){case Y.error:qn.b.error(t.content);break;case Y.success:qn.b.success(t.content);break;case Y.warning:qn.b.warning(t.content);break;case Y.basic:default:qn.b.info(t.content)}l(n)}}),[a,l]),Object(B.jsx)(B.Fragment,{children:Object(B.jsxs)(zr,{"data-testid":"notification-message-wrapper",children:[Object(B.jsx)(Yr,{notification:t}),Object(B.jsx)("span",{children:n.notification&&Object(B.jsxs)("div",{children:[Object(B.jsx)(Gr,{count:c.length}),Object(B.jsx)(Br.a,{onClick:i})]})})]})})};var Qr,Kr,Xr=function(){var e=Le((function(e){return e.notification})),t=e.stack,n=e.base,i=Ve(),a=Object(r.useState)(n),l=Object(o.a)(a,2),c=l[0],s=l[1],d=Object(r.useState)([]),u=Object(o.a)(d,2),b=u[0],j=u[1],v=Object(r.useState)({notification:null,base:null}),O=Object(o.a)(v,2),f=O[0],p=O[1];return Object(r.useEffect)((function(){var e=t.reduce((function(e,t){switch(t.channel){case Q.trigger:return Object($.a)(Object($.a)({},e),{},{triggerNotifications:[].concat(Object(ve.a)(e.triggerNotifications),[t])});case Q.passive:default:return Object($.a)(Object($.a)({},e),{},{passiveNotifications:[].concat(Object(ve.a)(e.passiveNotifications),[t])})}}),{passiveNotifications:[],triggerNotifications:[]}),r=e.passiveNotifications,a=e.triggerNotifications;if(a.length&&(j((function(e){return[].concat(Object(ve.a)(e),Object(ve.a)(a))})),i(me(r))),r.length){var l=Object(ve.a)(r).sort(qt),c=Object(Ur.a)(l),o=c[0],d=c.slice(1);if(o&&!f.notification){var u;s(o);var b=null!==(u=o.time)&&void 0!==u?u:5e3;f.base&&p((function(e){return clearTimeout(e.base),{base:null,notification:e.notification}}));var v=setTimeout((function(){if(!f.notification){var e=setTimeout((function(){s(n)}),100);p((function(t){return{notification:t.notification,base:e}}))}p((function(e){return{notification:null,base:e.base}}))}),b);p((function(e){return{notification:v,base:e.base}})),i(me(d))}}else f.notification||s((function(e){return n.content!==e.content?n:e}))}),[s,t,n,p,f,i]),Object(B.jsx)(qr,{message:c,activeTimeouts:f,cancelNotification:function(){clearTimeout(f.notification),p((function(e){return{notification:null,base:e.base}}))},triggerNotifications:b,setTriggerNotifications:j})},Jr=Ke.a.div(Qr||(Qr=Object(Qe.a)(["\n    & {\n        display: flex;\n        flex-flow: row nowrap;\n        align-items: center;\n        justify-content: space-between;\n        cursor: pointer;\n        width: 8rem;\n    }\n"]))),Zr=Ke.a.div(Kr||(Kr=Object(Qe.a)(["\n    & {\n        flex-shrink: 0;\n        border-radius: 50%;\n        background: hsl(130, 52%, 58%);\n        color: #ffffff;\n        height: 2rem;\n        width: 2rem;\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n        text-align: center;\n        font-weight: bold;\n        font-size: 0.8rem;\n    }\n"])));var ei,ti,ni,ri,ii=function(){var e=_t(),t=Object(o.a)(e,1)[0],n=null===t||void 0===t?void 0:t.userName.split(" ").map((function(e){return e[0]}));return Object(B.jsxs)(Jr,{children:[Object(B.jsx)(Zr,{children:n}),Object(B.jsx)("div",{children:null===t||void 0===t?void 0:t.userName})]})},ai=Ke.a.div(ei||(ei=Object(Qe.a)(["\n    display: flex;\n    flex-direction: row;\n    height: ",";\n\n    color: white;\n    background: transparent linear-gradient(85deg, #0f2027 0%, #203a43 52%, #2c5364 100%) 0% 0% no-repeat padding-box;\n"])),Je.a["@leav-header-height"]),li=Ke.a.div(ti||(ti=Object(Qe.a)(["\n    display: flex;\n    justify-content: space-around;\n    align-items: center;\n    transition: 275ms ease-out;\n    padding: 0 1rem;\n    background: ",";\n\n    & > * {\n        margin: 0 0.5rem;\n    }\n\n    &:hover {\n        background: ",";\n    }\n"])),(function(e){return e.isActive?Je.a["@primary-color"]:"none"}),Je.a["@primary-color"]),ci=Object(Ke.a)(li)(ni||(ni=Object(Qe.a)(["\n    justify-self: end;\n"]))),oi=Ke.a.div(ri||(ri=Object(Qe.a)(["\n    width: 100%;\n    display: flex;\n    justify-content: start;\n    align-items: center;\n"])));var si,di=function(e){var t=e.userPanelVisible,n=e.toggleUserPanelVisible;return Object(B.jsxs)(ai,{children:[Object(B.jsx)(oi,{children:Object(B.jsx)(Xr,{})},"lib-name"),Object(B.jsx)(ci,{onClick:function(){n()},isActive:t,children:Object(B.jsx)(ii,{})},"trigger-user-panel")]})},ui=n(775),bi=n(776),ji=n(777),vi=n(778),Oi=n(750),fi=Ke.a.span(si||(si=Object(Qe.a)(["\n    font-size: 0.6em;\n    color: #444;\n    font-weight: bold;\n    background: #dedede;\n    border-radius: 4px;\n    padding: 2px 5px;\n    margin-left: 1em;\n"])));var pi,hi=function(){var e=Object(F.a)().t;return Object(B.jsxs)(fi,{children:[Object(B.jsx)("span",{role:"img","aria-label":"available_soon",children:"\ud83d\udd25"})," ",e("global.available_soon").toLocaleUpperCase()]})},mi=n(774),gi=Ke.a.div(pi||(pi=Object(Qe.a)(["\n    display: flex;\n    align-items: center;\n"])));var xi=function(){var e=Object(F.a)(),t=e.t,n=e.i18n,r=yt(),i=Object(o.a)(r,2),a=i[0].availableLangs,l=i[1],c={fr:"\ud83c\uddeb\ud83c\uddf7",en:"\ud83c\uddec\ud83c\udde7"};return Object(B.jsxs)(gi,{children:[Object(B.jsx)(mi.a,{}),t("settings.choose-lang")," :",a.map((function(e){var t,r;return Object(B.jsx)(D.a,{type:"text",name:e,style:{padding:"0 5px"},onClick:(r=e,function(){n.changeLanguage(r);var e=[n.language,n.language],t=n.language?y[n.language]:y.en;l({lang:e,defaultLang:t})}),children:null!==(t=c[e])&&void 0!==t?t:e},e)}))]})};var yi=function(e){var t=e.userPanelVisible,n=e.hideUserPanel,r=Object(F.a)().t,i=d().deleteToken;return Object(B.jsx)(Oi.a,{visible:t,onClose:n,placement:"right",closable:!1,getContainer:!1,bodyStyle:{padding:0},children:Object(B.jsxs)(dn.a,{style:{height:"100%"},mode:"inline",children:[Object(B.jsxs)(dn.a.Item,{disabled:!0,children:[Object(B.jsx)(ui.a,{}),r("menu.user_menu.tasks"),Object(B.jsx)(hi,{})]}),Object(B.jsxs)(dn.a.Item,{disabled:!0,children:[Object(B.jsx)(bi.a,{}),r("menu.user_menu.shortcuts"),Object(B.jsx)(hi,{})]}),Object(B.jsxs)(dn.a.Item,{disabled:!0,children:[Object(B.jsx)(ji.a,{}),r("menu.user_menu.events"),Object(B.jsx)(hi,{})]}),Object(B.jsx)(dn.a.Item,{children:Object(B.jsx)(xi,{})}),Object(B.jsxs)(dn.a.Item,{onClick:function(){i(),window.location.replace("/")},children:[Object(B.jsx)(vi.a,{}),r("menu.user_menu.logout")]})]})})},Ei=n(201),_i=n(124),Ti=Or,Si=Tr;var wi,Ii=function(){return Object(B.jsxs)(Ei.a,{gutter:10,children:[Object(B.jsx)(_i.a,{span:12,"data-testid":"libraries-list",children:Object(B.jsx)(Ti,{})}),Object(B.jsx)(_i.a,{span:12,"data-testid":"trees-list",children:Object(B.jsx)(Si,{})})]})},ki=n(733),Ri=Object(r.createContext)(!1);!function(e){e.SET_RECORDS="SET_RECORDS",e.SET_TOTAL_COUNT="SET_TOTAL_COUNT",e.SET_PAGINATION="SET_PAGINATION",e.SET_OFFSET="SET_OFFSET",e.SET_LOADING="SET_LOADING",e.SET_SORT="SET_SORT",e.CANCEL_SORT="CANCEL_SORT",e.SET_ATTRIBUTES="SET_ATTRIBUTES",e.SET_FIELDS="SET_FIELDS",e.SET_FULLTEXT="SET_FULLTEXT",e.SET_FILTERS="SET_FILTERS",e.SET_QUERY_FILTERS="SET_QUERY_FILTERS",e.SET_VIEW="SET_VIEW",e.SET_USER_VIEWS_ORDER="SET_USER_VIEWS_ORDER",e.SET_SHARED_VIEWS_ORDER="SET_SHARED_VIEWS_ORDER",e.SET_DISPLAY="SET_DISPLAY"}(wi||(wi={}));var Ai,Ci,Ni,Li={library:null,records:[],totalCount:0,loading:!1,pagination:20,offset:0,sort:Object($.a)(Object($.a)({},Rt),{},{active:!1}),attributes:[],fields:[],fullText:"",filters:[],queryFilters:[],display:{type:h.list,size:p.MEDIUM},view:{current:Ct,reload:!1,sync:!0},userViewsOrder:[],sharedViewsOrder:[]},Vi=function(e,t){var n,r,i=function(e,t){var n,r,i,a,l,c,o,s,d,u,b,j=!0;if(t.sort&&(j=e.sort.field===(null===(n=e.view)||void 0===n||null===(r=n.current)||void 0===r||null===(i=r.sort)||void 0===i?void 0:i.field)&&e.sort.order===(null===(a=e.view)||void 0===a||null===(l=a.current)||void 0===l||null===(c=l.sort)||void 0===c?void 0:c.order)),t.filters&&(j=j&&JSON.stringify(null===(o=e.view.current)||void 0===o?void 0:o.filters)===JSON.stringify(e.filters)),t.display&&(j=j&&e.display.type===(null===(s=e.view.current)||void 0===s||null===(d=s.display)||void 0===d?void 0:d.type)&&e.display.size===(null===(u=e.view.current)||void 0===u||null===(b=u.display)||void 0===b?void 0:b.size)),t.fields){var v,O,f,p=(null===(v=e.view.current)||void 0===v||null===(O=v.settings)||void 0===O?void 0:O.find((function(e){return e.name===At})))?null===(f=e.view.current)||void 0===f?void 0:f.settings.find((function(e){return e.name===At})).value:[];j=j&&e.fields.map((function(e){return e.id})).join(".")===p.join(".")}return j}(e,{sort:t.type!==wi.SET_SORT,filters:t.type!==wi.SET_FILTERS,display:t.type!==wi.SET_DISPLAY,fields:t.type!==wi.SET_FIELDS});switch(t.type){case wi.SET_RECORDS:return Object($.a)(Object($.a)({},e),{},{records:t.records});case wi.SET_TOTAL_COUNT:return Object($.a)(Object($.a)({},e),{},{totalCount:t.totalCount});case wi.SET_PAGINATION:return Object($.a)(Object($.a)({},e),{},{pagination:t.page,loading:!0});case wi.SET_OFFSET:return Object($.a)(Object($.a)({},e),{},{offset:t.offset,loading:!0});case wi.SET_LOADING:return Object($.a)(Object($.a)({},e),{},{loading:t.loading});case wi.SET_SORT:return i=i&&e.view.current.sort.field===t.sort.field&&e.view.current.sort.order===t.sort.order,Object($.a)(Object($.a)({},e),{},{sort:t.sort,view:Object($.a)(Object($.a)({},e.view),{},{sync:i})});case wi.CANCEL_SORT:return Object($.a)(Object($.a)({},e),{},{sort:Object($.a)(Object($.a)({},Rt),{},{active:!1})});case wi.SET_ATTRIBUTES:return Object($.a)(Object($.a)({},e),{},{attributes:t.attributes});case wi.SET_FIELDS:var a=(null===(n=e.view.current.settings)||void 0===n?void 0:n.find((function(e){return e.name===At})))?null===(r=e.view.current)||void 0===r?void 0:r.settings.find((function(e){return e.name===At})).value:[];return i=i&&t.fields.map((function(e){return e.id})).join(".")===a.join("."),Object($.a)(Object($.a)({},e),{},{fields:t.fields,view:Object($.a)(Object($.a)({},e.view),{},{sync:i})});case wi.SET_FULLTEXT:return Object($.a)(Object($.a)({},e),{},{fullText:t.fullText});case wi.SET_FILTERS:return i=i&&JSON.stringify(e.view.current.filters)===JSON.stringify(t.filters),Object($.a)(Object($.a)({},e),{},{filters:t.filters,view:Object($.a)(Object($.a)({},e.view),{},{sync:i})});case wi.SET_QUERY_FILTERS:return Object($.a)(Object($.a)({},e),{},{queryFilters:t.queryFilters});case wi.SET_VIEW:return Object($.a)(Object($.a)({},e),{},{view:t.view});case wi.SET_DISPLAY:return i=i&&t.display.type===e.view.current.display.type&&t.display.size===e.view.current.display.size,Object($.a)(Object($.a)({},e),{},{display:t.display,view:Object($.a)(Object($.a)({},e.view),{},{sync:i})});case wi.SET_USER_VIEWS_ORDER:return Object($.a)(Object($.a)({},e),{},{userViewsOrder:t.userViewsOrder});case wi.SET_SHARED_VIEWS_ORDER:return Object($.a)(Object($.a)({},e),{},{sharedViewsOrder:t.sharedViewsOrder})}},Di=i.a.createContext({state:Li,dispatch:null}),Fi=n(59),Pi=function(e){switch(e.type){case b.simple:case b.advanced:return e.id;case b.simple_link:case b.advanced_link:return"".concat(e.id," {\n                ...RecordIdentity\n            }");case b.tree:return"".concat(e.id," {\n                record {\n                    ...RecordIdentity\n                }\n            }")}},Ui=function(e,t){var n=null===e||void 0===e?void 0:e.toUpperCase();return(null===n||void 0===n?void 0:n.length)?Kt(Ci||(Ci=Object(Qe.a)(["\n        ","\n        query "," (\n            $limit: Int!\n            $offset: Int\n            $filters: [RecordFilterInput]\n            $sortField: String\n            $sortOrder: SortOrder!\n            $fullText: String\n        ) {\n            "," (\n                pagination: {limit: $limit, offset: $offset}\n                filters: $filters\n                sort: {field: $sortField, order: $sortOrder}\n                searchQuery: $fullText\n            ) {\n                totalCount\n                list {\n                    _id: id\n                    ","\n                    ...RecordIdentity\n                }\n            }\n        }\n    "])),ft,"GET_RECORDS_FROM_"+n,e,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.length?e.map((function(e){if(e.parentAttributeData){var t=e.parentAttributeData.id;switch(e.parentAttributeData.type){case b.simple:case b.advanced:return Pi(e);case b.simple_link:case b.advanced_link:return"".concat(t," {\n                        ").concat(Pi(e),"\n                    }");case b.tree:var n=Object(Fi.getGraphqlTypeFromLibraryName)(e.recordLibrary);return n?"".concat(t," {\n                        record {\n                            ...on ").concat(n," {\n                                ").concat(Pi(e),"\n                            }\n                        }\n                    }"):""}}else if(e.embeddedData)return Object(ve.a)(e.embeddedData.path.split(".")).shift();return Pi(e)})):"id"}(t)):Kt(Ai||(Ai=Object(Qe.a)(["\n            query nothing {\n                libraries {\n                    list {\n                        id\n                    }\n                }\n            }\n        "])))},Bi=Object(Ot.a)(Ni||(Ni=Object(Qe.a)(["\n    ","\n\n    query GET_VIEW($viewId: String!) {\n        view(viewId: $viewId) {\n            id\n            display {\n                size\n                type\n            }\n            shared\n            created_by {\n                ...RecordIdentity\n            }\n            label\n            description\n            color\n            filters {\n                field\n                value\n                condition\n                operator\n                tree {\n                    id\n                    label\n                }\n            }\n            sort {\n                field\n                order\n            }\n            settings {\n                name\n                value\n            }\n        }\n    }\n"])),ft),Hi=n(103),zi=n.n(Hi),Gi=function(){return Object(r.useContext)(Di)},Mi=n(306),$i=n.n(Mi),Wi=n(319),Yi=n(415),qi=n(266);var Qi,Ki,Xi,Ji=function(){var e=Gi(),t=e.state,n=e.dispatch,r=t.offset/t.pagination+1;return Object(B.jsx)(qi.a,{defaultCurrent:r,current:r,total:t.totalCount,defaultPageSize:t.pagination,onShowSizeChange:function(e,t){n({type:wi.SET_PAGINATION,page:t})},showSizeChanger:!0,pageSizeOptions:Yt.map((function(e){return e.toString()})),onChange:function(e,t){n({type:wi.SET_OFFSET,offset:(e-1)*(null!==t&&void 0!==t?t:0)})}})},Zi=n(73),ea=n.p+"static/media/svgIconClosePanel.ef993d3b.svg",ta=Ke.a.img(Qi||(Qi=Object(Qe.a)(["\n    transform: translate(0px, -1px);\n"]))),na=function(){return Object(B.jsx)("div",{children:Object(B.jsx)(ta,{src:ea,alt:"icon column choice"})})},ra=Ke.a.img(Ki||(Ki=Object(Qe.a)(["\n    transform: translate(0px, -1px) rotate(180deg);\n"]))),ia=function(){return Object(B.jsx)("div",{children:Object(B.jsx)(ra,{src:ea,alt:"icon column choice"})})},aa=Object(Ke.a)(V.a)(Xi||(Xi=Object(Qe.a)(["\n    && {\n        display: block;\n        margin: 3em;\n    }\n"])));var la,ca,oa,sa,da,ua,ba,ja=function(){return Object(B.jsx)(aa,{})},va=n(744),Oa=function(e){switch(e){case x.medium:return"5rem";case x.big:return"8rem";case x.small:default:return"3rem"}},fa=Ke.a.div(la||(la=Object(Qe.a)(["\n    ","\n    background-color: ",";\n    color: ",";\n    font-size: 1.1em;\n    height: ",";\n    width: ",";\n    padding: 5px;\n    text-align: center;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    border-radius: 50%;\n"])),(function(e){return e.style||""}),(function(e){return e.bgColor}),(function(e){return e.fontColor}),(function(e){var t=e.size;return Oa(t)}),(function(e){var t=e.size;return Oa(t)}));fa.displayName="GeneratedPreview";var pa=Ke.a.div(ca||(ca=Object(Qe.a)(["\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    height: ",";\n    width: ",";\n    overflow: hidden;\n    border-radius: 50%;\n    border: 1px solid rgba(0, 0, 0, 0.1);\n"])),(function(e){var t=e.size;return Oa(t)}),(function(e){var t=e.size;return Oa(t)}));pa.displayName="ImagePreview";var ha=Ke.a.div(oa||(oa=Object(Qe.a)(["\n    ","\n    background-color: ",";\n    color: ",";\n    font-size: 4em;\n    padding: 5px;\n    height: 10rem;\n    text-align: center;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    border-radius: 0.25rem 0.25rem 0 0;\n"])),(function(e){return e.style||""}),(function(e){return e.bgColor}),(function(e){return e.fontColor}));ha.displayName="GeneratedPreviewTile";var ma=Ke.a.div(sa||(sa=Object(Qe.a)(["\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    overflow: hidden;\n    border-radius: 0.25rem 0.25rem 0 0;\n\n    img {\n        object-fit: cover;\n    }\n"])));ma.displayName="ImagePreviewTile";var ga=Ke.a.img(da||(da=Object(Qe.a)(["\n    display: ",";\n"])),(function(e){return e.$loaded?"block":"none"})),xa=Object(Ke.a)(va.a.Image)(ua||(ua=Object(Qe.a)(["\n    &&& {\n        height: 100%;\n        width: 100%;\n\n        .ant-skeleton-image-svg {\n            width: 30%;\n            height: 30%;\n        }\n    }\n"]))),ya=Object(Ke.a)(zn.a)(ba||(ba=Object(Qe.a)(["\n    position: absolute;\n    top: 1rem;\n    right: 1rem;\n    font-size: 2em;\n"])));function Ea(e){var t=e.label,n=e.color,i=e.image,a=e.style,l=e.tile,c=e.size;return l?function(e){var t=e.label,n=e.color,i=e.image,a=e.style,l=Object(r.useState)(!1),c=Object(o.a)(l,2),s=c[0],d=c[1];if(i)return Object(B.jsxs)(ma,{style:Object($.a)({position:"relative"},a),children:[!s&&Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(xa,{style:Object($.a)({},a)}),Object(B.jsx)(ya,{spin:!0,"data-testid":"image-loading"})]}),Object(B.jsx)(ga,{$loaded:s,src:i,alt:"record preview",style:Object($.a)({},a),onLoad:function(){return d(!0)}})]});var u=t?t[0].toLocaleUpperCase():"?",b=n||Ht(t),j=Ft(b);return Object(B.jsx)(ha,{"data-testid":"generated-preview",className:"initial",bgColor:b,fontColor:j,style:a,children:u})}({label:t,color:n,image:i,size:c,style:a}):function(e){var t=e.label,n=e.color,r=e.image,i=e.size,a=e.style;if(r)return Object(B.jsx)(pa,{size:i,style:a,children:Object(B.jsx)("img",{src:r,alt:"record preview",style:Object($.a)({maxHeight:"auto",maxWidth:"auto",width:"100%",height:"100%",objectFit:"cover"},a)})});var l=String(t)?t[0].toLocaleUpperCase():"?",c=n||Ht(t),o=Ft(c),s=Oa(i);return Object(B.jsx)(fa,{"data-testid":"generated-preview",className:"initial",bgColor:c,fontColor:o,size:i,style:Object($.a)(Object($.a)({},a),{},{fontSize:"calc(".concat(s,s>"4rem"?" - 3rem)":" - 1rem)")}),children:l})}({label:t,color:n,image:i,size:c,style:a})}var _a,Ta,Sa,wa,Ia,ka=i.a.memo(Ea),Ra=Ke.a.div(_a||(_a=Object(Qe.a)(["\n    border-left: 5px solid ",";\n    display: flex;\n    flex-direction: row;\n    ","\n"])),(function(e){return e.recordColor||"transparent"}),(function(e){return e.style}));Ra.displayName="Wrapper";var Aa,Ca,Na,La,Va=Ke.a.div(Ta||(Ta=Object(Qe.a)(["\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n"]))),Da=Object(Ke.a)(Va)(Sa||(Sa=Object(Qe.a)(["\n    margin: 0 0.8em;\n"]))),Fa=Ke.a.div(wa||(wa=Object(Qe.a)(["\n    font-weight: bold;\n    overflow: hidden;\n"]))),Pa=Ke.a.div(Ia||(Ia=Object(Qe.a)(["\n    font-weight: normal;\n    color: rgba(0, 0, 0, 0.4);\n    font-size: 0.9em;\n"]))),Ua=function(e,t){var n,r,i=(n={},Object($e.a)(n,x.small,"tiny"),Object($e.a)(n,x.medium,"small"),Object($e.a)(n,x.big,"medium"),n),a=null!==(r=null===e||void 0===e?void 0:e[i[t]])&&void 0!==r?r:null===e||void 0===e?void 0:e.small;return a?Dt(a):""},Ba=function(e){var t,n,r,i=e.record,a=e.size,l=e.style,c=e.lang,o=e.withPreview,s=void 0===o||o,d=e.withLibrary,u=void 0===d||d,b=i.label||i.id;return Object(B.jsxs)(Ra,{recordColor:null!==(t=i.color)&&void 0!==t?t:"",style:l,className:"record-card",children:[s&&Object(B.jsx)(Da,{className:"preview",children:Object(B.jsx)(ka,{label:i.label||i.id,color:i.color,image:Ua(i.preview,a),size:a,style:l})}),Object(B.jsxs)(Va,{children:[Object(B.jsx)(Fa,{className:"label",children:Object(B.jsx)(zi.a,{ellipsis:{rows:1,tooltip:b},style:{marginBottom:0},children:b})}),u&&Object(B.jsx)(Pa,{className:"library-label",children:Mt(null===(n=i.library)||void 0===n?void 0:n.label,null!==c&&void 0!==c?c:[])||(null===(r=i.library)||void 0===r?void 0:r.id)})]})]})},Ha=Object(tr.a)(Aa||(Aa=Object(Qe.a)(["\n    ","\n    mutation CREATE_RECORD($library: ID!) {\n        createRecord(library: $library) {\n            ...RecordIdentity\n        }\n    }\n"])),ft),za=Object(Ot.a)(Ca||(Ca=Object(Qe.a)(["\n    query GET_LIBRARY_PERMISSIONS($libraryId: ID!) {\n        libraries(filters: {id: $libraryId}) {\n            list {\n                permissions {\n                    access_library\n                    access_record\n                    create_record\n                    edit_record\n                    delete_record\n                }\n            }\n        }\n    }\n"])));!function(e){e.access_record="access_record",e.create_record="create_record",e.edit_record="edit_record",e.delete_record="delete_record"}(La||(La={}));var Ga,Ma=function(e,t){var n,r,i,a,l=!t,c=Object(vt.a)((a=null===(n=e.gqlNames)||void 0===n?void 0:n.query,Kt(Na||(Na=Object(Qe.a)(["\n        query GET_RECORD_PERMISSIONS_","($recordId: String!) {\n            ",'(filters: [{field: "id", condition: ',", value: $recordId}]) {\n                list {\n                    permissions {\n                        ","\n                    }\n                }\n            }\n        }\n    "])),a,a,v.EQUAL,Object.values(La).join(" "))),{variables:{recordId:t},skip:l}),o=c.loading,s=c.error,d=c.data,u=Object(vt.a)(za,{variables:{libraryId:e.id},skip:!l}),b=u.loading,j=u.error,O=u.data;if(s||j)return{loading:!1,canEdit:!1,isReadOnly:!0};var f=null===O||void 0===O?void 0:O.libraries.list[0],p=null===d||void 0===d||null===(r=d[null===(i=e.gqlNames)||void 0===i?void 0:i.query])||void 0===r?void 0:r.list[0];return{loading:o||b,canEdit:l?null===f||void 0===f?void 0:f.permissions.create_record:null===p||void 0===p?void 0:p.permissions.access_record,isReadOnly:l?!(null===f||void 0===f?void 0:f.permissions.create_record):!(null===p||void 0===p?void 0:p.permissions.edit_record)}},$a=Object(tr.a)(Ga||(Ga=Object(Qe.a)(["\n    ","\n    query RECORD_FORM($libraryId: String!, $formId: String!, $recordId: String) {\n        recordForm(recordId: $recordId, libraryId: $libraryId, formId: $formId) {\n            id\n            recordId\n            library {\n                id\n            }\n            elements {\n                id\n                containerId\n                uiElementType\n                type\n                values {\n                    id_value\n                    created_at\n                    modified_at\n                    created_by {\n                        ...RecordIdentity\n                    }\n                    modified_by {\n                        ...RecordIdentity\n                    }\n\n                    ... on Value {\n                        value\n                        raw_value\n                    }\n\n                    ... on LinkValue {\n                        linkValue: value {\n                            ...RecordIdentity\n                        }\n                    }\n\n                    ... on TreeValue {\n                        treeValue: value {\n                            record {\n                                ...RecordIdentity\n                            }\n\n                            ancestors {\n                                record {\n                                    ...RecordIdentity\n                                }\n                            }\n                        }\n                    }\n                }\n                attribute {\n                    id\n                    label\n                    description\n                    type\n                    format\n                    system\n                    multiple_values\n                    permissions(record: {id: $recordId, library: $libraryId}) {\n                        access_attribute\n                        edit_value\n                    }\n\n                    ... on StandardAttribute {\n                        values_list {\n                            ... on StandardStringValuesListConf {\n                                enable\n                                allowFreeEntry\n                                values\n                            }\n\n                            ... on StandardDateRangeValuesListConf {\n                                enable\n                                allowFreeEntry\n                                dateRangeValues: values {\n                                    from\n                                    to\n                                }\n                            }\n                        }\n                    }\n\n                    ... on LinkAttribute {\n                        linked_library {\n                            id\n                            label\n                            gqlNames {\n                                type\n                                query\n                            }\n                        }\n                        linkValuesList: values_list {\n                            enable\n                            allowFreeEntry\n                            values {\n                                ...RecordIdentity\n                            }\n                        }\n                    }\n\n                    ... on TreeAttribute {\n                        linked_tree {\n                            id\n                            label\n                        }\n                        treeValuesList: values_list {\n                            enable\n                            allowFreeEntry\n                            values {\n                                record {\n                                    ...RecordIdentity\n                                }\n                                ancestors {\n                                    record {\n                                        ...RecordIdentity\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n                settings {\n                    key\n                    value\n                }\n            }\n        }\n    }\n"])),ft),Wa="records_consultation";function Ya(){return(Ya=Object(it.a)(rt.a.mark((function e(t,n){var r,i,a;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=Object(sn.a)(kn,{refetchQueries:[{query:Rn,variables:{keys:["".concat(Wa,"_").concat(t)]}}]}),i=Object(o.a)(r,1),a=i[0],Object(vt.a)(Rn,{skip:!t||!n,variables:{keys:["".concat(Wa,"_").concat(t)]},onCompleted:function(){var e=Object(it.a)(rt.a.mark((function e(r){var i,l;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.userData.data.records_consultation?Object(ve.a)(r.userData.data.records_consultation):[],-1!==(l=i.indexOf(n))?i.splice(l,1):i.length>=10&&i.pop(),i.unshift(n),e.next=6,a({variables:{key:"".concat(Wa,"_").concat(t),value:i,global:!1}});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var qa=function(e,t){return Ya.apply(this,arguments)},Qa=n(731);var Ka=function(e){var t=e.rows,n=Array(t).fill("").map((function(e,t){return t}));return Object(B.jsx)(B.Fragment,{children:n.map((function(e){return Object(B.jsxs)("div",{"data-testid":"edit-record-skeleton",children:[Object(B.jsx)(va.a.Input,{active:!0,size:"large",style:{width:100,margin:"0 .5rem"}}),Object(B.jsx)(va.a.Input,{active:!0,size:"large",style:{width:450,margin:"0 .5rem"}}),Object(B.jsx)(Qa.a,{})]},e)}))})},Xa=Object(r.createContext)({elements:{},readOnly:!1}),Ja=function(){return Object(r.useContext)(Xa)};var Za=function(e){var t,n=e.element,r=e.record,i=e.onValueSubmit,a=e.onValueDelete,l=null!==(t=Ja().elements[n.id])&&void 0!==t?t:[];return Object(B.jsx)(B.Fragment,{children:l.map((function(e){return Object(B.jsx)(Ei.a,{"data-testid":"container-child-element",children:Object(B.jsx)(_i.a,{span:24,children:e.uiElement&&Object(B.jsx)(e.uiElement,{element:e,record:r,onValueSubmit:i,onValueDelete:a})})},e.id)}))})};var el,tl=function(e){var t,n=null!==(t=e.element.settings.title)&&void 0!==t?t:null;return Object(B.jsx)(Qa.a,{children:n})},nl=n(320),rl=Object(Ke.a)(nl.a)(el||(el=Object(Qe.a)(["\n    && {\n        padding: 1rem;\n        border: 1px solid ",";\n        margin: 1rem 0;\n        border-radius: 3px;\n        overflow: visible;\n    }\n"])),Je.a["@leav-secondary-divider-color"]);var il,al=function(e){var t=e.element,n=e.record,r=e.onValueSubmit,i=e.onValueDelete,a=yt(),l=Object(o.a)(a,1)[0].lang,c=t.settings.direction===Fi.TabsDirection.VERTICAL?"left":"top";return Object(B.jsx)(rl,{tabPosition:c,"data-testid":"form-tabs",children:t.settings.tabs.map((function(e){var a={id:"".concat(t.id,"/").concat(e.id),containerId:t.id,settings:{},attribute:null,type:j.layout,uiElement:Zo[Fi.FormUIElementTypes.FIELDS_CONTAINER],uiElementType:Fi.FormUIElementTypes.FIELDS_CONTAINER,values:null};return Object(B.jsx)(nl.a.TabPane,{tab:Mt(e.label,l),children:Object(B.jsx)(a.uiElement,{element:a,record:n,onValueSubmit:r,onValueDelete:i})},e.id)}))})},ll=n(758),cl=n(414),ol=Ke.a.div(il||(il=Object(Qe.a)(["\n    position: fixed;\n    z-index: 1;\n    top: 0;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    background-color: rgba(0, 0, 0, 0.2);\n"])));var sl,dl,ul=function(e){var t=e.onClick;return Object(B.jsx)(ol,{"data-testid":"dimmer",onClick:function(){return t()}})},bl=Ke.a.div(sl||(sl=Object(Qe.a)(["\n    color: ",";\n    font-weight: bold;\n"])),Je.a["@error-color"]),jl=Ke.a.ul(dl||(dl=Object(Qe.a)(["\n    list-style: none;\n"])));var vl,Ol,fl=function(e){var t=e.error,n=e.onClose,r=Array.isArray(t)?Object(B.jsx)(jl,{children:t.map((function(e){return Object(B.jsx)("li",{children:e})}))}):t;return Object(B.jsx)(bl,{children:Object(B.jsxs)(Qn.b,{size:"small",align:"start",children:[Object(B.jsx)(ji.a,{}),r,Object(B.jsx)(D.a,{onClick:n,size:"small",icon:Object(B.jsx)(Br.a,{}),style:{border:"none"}})]})})},pl=function(e){return e.reduce((function(e,t,n){return n&&e.push({operator:O.OR}),e.push({field:"id",condition:v.EQUAL,value:t}),e}),[])},hl=function(e,t,n){var i=Object(r.useState)(),a=Object(o.a)(i,2),l=a[0],c=a[1],s=function(t){var n,r;return(null!==(n=null===(r=t[e])||void 0===r?void 0:r.list)&&void 0!==n?n:[]).reduce((function(e,t){return e[t._id]=t,e}),{})},d=Object(vt.a)(function(e,t){return Kt(vl||(vl=Object(Qe.a)(["\n    ","\n\n    query RECORD_COLUMNS_VALUES_","($filters: [RecordFilterInput]) {\n        ","(filters: $filters) {\n            list {\n                _id: id\n                ","\n            }\n        }\n    }"])),t.length?ft:"",e,e,t.length?t.map((function(e){return function(e){return"\n    ".concat(e,': property(attribute: "').concat(e,'") {\n        ...on Value {\n            value\n        }\n\n        ...on LinkValue {\n            linkValue: value {\n                ...RecordIdentity\n            }\n        }\n\n        ...on TreeValue {\n            treeValue: value {\n                record {\n                    ...RecordIdentity\n                }\n            }\n        }\n    }\n')}(e)})).join("\n"):"")}(e,t),{variables:{filters:pl(n)},skip:!e||!t.length||!n.length,onCompleted:function(e){var t=s(e);c(t)}}),u=function(){var e=Object(it.a)(rt.a.mark((function e(t){var n,r,i;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={filters:pl(null!==t&&void 0!==t?t:[])},e.next=3,d.refetch(n);case 3:return r=e.sent,i=s(r.data),c(Object($.a)(Object($.a)({},l),i)),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object($.a)(Object($.a)({},d),{},{loading:d.loading||void 0===typeof l,data:l,refetch:u})},ml=n(98),gl=n(779),xl=Object(Ke.a)((function(e){e.bordered;var t=Object(ml.a)(e,["bordered"]);return Object(B.jsx)(D.a,Object($.a)({},t))}))(Ol||(Ol=Object(Qe.a)(["\n    && {\n        color: ",";\n        &,\n        &:hover,\n        &[disabled] {\n            background: transparent;\n        }\n        text-align: left;\n\n        ","\n    }\n"])),Je.a["@leav-secondary-font-color"],(function(e){return e.bordered?"":"&, &:hover {border: 0;}"}));var yl,El,_l=function(e){var t=e.bordered,n=void 0!==t&&t,r=Object(ml.a)(e,["bordered"]),i=Object(F.a)().t;return Object(B.jsxs)(xl,Object($.a)(Object($.a)({bordered:n},r),{},{children:[Object(B.jsx)(gl.a,{}),i("record_edition.add_value")]}))},Tl=n(780),Sl=n(781),wl=Ke.a.div(yl||(yl=Object(Qe.a)(["\n    font-size: 1.1em;\n\n    span {\n        margin-left: 0.5em;\n    }\n"]))),Il=Object(Ke.a)(D.a)(El||(El=Object(Qe.a)(["\n    && {\n        border: none;\n        width: 100%;\n        color: rgba(0, 0, 0, 0.25);\n    }\n\n    &&:hover {\n        border: none;\n    }\n"])));var kl,Rl=function(e){var t=e.canAddValue,n=e.onAddValue,r=Object(F.a)().t;return Object(B.jsx)(wl,{onClick:n,children:t?Object(B.jsxs)(Il,{onClick:n,size:"small",children:[Object(B.jsx)(Tl.a,{}),Object(B.jsx)("span",{children:r("record_edition.add_value")})]}):Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(Sl.a,{}),Object(B.jsx)("span",{children:r("record_edition.no_value")})]})})};!function(e){e.SUCCESS="SUCCESS",e.ERROR="ERROR",e.PARTIAL="PARTIAL"}(kl||(kl={}));var Al=n(782),Cl=n(732);var Nl,Ll=function(e){var t=e.onDelete,n=Object(ml.a)(e,["onDelete"]),r=Object(F.a)().t;return Object(B.jsx)(Cl.a,{placement:"leftTop",title:r("record_edition.delete_value_confirm"),onConfirm:function(){return t()},okText:r("global.submit"),okButtonProps:{"aria-label":"delete-confirm-button"},cancelText:r("global.cancel"),children:Object(B.jsx)(D.a,Object($.a)(Object($.a)({shape:"circle"},n),{},{icon:Object(B.jsx)(Al.a,{}),style:{background:"#FFF"},danger:!0,"aria-label":"delete-value",onClick:function(e){return e.stopPropagation()},className:"delete-value-button"}))})},Vl=n(783);!function(e){e.TOGGLE_SIDEBAR="TOGGLE_SIDEBAR",e.SET_ACTIVE_VALUE="SET_ACTIVE_VALUE"}(Nl||(Nl={}));var Dl={record:null,activeValue:null,sidebarCollapsed:!0},Fl=function(e,t){switch(t.type){case Nl.TOGGLE_SIDEBAR:return Object($.a)(Object($.a)({},e),{},{sidebarCollapsed:!e.sidebarCollapsed});case Nl.SET_ACTIVE_VALUE:return Object($.a)(Object($.a)({},e),{},{activeValue:t.value});default:return e}},Pl=i.a.createContext({state:Dl,dispatch:function(){return Dl}}),Ul=function(){return Object(r.useContext)(Pl)};var Bl=function(e){var t=e.value,n=e.attribute,r=Object(ml.a)(e,["value","attribute"]),i=Ul().dispatch;return Object(B.jsx)(D.a,Object($.a)(Object($.a)({className:"value-details-btn",shape:"circle"},r),{},{icon:Object(B.jsx)(Vl.a,{}),onClick:function(){i({type:Nl.SET_ACTIVE_VALUE,value:{value:t,attribute:n}})}}))},Hl=n(784);var zl=function(e){var t=e.record,n=Object(ml.a)(e,["record"]),i=Object(r.useState)(),a=Object(o.a)(i,2),l=a[0],c=a[1];return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(D.a,Object($.a)(Object($.a)({"aria-label":"edit-record",shape:"circle"},n),{},{icon:Object(B.jsx)(Hl.a,{size:48}),onClick:function(e){e.stopPropagation(),e.preventDefault(),c(!0)}})),l&&Object(B.jsx)(Ps,{open:l,record:t,library:t.library.id,onClose:function(){c(!1)}})]})};var Gl,Ml,$l=function(e){var t=e.record,n=e.onDelete,r=e.value,i=e.attribute,a=e.isReadOnly,l=e.children,c=Object(F.a)().t,o=[{title:c("global.edit"),button:Object(B.jsx)(zl,{record:t,shape:"circle"})},{title:c("record_edition.value_details"),button:Object(B.jsx)(Bl,{value:r,attribute:i})}];return a||o.push({title:c("global.delete"),button:Object(B.jsx)(Ll,{onDelete:function(){return n(t)}})}),Object(B.jsxs)("div",{children:[l,Object(B.jsx)(In,{actions:o})]})},Wl=n(785),Yl=n(786),ql=n(416),Ql=n.n(ql),Kl=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return"\n        embedded_fields {\n            id\n            format\n            label\n            ".concat(t>0?e(t-1):"","\n        }\n    ")};function Xl(e){var t,n=e.library;return Object(vt.a)((t=100,Kt(Gl||(Gl=Object(Qe.a)(["\n    query GET_LIBRARY_DETAIL_EXTENDED($libId: ID) {\n        libraries(filters: {id: $libId}) {\n            list {\n                id\n                system\n                label\n                linkedTrees {\n                    id\n                    label\n                    permissions {\n                        access_tree\n                    }\n                }\n                attributes {\n                    type\n                    format\n                    label\n                    multiple_values\n                    ... on StandardAttribute {\n                        id\n                        ","\n                    }\n                    ... on LinkAttribute {\n                        id\n                        linked_library {\n                            id\n                            label\n                            attributes {\n                                type\n                                format\n                                label\n                                multiple_values\n                                ... on StandardAttribute {\n                                    id\n                                    ","\n                                }\n                                ... on LinkAttribute {\n                                    id\n                                }\n                                ... on TreeAttribute {\n                                    id\n                                    linked_tree {\n                                        id\n                                        label\n                                    }\n                                }\n                            }\n                            __typename\n                        }\n                        __typename\n                    }\n                    ... on TreeAttribute {\n                        id\n                        linked_tree {\n                            id\n                            label\n                            libraries {\n                                library {\n                                    id\n                                    label\n                                    attributes {\n                                        id\n                                        type\n                                        format\n                                        label\n                                        multiple_values\n                                        ... on StandardAttribute {\n                                            id\n                                            ","\n                                        }\n                                        ... on LinkAttribute {\n                                            id\n                                        }\n                                        ... on TreeAttribute {\n                                            id\n                                            linked_tree {\n                                                id\n                                                label\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n                gqlNames {\n                    query\n                    type\n                    filter\n                    searchableFields\n                }\n                defaultView {\n                    id\n                    description\n                    label\n                    display {\n                        size\n                        type\n                    }\n                    shared\n                    filters {\n                        field\n                        value\n                        condition\n                        operator\n                    }\n                    color\n                    sort {\n                        field\n                        order\n                    }\n                    settings {\n                        name\n                        value\n                    }\n                }\n                permissions {\n                    access_library\n                    access_record\n                    create_record\n                    edit_record\n                    delete_record\n                }\n            }\n        }\n    }\n"])),Kl(t),Kl(t),Kl(t))),{variables:{libId:n},skip:!n})}var Jl=Ke.a.div(Ml||(Ml=Object(Qe.a)(["\n    position: relative;\n    height: 95%;\n"])));var Zl,ec,tc,nc=function(e){var t=e.visible,n=e.setVisible,r=e.submitAction,i=e.libId,a=Object(F.a)().t,l=Le((function(e){return{selectionState:e.selection}})).selectionState,c=Object(G.c)(),o=function(){c(Re()),n(!1)},s=function(){r(l.searchSelection),o()},d=function(e){return Object(B.jsx)(Zn.a,{visible:t,onCancel:o,width:"95vw",bodyStyle:{height:"90vh",overflow:"hidden"},style:{top:"1rem"},closable:!1,onOk:s,okText:a("global.apply"),cancelText:a("global.cancel"),children:e})},u=Xl({library:i}),b=u.loading,j=u.data,v=u.error;return b?d(Object(B.jsx)(ja,{})):v?d(Object(B.jsx)(tt,{message:v.message})):j.libraries.list.length?j.libraries.list[0].permissions.access_library?d(Object(B.jsx)(Jl,{children:Object(B.jsx)(Iv,{selectionMode:!0,library:j.libraries.list[0]})})):Object(B.jsx)(tt,{type:te.PERMISSION_ERROR,showActionButton:!1}):d(Object(B.jsx)(tt,{message:a("lib_detail.not_found")}))},rc=n(757),ic=n(213),ac=n.n(ic),lc=n(189),cc=n.n(lc),oc=Ke.a.div(Zl||(Zl=Object(Qe.a)(["\n    background-color: ",";\n    border-radius: 5px;\n\n    .ant-list-items {\n        max-height: ",";\n        overflow-y: auto;\n    }\n"])),Je.a["@default-bg"],(function(e){return e.maxHeight||"auto"})),sc=Object(Ke.a)(rc.b.Item)(ec||(ec=Object(Qe.a)(["\n    cursor: ",";\n    && {\n        padding: 0;\n        justify-content: flex-start;\n    }\n"])),(function(e){return e.onClick?"pointer":"auto"})),dc=Ke.a.div(tc||(tc=Object(Qe.a)(["\n    margin: 0 1em;\n"])));var uc,bc,jc,vc,Oc,fc,pc,hc=function(e){var t=e.maxHeight,n=e.onItemClick,r=e.renderItemContent,i=e.selectable,a=e.selectedItems,l=e.onSelectionChange,c=Object(ml.a)(e,["maxHeight","onItemClick","renderItemContent","selectable","selectedItems","onSelectionChange"]),o=Object($.a)({renderItem:function(e){var t=n?function(){n(e)}:null;return Object(B.jsxs)(sc,{onClick:t,children:[i&&Object(B.jsx)(dc,{onClick:function(e){return e.stopPropagation()},children:Object(B.jsx)(ac.a,{checked:a.some((function(t){return cc()(e,t)})),onChange:function(t){var n=Object(ve.a)(a);t.target.checked?n.push(e):n.splice(n.indexOf(e),1),l(n)}})}),r?r(e):e]})}},c),s="number"===typeof t?"".concat(t,"px"):String(t);return Object(B.jsx)(oc,{maxHeight:s,children:Object(B.jsx)(rc.b,Object($.a)({},o))})},mc=Ke.a.div(uc||(uc=Object(Qe.a)(["\n    background-color: ",";\n    padding: 1em;\n    z-index: 1;\n    position: relative;\n\n    & .record-card .label {\n        font-weight: normal;\n        padding: 0.2em;\n    }\n\n    & .ant-list-pagination {\n        margin-top: 5px;\n    }\n"])),Je.a["@default-bg"]),gc=Ke.a.div(bc||(bc=Object(Qe.a)(["\n    max-height: 30rem;\n    overflow-y: scroll;\n"]))),xc=Ke.a.div(jc||(jc=Object(Qe.a)(["\n    margin: 0 0 1em 0;\n    width: 100%;\n    display: flex;\n    direction: row;\n    align-items: center;\n"]))),yc=Object(Ke.a)(Qn.b)(vc||(vc=Object(Qe.a)(["\n    padding-top: 1em;\n    width: 100%;\n    display: flex;\n    justify-content: flex-end;\n"]))),Ec=Object(Ke.a)(Ql.a)(Oc||(Oc=Object(Qe.a)(["\n    flex-grow: 1;\n    margin-right: 1em;\n"]))),_c=Object(Ke.a)(Br.a)(fc||(fc=Object(Qe.a)(["\n    margin-left: 2em;\n"]))),Tc=Ke.a.div(pc||(pc=Object(Qe.a)(["\n    padding: 0.5rem;\n    font-style: italic;\n"]))),Sc=function(e){return Object(B.jsx)(Ba,{record:e.whoAmI,size:x.small,withLibrary:!1,withPreview:!1},e.id)};var wc,Ic,kc,Rc=function(e){var t,n,i,a=e.attribute,l=e.onAdd,c=e.onClose,s=Object(F.a)().t,d=yt(),u=Object(o.a)(d,1)[0].lang,b=a.linkValuesList.enable?a.linkValuesList.values:[],j=Object(r.useState)(b),v=Object(o.a)(j,2),O=v[0],p=v[1],h=Object(r.useRef)(),m=Object(r.useRef)(),g=Object(r.useState)([]),x=Object(o.a)(g,2),y=x[0],E=x[1],_=Object(r.useState)(!1),T=Object(o.a)(_,2),S=T[0],w=T[1],I=Object(r.useState)(1),k=Object(o.a)(I,2),R=k[0],A=k[1],C=Object(r.useState)(1),N=Object(o.a)(C,2),L=N[0],P=N[1],U=!a.linkValuesList.enable||a.linkValuesList.allowFreeEntry,H=Object(ki.a)(Ui(a.linked_library.id)),z=Object(o.a)(H,2),G=z[0],M=z[1],W=M.loading,Y=M.error,q=M.data;Object(r.useEffect)((function(){var e;h.current.scrollIntoView({block:"nearest"}),null===(e=m.current)||void 0===e||e.focus()}),[]);var Q=function(){return c()},K=function(){var e=Object(it.a)(rt.a.mark((function e(t){var n,r,i;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=t.selected).length){e.next=3;break}return e.abrupt("return");case 3:r=a.multiple_values?n:[n[0]],i=r.map((function(e){return{id:e.id,whoAmI:{id:e.id,label:e.label,library:a.linked_library,color:null,preview:null}}})),l(i);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X=null===m||void 0===m||null===(t=m.current)||void 0===t||null===(n=t.input)||void 0===n?void 0:n.value,J=q&&X?q[a.linked_library.id].list.map((function(e){return{id:e.whoAmI.id,whoAmI:e.whoAmI}})):[],Z={onItemClick:function(e){l([e])},renderItemContent:Sc,selectable:a.multiple_values,selectedItems:y,onSelectionChange:function(e){return E(e)},locale:{emptyText:s("record_edition.no_matching_value")}},ee={simple:!0,pageSize:10,current:R};return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)(mc,{"data-testid":"values-add",ref:h,children:[Object(B.jsxs)(xc,{children:[Object(B.jsx)(Ec,{placeholder:s("record_edition.search_elements"),onSearch:function(e){if(A(1),P(1),b.length){var t=b.filter((function(t){var n,r,i=new RegExp(e.toLowerCase()),a=null!==(n=String(null===(r=t.whoAmI)||void 0===r?void 0:r.label))&&void 0!==n?n:"";return!e||t.id.match(i)||a.toLowerCase().match(i)}));p(t)}U&&e&&G({variables:{fullText:e,limit:10,offset:0,sortOrder:f.asc}})},loading:W,allowClear:!0,ref:m,"aria-label":s("record_edition.search_elements")}),U&&Object(B.jsx)(D.a,{icon:Object(B.jsx)(Wl.a,{}),onClick:function(){w(!0)},children:s("record_edition.advanced_search")}),Object(B.jsx)(_c,{onClick:Q,role:"button"})]}),Object(B.jsxs)(gc,{children:[O.length||J.length||!X?Object(B.jsx)(B.Fragment,{}):s("record_edition.no_matching_value"),!!O.length&&Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(Qa.a,{orientation:"left",children:s("record_edition.values_list")}),Object(B.jsx)(hc,Object($.a)(Object($.a)({},Z),{},{"data-testid":"values_list",dataSource:O,pagination:!1}))]}),U&&!!J.length&&Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(Qa.a,{orientation:"left",children:Mt(a.linked_library.label,u)}),W&&Object(B.jsx)(V.a,{}),Y&&Object(B.jsx)(tt,{message:Y.message}),!W&&!Y&&Object(B.jsx)(hc,Object($.a)(Object($.a)({},Z),{},{"data-testid":"search_result",dataSource:J,pagination:Object($.a)(Object($.a)({},ee),{},{total:null!==(i=null===q||void 0===q?void 0:q[a.linked_library.id].totalCount)&&void 0!==i?i:0,current:L,onChange:function(e){m.current.input.value&&(P(e),G({variables:{fullText:m.current.input.value,limit:10,offset:10*(e-1),sortOrder:f.asc}}))}})}))]}),U&&!X&&Object(B.jsxs)(Tc,{children:[Object(B.jsx)(Yl.a,{})," ",s("record_edition.start_typing_message")]})]}),a.multiple_values&&Object(B.jsxs)(yc,{children:[Object(B.jsx)(D.a,{size:"small",onClick:Q,children:s("global.cancel")}),Object(B.jsx)(Ze,{size:"small",onClick:function(){l(y)},children:s("global.submit")})]})]}),S&&Object(B.jsx)(nc,{libId:a.linked_library.id,visible:S,setVisible:w,submitAction:K})]})},Ac=Ke.a.div(wc||(wc=Object(Qe.a)(["\n    position: relative;\n    z-index: ",";\n    border: 1px solid ",";\n    margin-bottom: 1.5em;\n    border-radius: ",";\n\n    tr:not(:hover) .floating-menu {\n        display: none;\n    }\n\n    td {\n        height: 2.5rem; // In case we have no value on the whole row\n    }\n\n    // Disable some unwanted antd styles\n    && table > thead > tr:first-child {\n        th:first-child,\n        th:last-child {\n            border-radius: 0;\n        }\n    }\n\n    &&& .ant-table-footer {\n        padding: 0;\n    }\n"])),(function(e){return e.isValuesAddVisible?1:"auto"}),Je.a["@border-color-base"],Je.a["@border-radius-base"]),Cc=Object(Ke.a)(zi.a)(Ic||(Ic=Object(Qe.a)(["\n    && {\n        top: calc(50% - 0.9em);\n        font-size: 0.9em;\n        background: ",";\n        padding: 0 0.5em;\n        color: ",";\n        z-index: 1;\n        margin-bottom: 0;\n    }\n"])),Je.a["@background-color-light"],Je.a["@leav-secondary-font-color"]),Nc=Ke.a.div(kc||(kc=Object(Qe.a)(["\n    text-align: left;\n"])));var Lc,Vc,Dc=function(e){var t,n,i,a,l=e.record,c=e.element,s=e.onValueSubmit,d=e.onValueDelete,u=Object(F.a)().t,b=yt(),j=Object(o.a)(b,1)[0].lang,v=Ja().readOnly,O=null!==(t=c.values)&&void 0!==t?t:[],f=c.attribute,p=c.settings,h=null!==(n=null===p||void 0===p?void 0:p.columns)&&void 0!==n?n:[],m=Object(r.useState)(),g=Object(o.a)(m,2),y=g[0],E=g[1],_=Object(r.useState)(),T=Object(o.a)(_,2),S=T[0],w=T[1],I=Object(r.useState)(O),k=Object(o.a)(I,2),R=k[0],A=k[1],C=hl(null===l||void 0===l?void 0:l.library.gqlNames.query,h.map((function(e){return e.id})),O.map((function(e){return e.linkValue.id}))),N=C.loading,L=C.data,V=C.refetch,D=function(){w(!0)},P=function(){return w(!1)},U=function(){var e=Object(it.a)(rt.a.mark((function e(t){return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d({value:t.linkValue.id},f.id);case 2:if(e.sent.status!==kl.SUCCESS){e.next=6;break}return A(R.filter((function(e){return e.id_value!==t.id_value||e.linkValue.id!==t.linkValue.id}))),e.abrupt("return");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=Object(it.a)(rt.a.mark((function e(t){var n,r,i,a,c;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.map((function(e){return{attribute:f,idValue:null,value:e}})),e.next=3,s(r);case 3:(i=e.sent).status===kl.ERROR?E(i.error):i.values&&(A([].concat(Object(ve.a)(R),Object(ve.a)(i.values))),l&&V(r.map((function(e){return e.value.id})))),(null===i||void 0===i||null===(n=i.errors)||void 0===n?void 0:n.length)?(a=t.reduce((function(e,t){return Object($.a)(Object($.a)({},e),{},Object($e.a)({},t.id,t))}),{}),c=i.errors.map((function(e){var t=a[e.input].label||a[e.input].id;return"".concat(t,": ").concat(e.message)})),E(c)):w(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=(null===(i=c.attribute)||void 0===i?void 0:i.system)||v||!f.permissions.edit_value,G=[];!p.displayRecordIdentity&&(null===p||void 0===p||null===(a=p.columns)||void 0===a?void 0:a.length)||G.push({title:u("record_edition.whoAmI"),key:"whoAmI"});var M=(G=[].concat(Object(ve.a)(G),Object(ve.a)(h.map((function(e){return{title:Mt(e.label,j),key:e.id}}))))).map((function(e,t){return{title:e.title,dataIndex:e.key,render:function(n,r){var i="whoAmI"===e.key?Object(B.jsx)(Ba,{record:n,size:x.small}):N?Object(B.jsx)(va.a,{title:!0,paragraph:!1,active:!0}):Object(B.jsx)("span",{children:"boolean"===typeof n?Object(B.jsx)(ll.a,{checked:n,disabled:!0}):String(null!==n&&void 0!==n?n:"")});return t===G.length-1?Object(B.jsx)($l,{record:r.whoAmI,onDelete:function(){return U(r.value)},value:r.value,attribute:f,isReadOnly:z,children:i}):i}}})),W=R.map((function(e){return Object($.a)({key:e.id_value+e.linkValue.id,value:e,whoAmI:e.linkValue.whoAmI},(t=e.linkValue.id,h.reduce((function(e,n){var r,i;return e[n.id]=(null!==(r=null===L||void 0===L||null===(i=L[t])||void 0===i?void 0:i[n.id])&&void 0!==r?r:[]).map((function(e){return void 0!==e.value?e.value:void 0!==e.linkValue?null!==(t=e.linkValue.whoAmI.label)&&void 0!==t?t:e.linkValue.id:function(e){return void 0!==e.treeValue}(e)?null!==(n=e.treeValue.record.whoAmI.label)&&void 0!==n?n:e.treeValue.record.id:"";var t,n})).join(", "),e}),{})));var t})),Y=!z&&(f.multiple_values||!R.length);return Object(B.jsxs)(B.Fragment,{children:[S&&Object(B.jsx)(ul,{onClick:P}),Object(B.jsxs)(Ac,{isValuesAddVisible:S,children:[Object(B.jsx)(Cc,{ellipsis:{rows:1,tooltip:!0},children:c.settings.label}),Object(B.jsx)(On.a,{columns:M,dataSource:W,size:"small",pagination:!1,locale:{emptyText:Object(B.jsx)(Rl,{canAddValue:Y,onAddValue:D})},"data-testid":"linked-field-values",footer:function(){return R.length&&Y?Object(B.jsx)(Nc,{children:Object(B.jsx)(_l,{onClick:D,disabled:S})}):null},scroll:{y:280}}),S&&Y&&Object(B.jsx)(Rc,{onAdd:H,attribute:f,onClose:P})]}),y&&Object(B.jsx)(cl.a,{placement:"bottomLeft",visible:!!y,content:Object(B.jsx)(fl,{error:y,onClose:function(){E("")}})})]})},Fc=Object(r.createContext)({}),Pc="__new__";!function(e){e.PRISTINE="PRISTINE",e.DIRTY="DIRTY"}(Lc||(Lc={})),function(e){e.ADD_VALUE="ADD_VALUE",e.CHANGE_VALUE="CHANGE_VALUE",e.FOCUS_FIELD="FOCUS_FIELD",e.SET_ERROR="SET_ERROR",e.SET_ERROR_DISPLAY="SET_ERROR_DISPLAY",e.UNEDIT_FIELD="UNEDIT_FIELD",e.CLOSE_ERROR="CLOSE_ERROR",e.CLEAR_ERROR="CLEAR_ERROR",e.UPDATE_AFTER_SUBMIT="UPDATE_AFTER_SUBMIT",e.UPDATE_AFTER_DELETE="UPDATE_AFTER_DELETE",e.CANCEL_EDITING="CANCEL_EDITING"}(Vc||(Vc={}));var Uc={idValue:null,index:0,value:null,displayValue:"",editingValue:"",originRawValue:"",error:"",isErrorDisplayed:!1,isEditing:!1,state:Lc.PRISTINE},Bc=function(e,t){var n,r,i=function(n){return Object($.a)(Object($.a)({},e),{},{values:Object($.a)(Object($.a)({},e.values),{},Object($e.a)({},t.idValue,Object($.a)(Object($.a)({},e.values[t.idValue]),n)))})},a=function(e){return Object.keys(e).length?e:Object($e.a)({},Pc,Object($.a)(Object($.a)({},Uc),{},{idValue:Pc}))};switch(t.type){case Vc.ADD_VALUE:return Object($.a)(Object($.a)({},e),{},{values:Object($.a)(Object($.a)({},e.values),{},Object($e.a)({},null!==(n=t.idValue)&&void 0!==n?n:Pc,{idValue:null!==(r=t.idValue)&&void 0!==r?r:Pc,index:Object.keys(e.values).length,value:null,displayValue:"",editingValue:"",originRawValue:"",isEditing:!0,isErrorDisplayed:!1,state:Lc.PRISTINE}))});case Vc.CHANGE_VALUE:return i({editingValue:t.value,state:Lc.DIRTY});case Vc.FOCUS_FIELD:return i({isEditing:!0});case Vc.SET_ERROR:return e.values[t.idValue]?i({error:t.error,isErrorDisplayed:!0,state:Lc.DIRTY}):e;case Vc.CLEAR_ERROR:return i({error:"",isErrorDisplayed:!1});case Vc.SET_ERROR_DISPLAY:return i({isErrorDisplayed:t.displayError});case Vc.UNEDIT_FIELD:return i({isEditing:!1,isErrorDisplayed:!1,error:"",state:Lc.PRISTINE});case Vc.UPDATE_AFTER_SUBMIT:var l,c=e.attribute.format!==u.encrypted?t.newValue.raw_value:e.values[t.idValue].editingValue,o={idValue:t.newValue.id_value,value:t.newValue,displayValue:t.newValue.value,editingValue:c,originRawValue:c,error:"",isErrorDisplayed:!1,isEditing:!1,state:Lc.PRISTINE};if(t.idValue!==Pc)return i(o);var s=Object($.a)({},e),d=null===(l=s.values.__new__)||void 0===l?void 0:l.index;return delete s.values.__new__,s.values[t.newValue.id_value]=Object($.a)(Object($.a)({},o),{},{index:null!==d&&void 0!==d?d:Object.keys(s.values).length}),s;case Vc.UPDATE_AFTER_DELETE:var b=Object($.a)({},e);return delete b.values[t.idValue],b.values=a(b.values),b.values=Object.values(b.values).reduce((function(e,t,n){return Object($.a)(Object($.a)({},e),{},Object($e.a)({},t.idValue,Object($.a)(Object($.a)({},t),{},{index:n})))}),{}),b;case Vc.CANCEL_EDITING:if(t.idValue!==Pc)return i({editingValue:e.values[t.idValue].originRawValue,isEditing:!1,state:Lc.PRISTINE});var j=Object($.a)({},e);return delete j.values.__new__,j.values=a(j.values),j;default:return e}},Hc=n(66),zc=n.n(Hc);var Gc=function(e){var t=e.state,n=e.fieldValue,r=e.onSubmit,i=n.value;return Object(B.jsx)(Xn.a,{className:"nested-input",disabled:t.isReadOnly,checked:!!(null===i||void 0===i?void 0:i.value),indeterminate:"boolean"!==typeof(null===i||void 0===i?void 0:i.value),onChange:function(e){r(String(e.target.checked))}})},Mc=n(735);var $c=function(e){var t,n,r=e.state,i=e.fieldValue,a=e.onFocus,l=e.onSubmit,c=e.settings,o=(e.inputRef,i.editingValue),s=Object(F.a)().i18n,d=r.formElement.attribute,u=!!(null===d||void 0===d||null===(t=d.values_list)||void 0===t?void 0:t.enable),b=!!(null===d||void 0===d||null===(n=d.values_list)||void 0===n?void 0:n.allowFreeEntry),j=function(e){var t=e?String(e.unix()):null;l(t)},v=o?zc()(1e3*Number(o)):null,O=u?{points:["bl","tl"],offset:[0,-1]}:null;return!u||b?Object(B.jsx)(Mc.a,{className:"field-wrapper","data-testid":"datepicker",disabled:r.isReadOnly,picker:"date",onChange:j,value:v,autoFocus:!0,defaultOpen:!0,showTime:!!c.withTime,onOk:j,popupStyle:{background:Je.a["@default-bg"]},style:{background:Je.a["@default-bg"],width:"100%"},allowClear:!1,dropdownAlign:O}):Object(B.jsx)(N.a,{className:"field-wrapper ".concat(o?"has-value":""),value:o?new Intl.DateTimeFormat(s.language).format(new Date(1e3*Number(o))):"",onFocus:a,disabled:!0,allowClear:!0,autoFocus:!0},"editing")};var Wc=function(e){var t,n,r=e.state,i=e.fieldValue,a=e.onFocus,l=e.onSubmit,c=e.settings,s=i.editingValue,d=i.displayValue,u=Object(F.a)().t,b=r.formElement.attribute,j=!!(null===b||void 0===b||null===(t=b.values_list)||void 0===t?void 0:t.enable),v=!!(null===b||void 0===b||null===(n=b.values_list)||void 0===n?void 0:n.allowFreeEntry),O=function(e){var t=Object(o.a)(e,2),n=t[0],r=t[1],i=e?{from:String(n.unix()),to:String(r.unix())}:null;l(i)},f=s,p=f?[zc()(1e3*Number(f.from)),zc()(1e3*Number(f.to))]:null,h=j?{points:["bl","tl"],offset:[0,-1]}:null,m=d;return!j||v?Object(B.jsx)(Mc.a.RangePicker,{className:"field-wrapper","data-testid":"datepicker",disabled:r.isReadOnly,picker:"date",onChange:O,value:p,autoFocus:!0,defaultOpen:!0,showTime:!!c.withTime,onOk:O,popupStyle:{background:Je.a["@default-bg"]},style:{background:Je.a["@default-bg"],width:"100%"},allowClear:!1,dropdownAlign:h}):Object(B.jsx)(N.a,{className:"field-wrapper ".concat(s?"has-value":""),value:m.from&&m.to?tn(m,u):"",onFocus:a,disabled:!0,allowClear:!0,autoFocus:!0},"editing")};var Yc=function(e){var t=e.state,n=e.fieldValue,r=e.onChange,i=e.onPressEnter,a=e.inputRef,l=n.editingValue;return Object(B.jsx)(N.a.Password,{className:"nested-input",ref:a,value:String(l),onChange:function(e){r(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&i()},disabled:t.isReadOnly,autoFocus:!0,"data-testid":"encrypted-input"})};var qc=function(e){var t=e.state,n=e.fieldValue,r=e.onFocus,i=e.onPressEnter,a=e.onChange,l=e.inputRef,c=n.editingValue,o=Number(c);return Object(B.jsx)(N.a,{type:"number",ref:l,className:"nested-input",value:isNaN(o)?0:o,onFocus:r,onChange:function(e){a(String(e.target.value))},onPressEnter:function(){i()},disabled:t.isReadOnly,allowClear:!0,autoFocus:!0})};var Qc,Kc=function(e){var t=e.state,n=e.fieldValue,i=e.onFocus,a=e.onChange,l=e.onPressEnter,c=e.inputRef,o=n.isEditing,s=n.editingValue;return Object(r.useEffect)((function(){o&&c.current.focus()}),[o,c]),Object(B.jsx)(N.a,{ref:c,className:"field-wrapper ".concat(s?"has-value":""),value:String(s),onFocus:i,onChange:function(e){a(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&l()},disabled:t.isReadOnly,allowClear:!0,autoFocus:!0},"editing")},Xc=n(787),Jc=Ke.a.div(Qc||(Qc=Object(Qe.a)(["\n    cursor: pointer;\n    display: flex;\n    justify-content: space-between;\n    width: 100%;\n"])));var Zc,eo,to,no,ro,io,ao,lo=function(e){var t=e.attribute,n=e.valuesList,r=e.onValueCopy,i=e.onValueSelect,a=Object(F.a)(),l=a.t,c=a.i18n;return Object(B.jsx)(hc,{dataSource:n,bordered:!0,size:"small",maxHeight:250,locale:{emptyText:l("record_edition.no_matching_value")},renderItemContent:function(e){var n=t.format===u.date?new Intl.DateTimeFormat(c.language).format(new Date(1e3*Number(e.value))):e.value;return Object(B.jsxs)(Jc,{children:[Object(B.jsxs)("span",{children:[n,e.isNewValue&&" (".concat(l("record_edition.new_value"),")")]}),e.canCopy&&Object(B.jsx)(fn.a,{title:l("record_edition.copy_value"),children:Object(B.jsx)(D.a,{icon:Object(B.jsx)(Xc.a,{}),shape:"circle",onClick:function(t){t.stopPropagation(),r(e.rawValue)}})})]})},onItemClick:function(e){i(e.rawValue)}})},co=Ke.a.div(Zc||(Zc=Object(Qe.a)(["\n    color: ",";\n    font-weight: bold;\n"])),Je.a["@error-color"]),oo=Ke.a.div(eo||(eo=Object(Qe.a)(["\n    position: relative;\n    z-index: ",";\n"])),(function(e){return e.isEditing?2:0})),so=Ke.a.div(to||(to=Object(Qe.a)(["\n    position: relative;\n\n    && input {\n        background: ",";\n        transition: none;\n        border-radius: 0;\n        line-height: 2.5em;\n    }\n\n    ",":not(:last-child) & input:not(:hover) {\n        border-bottom: none;\n    }\n\n    ",":first-child & input {\n        border-top-left-radius: 5px;\n        border-top-right-radius: 5px;\n    }\n\n    ",":last-child & input {\n        border-bottom-left-radius: 5px;\n        border-bottom-right-radius: 5px;\n    }\n\n    &.editing input {\n        border-radius: 5px;\n    }\n\n    &.editing .field-wrapper,\n    &.editing .nested-input {\n        z-index: 0;\n    }\n\n    &.format-boolean label {\n        margin-right: 1em;\n    }\n\n    &:not(.format-boolean) label {\n        position: absolute;\n        left: 5px;\n        top: calc(50% - 0.9em);\n        font-size: 1.1em;\n        background: transparent;\n        padding: 0 0.5em;\n        color: ",";\n        transition: all 0.2s ease;\n        transition-property: left, top, font-size;\n        z-index: 1;\n        white-space: nowrap;\n        text-overflow: ellipsis;\n        overflow: hidden;\n        width: 100%;\n    }\n\n    &:not(.format-boolean):not(.editing):not(.has-value) label {\n        padding-right: 3rem;\n    }\n\n    input:disabled {\n        background: ",";\n    }\n\n    &.has-value:not(.format-boolean) label,\n    &.editing:not(.format-boolean) label {\n        top: 0px;\n        font-size: 0.9em;\n        background: transparent;\n        text-shadow: 0px 0px 4px #fff;\n        z-index: 2;\n        border-radius: 5px;\n    }\n\n    ",".first-value &.has-value:not(.format-boolean) input:not(:first-child),\n    ",".first-value &.editing:not(.format-boolean) input:not(:only-child),\n    ",".first-value &.editing.format-date_range input,\n    ",".first-value &.editing.format-date_range .ant-picker-range-separator {\n        padding-top: 1em;\n    }\n\n    &:not(.has-value):not(.editing):not(.format-boolean) input {\n        padding: 9px 0;\n    }\n\n    &:not(:hover) .floating-menu {\n        display: none;\n    }\n\n    .floating-menu {\n        top: 50%;\n        transform: translateY(-50%);\n    }\n"])),Je.a["@default-bg"],oo,oo,oo,Je.a["@leav-secondary-font-color"],Je.a["@default-bg"],oo,oo,oo,oo),uo=Ke.a.div(no||(no=Object(Qe.a)(["\n    position: absolute;\n    display: flex;\n    width: 100%;\n    flex-direction: column;\n"]))),bo=Ke.a.div(ro||(ro=Object(Qe.a)(["\n    display: flex;\n    margin: 0.5em 0;\n    justify-content: flex-end;\n\n    & > button {\n        margin-left: 0.5em;\n    }\n"]))),jo=Object(Ke.a)(C.a.Item)(io||(io=Object(Qe.a)(["\n    && {\n        margin: 0;\n    }\n"]))),vo=(ao={},Object($e.a)(ao,u.text,Kc),Object($e.a)(ao,u.date,$c),Object($e.a)(ao,u.date_range,Wc),Object($e.a)(ao,u.boolean,Gc),Object($e.a)(ao,u.numeric,qc),Object($e.a)(ao,u.encrypted,Yc),Object($e.a)(ao,u.extended,Kc),ao);var Oo,fo=function(e){var t,n,i,a,l=e.value,c=e.onSubmit,o=e.onDelete,s=e.state,d=e.dispatch,b=Object(F.a)().t,j=Object(r.useRef)(),v=Object(r.useRef)(),O=Ul().dispatch,f=s.formElement.attribute,p=!!(null===f||void 0===f||null===(t=f.values_list)||void 0===t?void 0:t.enable),h=!!(null===f||void 0===f||null===(n=f.values_list)||void 0===n?void 0:n.allowFreeEntry);Object(r.useEffect)((function(){var e;l.isEditing&&(null===j||void 0===j||null===(e=j.current)||void 0===e||e.scrollIntoView({block:"nearest"}))}),[l.isEditing]);var m=function(){var e=Object(it.a)(rt.a.mark((function e(t){var n;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t){e.next=2;break}return e.abrupt("return",x());case 2:n="object"===typeof t?JSON.stringify(t):t,c(l.idValue,n),O({type:Nl.SET_ACTIVE_VALUE,value:null});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(it.a)(rt.a.mark((function e(){var t;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p){e.next=2;break}return e.abrupt("return",m(l.editingValue));case 2:if((t=T()).length){e.next=5;break}return e.abrupt("return");case 5:return e.abrupt("return",m(t[0].value));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(it.a)(rt.a.mark((function e(){return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l.idValue!==Pc){e.next=2;break}return e.abrupt("return",_());case 2:o(l.idValue);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(){s.isReadOnly||l.isEditing||f.format===u.boolean||(d({type:Vc.FOCUS_FIELD,idValue:l.idValue}),O({type:Nl.SET_ACTIVE_VALUE,value:{value:l.value,attribute:f}}))},E=function(e){d({type:Vc.CHANGE_VALUE,idValue:l.idValue,value:e})},_=function(){d({type:Vc.CANCEL_EDITING,idValue:l.idValue}),O({type:Nl.SET_ACTIVE_VALUE,value:null})},T=function(){var e,t,n,r,i,a,c=[];p&&(c=f.format===u.date_range?(null!==(n=null===f||void 0===f||null===(r=f.values_list)||void 0===r?void 0:r.dateRangeValues)&&void 0!==n?n:[]).filter((function(e){return l.state===Lc.PRISTINE||!l.editingValue})).map((function(e){var t={from:zc()(1e3*Number(e.from)).format("L"),to:zc()(1e3*Number(e.to)).format("L")};return{value:tn(t,b),rawValue:{from:e.from,to:e.to}}})):(null!==(i=null===f||void 0===f||null===(a=f.values_list)||void 0===a?void 0:a.values)&&void 0!==i?i:[]).filter((function(e){return l.state===Lc.PRISTINE||!l.editingValue||f.format===u.date||e.match(new RegExp(String(l.editingValue),"i"))})).map((function(e){return{value:e,rawValue:e}})));var o=c.map((function(e){return Object($.a)(Object($.a)({},e),{},{isNewValue:!1,canCopy:h&&f.format!==u.date&&f.format!==u.date_range})}));return h&&String(l.editingValue)&&f.format!==u.date_range&&!(null!==(e=null===f||void 0===f||null===(t=f.values_list)||void 0===t?void 0:t.values)&&void 0!==e?e:[]).some((function(e){return e===l.editingValue}))&&o.unshift({value:String(l.editingValue),rawValue:String(l.editingValue),isNewValue:!0,canCopy:!1}),o},S=Object(B.jsx)(co,{children:Object(B.jsxs)(Qn.b,{size:"small",children:[Object(B.jsx)(ji.a,{}),l.error,Object(B.jsx)(D.a,{onClick:function(){return d({type:Vc.SET_ERROR_DISPLAY,displayError:!1,idValue:l.idValue})},size:"small",icon:Object(B.jsx)(Br.a,{}),style:{border:"none"}})]})}),w=(l.isEditing||f.format===u.boolean||!s.record)&&l.isErrorDisplayed,I="\n        ".concat(f.format?"format-".concat(f.format):"","\n        ").concat((null===(i=l.value)||void 0===i?void 0:i.value)?"has-value":"","\n        ").concat(l.isEditing?"editing":"","\n    "),k=!s.isReadOnly&&l.idValue!==Pc&&f.format!==u.boolean,R=T(),A=[{title:b("record_edition.value_details"),button:Object(B.jsx)(Bl,{value:l.value,attribute:f,shape:"circle"})}];return k&&!l.isEditing&&l.displayValue&&A.push({title:b("global.delete"),button:Object(B.jsx)(Ll,{onDelete:x,shape:"circle"})}),Object(B.jsxs)(B.Fragment,{children:[l.isEditing&&Object(B.jsx)(ul,{onClick:_}),Object(B.jsx)(oo,{isEditing:l.isEditing,className:l.index?"":"first-value",children:Object(B.jsx)(C.a,{children:Object(B.jsxs)(jo,{children:[Object(B.jsx)(cl.a,{placement:"topLeft",visible:w,content:S,children:Object(B.jsxs)(so,{isEditing:l.isEditing,className:I,"data-testid":"input-wrapper",children:[!l.index&&Object(B.jsx)("label",{className:"attribute-label",onClick:y,children:s.formElement.settings.label}),function(){if(!l.isEditing&&f.format!==u.boolean){var e=String(l.displayValue);if(l.displayValue)switch(f.format){case u.date_range:var t=l.displayValue;e=tn(t,b);break;case u.encrypted:e="\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"}return Object(B.jsx)(N.a,{className:l.displayValue?"has-value":"",value:e,onFocus:y,disabled:s.isReadOnly},"display")}var n=vo[f.format];return n?Object(B.jsx)(n,{state:s,fieldValue:l,onChange:E,onFocus:y,onSubmit:m,onPressEnter:g,settings:s.formElement.settings,inputRef:v}):Object(B.jsx)("div",{children:b("record_edition.invalid_format")})}(),Object(B.jsx)(wn,{actions:A})]})}),Object(B.jsxs)(uo,{ref:j,children:[l.isEditing&&(null===f||void 0===f||null===(a=f.values_list)||void 0===a?void 0:a.enable)&&Object(B.jsx)(lo,{attribute:f,valuesList:R,onValueSelect:m,onValueCopy:function(e){var t;null===v||void 0===v||null===(t=v.current)||void 0===t||t.focus(),E(e)}}),l.isEditing&&Object(B.jsxs)(bo,{children:[Object(B.jsx)(D.a,{size:"small",onClick:_,style:{background:"#FFF"},children:b("global.cancel")}),(!p||h)&&Object(B.jsx)(Ze,{size:"small",onClick:function(){m(l.editingValue)},children:b("global.submit")})]})]})]})})})]})},po=Ke.a.div(Oo||(Oo=Object(Qe.a)(["\n    margin-bottom: 1.5em;\n"])));var ho=function(e){var t,n=e.element,i=e.record,a=e.onValueSubmit,l=e.onValueDelete,c=Object(F.a)().t,s=Ja().readOnly,d=null!==(t=n.values)&&void 0!==t?t:[],b=n.attribute.multiple_values,j=n.attribute,v=Object(r.useContext)(Fc),O=d.length?d.reduce((function(e,t,n){var r,i,a,l;return Object($.a)(Object($.a)({},e),{},Object($e.a)({},t.id_value,Object($.a)(Object($.a)({},Uc),{},{idValue:null!==(r=null===t||void 0===t?void 0:t.id_value)&&void 0!==r?r:null,index:n,value:null!==t&&void 0!==t?t:null,displayValue:null!==(i=null===t||void 0===t?void 0:t.value)&&void 0!==i?i:"",editingValue:j.format===u.encrypted?"":null!==(a=null===t||void 0===t?void 0:t.raw_value)&&void 0!==a?a:"",originRawValue:j.format===u.encrypted?"":null!==(l=null===t||void 0===t?void 0:t.raw_value)&&void 0!==l?l:""})))}),{}):Object($e.a)({},Pc,Object($.a)(Object($.a)({},Uc),{},{idValue:Pc})),f={attribute:j,record:i,formElement:n,isReadOnly:(null===j||void 0===j?void 0:j.system)||s||!j.permissions.edit_value,values:O},p=Object(r.useReducer)(Bc,f),h=Object(o.a)(p,2),m=h[0],g=h[1];Object(r.useEffect)((function(){if(v[j.id]){var e,t,n=null!==(e=null===(t=Object.values(m.values).filter((function(e){return e.editingValue===v[j.id].input})))||void 0===t?void 0:t[0].idValue)&&void 0!==e?e:null;g({type:Vc.SET_ERROR,idValue:n,error:v[j.id].message})}}),[v,j.id,m.values]);var x=function(){var e=Object(it.a)(rt.a.mark((function e(t,n){var r,i,l,o,s,d;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t===Pc,g({type:Vc.CLEAR_ERROR,idValue:t}),e.next=4,a([{value:n,idValue:r?null:t,attribute:j}]);case 4:if((i=e.sent).status!==kl.SUCCESS){e.next=8;break}return g({type:Vc.UPDATE_AFTER_SUBMIT,newValue:i.values[0],idValue:t}),e.abrupt("return");case 8:!(l=i.error)&&i.errors&&(d=null===(o=(null!==(s=null===i||void 0===i?void 0:i.errors)&&void 0!==s?s:[]).filter((function(e){return e.attribute===j.id})))||void 0===o?void 0:o[0])&&(l=d.type===Fi.ErrorTypes.VALIDATION_ERROR?d.message:c("errors.".concat(d.type))),g({type:Vc.SET_ERROR,idValue:t,error:l});case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),y=function(){var e=Object(it.a)(rt.a.mark((function e(t){var n;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g({type:Vc.UNEDIT_FIELD,idValue:t}),e.next=3,l({id_value:t},j.id);case 3:if((n=e.sent).status!==kl.SUCCESS){e.next=7;break}return g({type:Vc.UPDATE_AFTER_DELETE,idValue:t}),e.abrupt("return");case 7:g({type:Vc.SET_ERROR,idValue:t,error:n.error});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();if(!n.attribute)return Object(B.jsx)(tt,{message:c("record_edition.missing_attribute")});var E=Object.values(m.values).sort((function(e,t){return e.index-t.index})),_=E[0].idValue!==Pc&&null!==E[0].idValue,T=b&&_&&j.format!==u.boolean;return Object(B.jsxs)(po,{children:[E.map((function(e){return Object(B.jsx)(fo,{value:e,state:m,dispatch:g,onSubmit:x,onDelete:y},e.idValue)})),T&&Object(B.jsx)(_l,{onClick:function(){g({type:Vc.ADD_VALUE})},style:{borderTopLeftRadius:0,borderTopRightRadius:0,width:"100%"},bordered:!0})]})},mo=n(417),go=n.n(mo);var xo,yo=function(e){var t=e.element;return Object(B.jsx)(go.a,{children:t.settings.content})},Eo=Ke.a.div(xo||(xo=Object(Qe.a)(["\n    padding: 0.5em 0;\n    position: relative;\n    &:not(:last-child) {\n        border-bottom: 1px solid ",";\n    }\n\n    &:not(:hover) .floating-menu {\n        display: none;\n    }\n\n    & .floating-menu {\n        right: 30px;\n    }\n"])),Je.a["@border-color-base"]);var _o,To=function(e){var t=e.value,n=e.attribute,r=e.onDelete,i=e.isReadOnly,a=Object(F.a)().t,l=function(){var e=Object(it.a)(rt.a.mark((function e(){return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c=[{title:a("record_edition.edit_record"),button:Object(B.jsx)(zl,{record:t.treeValue.record.whoAmI})},{title:a("record_edition.value_details"),button:Object(B.jsx)(Bl,{value:t,attribute:n})}];return i||c.push({title:a("global.delete"),button:Object(B.jsx)(Ll,{onDelete:l})}),Object(B.jsxs)(Eo,{children:[Object(B.jsx)(Ba,{record:t.treeValue.record.whoAmI,size:x.small}),Object(B.jsx)(In,{actions:c})]})},So=n(423),wo=n(788),Io=n(738),ko=Object(Ot.a)(_o||(_o=Object(Qe.a)(["\n    ","\n    query TREE_NODE_CHILDREN($treeId: ID!, $node: ID, $pagination: Pagination) {\n        treeNodeChildren(treeId: $treeId, node: $node, pagination: $pagination) {\n            totalCount\n            list {\n                id\n                childrenCount\n                record {\n                    ...RecordIdentity\n                }\n                permissions {\n                    access_tree\n                    detach\n                    edit_children\n                }\n            }\n        }\n    }\n"])),ft),Ro=function(e){return e.map((function(e){return{record:e.record,title:e.record.whoAmI.label||e.record.whoAmI.id,id:e.id,key:e.id,isLeaf:!e.childrenCount,children:[]}}))};var Ao,Co,No,Lo,Vo,Do,Fo=function(e){var t=e.tree,n=e.onSelect,i=e.onCheck,a=e.selectedNode,l=e.multiple,c=void 0!==l&&l,s=yt(),d=Object(o.a)(s,1)[0].lang,u=Object(F.a)().t,b={title:Mt(t.label,d)||t.id,record:null,id:t.id,key:t.id,isLeaf:!1,paginationOffset:0,children:[]},j=Object(r.useState)(Object($e.a)({},t.id,b)),v=Object(o.a)(j,2),O=v[0],f=v[1],p=Object(r.useState)(a),h=Object(o.a)(p,2),m=h[0],g=h[1],x=Object(r.useState)(),y=Object(o.a)(x,2),E=y[0],_=y[1],T=Object(ki.a)(ko),S=Object(o.a)(T,2),w=S[0],I=S[1],k=I.error,R=I.called,A=function(){var e=Object(it.a)(rt.a.mark((function e(n){var r,i,a,l,c,o,s,d,b,j,v,p,h,m=arguments;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=m.length>1&&void 0!==m[1]?m[1]:0,e.prev=1,e.next=4,w({variables:{treeId:t.id,node:n&&n!==t.id?n:null,pagination:{limit:Vt,offset:r}}});case 4:i=e.sent,a=Ro(i.data.treeNodeChildren.list),l=null!==n&&void 0!==n?n:t.id,c=Object($.a)({},O),o=i.data.treeNodeChildren.totalCount,s=c[l],d="__showMore"+l+r,s.children=s.children.filter((function(e){return!e.key.match("__showMore".concat(l))})),b=Object(Zi.a)(a);try{for(b.s();!(j=b.n()).done;)v=j.value,p=Object($.a)(Object($.a)({},v),{},{paginationOffset:0}),c[p.key]=p,s.paginationOffset=r,s.children.push(p)}catch(g){b.e(g)}finally{b.f()}o>s.paginationOffset+Vt&&(h={id:l,key:d,record:null,title:u("tree-node-selection.show_more"),isLeaf:!1,paginationOffset:0,isShowMore:!0,selectable:!1,children:[]},s.children.push(h)),f(c),_(null),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(1),_(e.t0.message);case 22:case"end":return e.stop()}}),e,null,[[1,19]])})));return function(t){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){g(a)}),[a]),Object(r.useEffect)((function(){A()}),[]);var C,N=function(){var e=Object(it.a)(rt.a.mark((function e(n){var r,i,a,l,c,o,s,d,u;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=(c=n).id,s=c.isShowMore,d=null!==(r=null===(i=O[o])||void 0===i?void 0:i.paginationOffset)&&void 0!==r?r:0,u=s?(null!==(a=null===(l=O[o])||void 0===l?void 0:l.paginationOffset)&&void 0!==a?a:0)+Vt:d,o!==t.id){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,A(String(o),u);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return R?k||E?Object(B.jsx)(tt,{message:null!==(C=null===k||void 0===k?void 0:k.message)&&void 0!==C?C:E}):Object(B.jsx)(Io.a,{defaultExpandedKeys:[m],multiple:c,selectable:!0,selectedKeys:[m],onSelect:function(e,t){var r=O[t.node.key];r&&n(r,t.selected)},onCheck:function(e){var t=("object"===typeof e?e.checked:e).map((function(e){return O[e]}));i(t)},treeData:[O[b.key]],loadData:N,checkStrictly:!0,checkable:c,showLine:{showLeafIcon:!1},switcherIcon:Object(B.jsx)(wo.a,{"aria-label":"toggle-children"})}):Object(B.jsx)(V.a,{})},Po=Ke.a.div(Ao||(Ao=Object(Qe.a)(["\n    background-color: ",";\n    z-index: 1;\n    position: relative;\n"])),Je.a["@default-bg"]),Uo=Ke.a.div(Co||(Co=Object(Qe.a)(["\n    padding: 1em;\n    max-height: 350px;\n    overflow: auto;\n"]))),Bo=Ke.a.div(No||(No=Object(Qe.a)(["\n    padding: 0.5em 1em;\n    display: flex;\n    justify-content: flex-end;\n    background: ",";\n"])),Je.a["@background-color-light"]),Ho=Ke.a.div(Lo||(Lo=Object(Qe.a)(["\n    & .record-card .label {\n        font-weight: normal;\n    }\n"]))),zo=Object(Ke.a)(So.a)(Vo||(Vo=Object(Qe.a)(["\n    display: flex;\n    align-items: center;\n"]))),Go=Object(Ke.a)(So.a.Item)(Do||(Do=Object(Qe.a)(["\n    display: flex;\n    align-items: center;\n\n    padding: 0.5em 0;\n"])));var Mo,$o,Wo,Yo=function(e){var t=e.attribute,n=e.onAdd,i=e.onClose,a=Object(F.a)().t,l=yt(),c=Object(o.a)(l,1)[0].lang,s=t.treeValuesList.enable?t.treeValuesList.values:[],d=Object(r.useRef)(),u=Object(r.useState)([]),b=Object(o.a)(u,2),j=b[0],v=b[1],O=Object(r.useState)([]),f=Object(o.a)(O,2),p=f[0],h=f[1];return Object(r.useEffect)((function(){d.current.scrollIntoView({block:"nearest"})}),[]),Object(B.jsx)(B.Fragment,{children:Object(B.jsxs)(Po,{"data-testid":"values-add",ref:d,children:[Object(B.jsxs)(Uo,{children:[!!s.length&&Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(Qa.a,{orientation:"left",children:a("record_edition.values_list")}),Object(B.jsx)(hc,{dataSource:s,onItemClick:function(e){var t=Jt(e.record);n([{record:e.record,key:t,id:t,title:e.record.whoAmI.label,children:null}])},renderItemContent:function(e){var t=e.ancestors,n=t.slice(0,-1),r=t.slice(-1)[0],i={withLibrary:!1,withPreview:!1};return Object(B.jsx)(Ho,{children:Object(B.jsxs)(zo,{separator:"",children:[n.map((function(e){return Object(B.jsxs)(Go,{children:[Object(B.jsx)(Ba,Object($.a)({record:e.record.whoAmI,size:x.small},i)),Object(B.jsx)(So.a.Separator,{children:">"})]},e.record.id)})),Object(B.jsx)(Go,{children:Object(B.jsx)(Ba,Object($.a)({record:r.record.whoAmI,size:x.small},i))},r.record.id)]})})},selectable:t.multiple_values,selectedItems:p,onSelectionChange:function(e){return h(e)},pagination:!1})]}),Object(B.jsx)(Qa.a,{orientation:"left",children:Mt(t.linked_tree.label,c)}),Object(B.jsx)(Fo,{tree:t.linked_tree,onSelect:function(e,t){t&&n([e])},onCheck:function(e){return v(e)},multiple:t.multiple_values})]}),t.multiple_values&&Object(B.jsx)(Bo,{children:Object(B.jsxs)(Qn.b,{children:[Object(B.jsx)(D.a,{size:"small",onClick:function(){return i()},children:a("global.cancel")}),Object(B.jsx)(Ze,{size:"small",onClick:function(){var e=[].concat(Object(ve.a)(p.map((function(e){var t=Jt(e.record);return{record:e.record,id:t,key:t,title:e.record.whoAmI.label,children:null}}))),Object(ve.a)(j));n(e)},children:a("global.submit")})]})})]})})},qo=Ke.a.div(Mo||(Mo=Object(Qe.a)(["\n    position: relative;\n    border: 1px solid ",";\n    margin-bottom: 1.5em;\n    border-radius: ",";\n    background: ",";\n    z-index: ",";\n\n    .ant-list-items {\n        max-height: 320px;\n        overflow-y: auto;\n    }\n\n    .ant-list-footer {\n        padding: 0;\n    }\n"])),Je.a["@border-color-base"],Je.a["@border-radius-base"],Je.a["@default-bg"],(function(e){return e.isValuesAddVisible?1:"auto"})),Qo=Object(Ke.a)(zi.a)($o||($o=Object(Qe.a)(["\n    && {\n        top: calc(50% - 0.9em);\n        font-size: 0.9em;\n        padding: 0 0.5em;\n        color: ",";\n        z-index: 1;\n        margin-bottom: 0;\n    }\n"])),Je.a["@leav-secondary-font-color"]),Ko=Ke.a.div(Wo||(Wo=Object(Qe.a)(["\n    text-align: left;\n"])));var Xo,Jo=function(e){var t,n,i=e.element,a=e.record,l=e.onValueSubmit,c=e.onValueDelete,s=i.attribute,d=Ja().readOnly,u=null!==(t=i.values)&&void 0!==t?t:[],b=Object(r.useState)(u),j=Object(o.a)(b,2),v=j[0],O=j[1];Object(r.useEffect)((function(){a&&O(null!==u&&void 0!==u?u:[])}),[u,i.settings.attribute,a]);var f=Object(r.useState)(),p=Object(o.a)(f,2),h=p[0],m=p[1],g=Object(r.useState)(),x=Object(o.a)(g,2),y=x[0],E=x[1],_=(null===(n=i.attribute)||void 0===n?void 0:n.system)||d||!s.permissions.edit_value,T=v.map((function(e){return Object($.a)(Object($.a)({},e),{},{key:e.id_value})})),S=!_&&(s.multiple_values||!v.length),w=function(){E(!0)},I=function(){var e=Object(it.a)(rt.a.mark((function e(t){var n,r,i,a,c;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.map((function(e){return{attribute:s,idValue:null,value:e}})),e.next=3,l(r);case 3:(i=e.sent).status===kl.ERROR?m(i.error):i.values&&O([].concat(Object(ve.a)(v),Object(ve.a)(i.values))),(null===i||void 0===i||null===(n=i.errors)||void 0===n?void 0:n.length)?(a=t.reduce((function(e,t){return Object($.a)(Object($.a)({},e),{},Object($e.a)({},t.id,t))}),{}),c=i.errors.map((function(e){var t=a[e.input].title||a[e.input].id;return"".concat(t,": ").concat(e.message)})),m(c)):E(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=v.length&&S?Object(B.jsx)(Ko,{children:Object(B.jsx)(_l,{onClick:w,disabled:y})}):null,R=function(){return E(!1)};return Object(B.jsxs)(B.Fragment,{children:[y&&Object(B.jsx)(ul,{onClick:R}),Object(B.jsxs)(qo,{isValuesAddVisible:y,children:[Object(B.jsx)(Qo,{ellipsis:{rows:1,tooltip:!0},children:i.settings.label}),Object(B.jsx)(rc.b,{dataSource:T,renderItem:function(e){var t=function(){var t=Object(it.a)(rt.a.mark((function t(){return rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c({id_value:e.id_value},s.id);case 2:if(t.sent.status!==kl.SUCCESS){t.next=6;break}return O(v.filter((function(t){return t.id_value!==e.id_value}))),t.abrupt("return");case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(B.jsx)(To,{value:e,attribute:s,onDelete:t,isReadOnly:_})},split:!0,locale:{emptyText:Object(B.jsx)(Rl,{canAddValue:S,onAddValue:w})},footer:k}),y&&Object(B.jsx)(Yo,{attribute:s,onAdd:I,onClose:R})]}),h&&Object(B.jsx)(cl.a,{placement:"bottomLeft",visible:!!h,content:Object(B.jsx)(fl,{error:h,onClose:function(){m("")}})})]})},Zo=(Xo={},Object($e.a)(Xo,Fi.FormUIElementTypes.FIELDS_CONTAINER,Za),Object($e.a)(Xo,Fi.FormFieldTypes.TEXT_INPUT,ho),Object($e.a)(Xo,Fi.FormFieldTypes.DATE,ho),Object($e.a)(Xo,Fi.FormFieldTypes.CHECKBOX,ho),Object($e.a)(Xo,Fi.FormFieldTypes.ENCRYPTED,ho),Object($e.a)(Xo,Fi.FormFieldTypes.LINK,Dc),Object($e.a)(Xo,Fi.FormFieldTypes.TREE,Jo),Object($e.a)(Xo,Fi.FormUIElementTypes.TABS,al),Object($e.a)(Xo,Fi.FormUIElementTypes.TEXT_BLOCK,yo),Object($e.a)(Xo,Fi.FormUIElementTypes.DIVIDER,tl),Xo),es=function(e){return e.elements.reduce((function(e,t){return"undefined"===typeof e[t.containerId]&&(e[t.containerId]=[]),e[t.containerId].push(Object($.a)(Object($.a)({},t),{},{uiElement:Zo[t.uiElementType],settings:t.settings.reduce((function(e,t){return Object($.a)(Object($.a)({},e),{},Object($e.a)({},t.key,t.value))}),{})})),e}),{})};var ts,ns=function(e){var t,n,r,i=e.record,a=e.library,l=e.onValueSubmit,c=e.onValueDelete,o=e.readonly,s=i?"edition":"creation",d=Object(F.a)().t;qa(null!==(t=null===i||void 0===i||null===(n=i.library)||void 0===n?void 0:n.id)&&void 0!==t?t:null,null!==(r=null===i||void 0===i?void 0:i.id)&&void 0!==r?r:null);var u=Object(vt.a)($a,{fetchPolicy:"network-only",variables:{libraryId:a,recordId:null===i||void 0===i?void 0:i.id,formId:s}}),b=u.loading,v=u.data,O=u.error;if(b)return Object(B.jsx)(Ka,{rows:5});if(O){var f,p,h,m,g,x=null!==(f=Object.values(null!==(p=null===(h=O.graphQLErrors[0])||void 0===h||null===(m=h.extensions)||void 0===m||null===(g=m.exception)||void 0===g?void 0:g.fields)&&void 0!==p?p:{}).join("\n"))&&void 0!==f?f:null===O||void 0===O?void 0:O.message;return Object(B.jsx)(tt,{message:null!==x&&void 0!==x?x:d("record_edition.no_form_error")})}var y=v.recordForm,E=es(y),_={id:Fi.FORM_ROOT_CONTAINER_ID,containerId:null,type:j.layout,uiElementType:Fi.FormUIElementTypes.FIELDS_CONTAINER,settings:{},attribute:null,values:null,uiElement:Zo[Fi.FormUIElementTypes.FIELDS_CONTAINER]};return Object(B.jsx)(Xa.Provider,{value:{elements:E,readOnly:o},children:Object(B.jsx)(_.uiElement,{element:_,record:i,onValueSubmit:l,onValueDelete:c})})},rs=Object(Ot.b)(ts||(ts=Object(Qe.a)(["\n    mutation DELETE_VALUE($library: ID!, $recordId: ID!, $attribute: ID!, $value: ValueInput) {\n        deleteValue(library: $library, recordId: $recordId, attribute: $attribute, value: $value) {\n            id_value\n            attribute {\n                id\n                format\n                type\n                system\n            }\n        }\n    }\n"]))),is=function(e){return'property({"attribute":"'.concat(e,'"})')};var as,ls=n(262),cs=Object(Ot.a)(as||(as=Object(Qe.a)(["\n    ","\n    mutation SAVE_VALUE_BATCH(\n        $library: ID!\n        $recordId: ID!\n        $version: [ValueVersionInput!]\n        $values: [ValueBatchInput!]!\n    ) {\n        saveValueBatch(library: $library, recordId: $recordId, version: $version, values: $values) {\n            values {\n                id_value\n                modified_at\n                modified_by {\n                    ...RecordIdentity\n                }\n                created_at\n                created_by {\n                    ...RecordIdentity\n                }\n                version\n                attribute {\n                    id\n                    format\n                    type\n                    system\n                }\n\n                ... on Value {\n                    value\n                    raw_value\n                }\n\n                ... on LinkValue {\n                    linkValue: value {\n                        ...RecordIdentity\n                    }\n                }\n\n                ... on TreeValue {\n                    treeValue: value {\n                        record {\n                            ...RecordIdentity\n                        }\n\n                        ancestors {\n                            record {\n                                ...RecordIdentity\n                            }\n                        }\n                    }\n                }\n            }\n            errors {\n                type\n                attribute\n                input\n                message\n            }\n        }\n    }\n"])),ft);var os=Fl,ss=n(752);var ds,us=function(e){var t=e.items;return Object(B.jsx)(ss.b,{layout:"horizontal",column:1,children:t.map((function(e,t){var n=e,r=n.title,i=n.value;return Object(B.jsx)(ss.b.Item,{label:r,style:{paddingBottom:"5px"},labelStyle:{fontWeight:"bold",width:"50%"},children:e.divider?Object(B.jsx)(Qa.a,{"data-testid":"divider"},t):i},t)}))})},bs=Ke.a.div(ds||(ds=Object(Qe.a)(["\n    padding: 1em;\n"])));var js,vs=function(e){var t,n,r=e.record,i=null===r||void 0===r||null===(t=r.preview)||void 0===t?void 0:t.medium,a=Object(F.a)().t,l=yt(),c=Object(o.a)(l,1)[0].lang,s=[{title:a("record_summary.label"),value:null===r||void 0===r?void 0:r.label},{title:a("record_summary.id"),value:null===r||void 0===r?void 0:r.id},{title:a("record_summary.library"),value:Mt(null===r||void 0===r?void 0:r.library.label,c)}];return Object(B.jsxs)(bs,{children:[Object(B.jsx)(ka,{label:null!==(n=null===r||void 0===r?void 0:r.label)&&void 0!==n?n:null===r||void 0===r?void 0:r.id,color:null===r||void 0===r?void 0:r.color,image:i&&Dt(i),tile:!0,size:x.medium,style:{borderRadius:Je.a["@border-radius-base"],marginBottom:"1rem"}}),Object(B.jsx)(us,{items:s})]})},Os=n(746),fs=Object(Ke.a)(Io.a)(js||(js=Object(Qe.a)(["\n    && {\n        background: none;\n    }\n"])));var ps,hs,ms,gs=function(e){var t,n=e.value,r=e.attribute,i=yt(),a=Object(o.a)(i,1)[0].lang,l=null!==(t=n.treeValue.ancestors)&&void 0!==t?t:[],c={checkable:!1,selectable:!1},s=Object(ve.a)(l).reverse().reduce((function(e,t){return[Object($.a)(Object($.a)({},c),{},{title:t.record.whoAmI.label,key:t.record.id,children:null!==e&&void 0!==e?e:[]})]}),[]),d=[Object($.a)(Object($.a)({},c),{},{title:Mt(r.linked_tree.label,a),key:r.linked_tree.id,children:s})];return Object(B.jsx)(fs,{showIcon:!1,treeData:d,defaultExpandAll:!0},n.id_value)},xs=Ke.a.div(ps||(ps=Object(Qe.a)(["\n    font-weight: bold;\n    padding: 1em;\n"]))),ys=Ke.a.div(hs||(hs=Object(Qe.a)(["\n    color: rgba(0, 0, 0, 0.5);\n    padding: 0 1em;\n"]))),Es=Object(Ke.a)(Br.a)(ms||(ms=Object(Qe.a)(["\n    cursor: pointer;\n    position: absolute;\n    right: 1em;\n    top: 1em;\n"]))),_s=Os.a.Panel;var Ts=function(e){var t=e.attribute,n=e.value,r=yt(),i=Object(o.a)(r,1)[0].lang,a=Object(F.a)().t,l=Ul(),c=l.state,s=l.dispatch,d=(null===n||void 0===n?void 0:n.modified_at)?[{title:a("record_edition.modified_at"),value:"".concat(new Date(1e3*n.modified_at).toLocaleString()," ").concat((null===n||void 0===n?void 0:n.modified_by)?" ".concat(a("record_edition.by")," ").concat(n.modified_by.whoAmI.label):"")}]:[],u=[{title:a("record_edition.attribute.id"),value:t.id},{title:a("record_edition.attribute.type"),value:a("record_edition.attribute.type_".concat(t.type))},{title:a("record_edition.attribute.format"),value:t.format?a("record_edition.attribute.format_".concat(t.format)):null}];return Object(B.jsxs)(B.Fragment,{children:[!c.sidebarCollapsed&&Object(B.jsx)(Es,{onClick:function(){return s({type:Nl.SET_ACTIVE_VALUE,value:null})}}),Object(B.jsx)(xs,{children:Mt(t.label,i)}),Object(B.jsx)(ys,{children:Mt(t.description,i)}),Object(B.jsx)(Qa.a,{style:{margin:".5em 0"}}),Object(B.jsxs)(Os.a,{bordered:!1,defaultActiveKey:["attribute","value"],style:{background:"none"},destroyInactivePanel:!0,children:[d.length&&Object(B.jsx)(_s,{header:a("record_edition.value_details_section"),children:Object(B.jsx)(us,{items:d})},"value"),Object(B.jsx)(_s,{header:a("record_edition.attribute_details_section"),children:Object(B.jsx)(us,{items:u})},"attribute"),t.type===b.tree&&Object(B.jsx)(_s,{header:a("record_edition.path_section"),children:Object(B.jsx)(gs,{value:n,attribute:t})},"path")]})]})};var Ss,ws,Is,ks,Rs,As=function(){var e=Ul().state;return e.activeValue?Object(B.jsx)(Ts,{value:e.activeValue.value,attribute:e.activeValue.attribute}):Object(B.jsx)(vs,{record:e.record})},Cs=Ke.a.div(Ss||(Ss=Object(Qe.a)(["\n    height: calc(100vh - 12rem);\n    display: grid;\n    grid-template-columns: auto ",";\n    grid-template-rows: 5em auto;\n    grid-template-areas:\n        'title sidebar'\n        'content sidebar';\n    overflow: hidden;\n"])),(function(e){return e.isSidebarCollapsed?0:"300px"})),Ns=Ke.a.div(ws||(ws=Object(Qe.a)(["\n    grid-area: title;\n    align-self: center;\n    font-size: 1.2rem;\n    padding: 1rem;\n"]))),Ls=Ke.a.div(Is||(Is=Object(Qe.a)(["\n    height: calc(100vh - 16.5rem);\n    grid-area: content;\n    padding: 1em;\n    overflow-x: hidden;\n    overflow-y: scroll;\n"]))),Vs=Ke.a.div(ks||(ks=Object(Qe.a)(["\n    position: relative;\n    grid-area: sidebar;\n    background: ",";\n    border-top-right-radius: 3px;\n    z-index: 1;\n"])),Je.a["@leav-secondary-bg"]),Ds=Ke.a.div(Rs||(Rs=Object(Qe.a)(["\n    position: absolute;\n    left: -25px;\n    padding: 5px;\n    background: ",";\n    border-top-left-radius: 3px;\n    border-bottom-left-radius: 3px;\n    cursor: pointer;\n"])),Je.a["@leav-secondary-bg"]);var Fs,Ps=function(e){var t=e.open,n=e.record,i=e.library,a=e.onClose,l=e.afterCreate,c=Object(F.a)().t,s=!n,d=Object(r.useReducer)(os,{record:n,activeValue:null,sidebarCollapsed:!1}),u=Object(o.a)(d,2),j=u[0],v=u[1],O=Ma(Object($.a)(Object($.a)({},null===n||void 0===n?void 0:n.library),{},{id:i}),null===n||void 0===n?void 0:n.id),f=O.loading,p=O.canEdit,h=O.isReadOnly,m=function(){var e=Object(ls.a)().cache,t=Object(sn.a)(cs),n=Object(o.a)(t,2),r=n[0],i=n[1].loading,a=Object(F.a)().t;return{saveValues:function(){var t=Object(it.a)(rt.a.mark((function t(n,i){var l,c,o,s,d,u,b,j,v,O,f,p,h;return rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r({variables:{library:n.library.id,recordId:n.id,values:i.map((function(e){return{attribute:e.attribute,id_value:e.idValue,value:String(e.value)}}))}});case 3:l=t.sent,c=l.data.saveValueBatch,o=c.values,s=c.errors,d=Object($.a)(Object($.a)({},n),{},{__typename:n.library.gqlNames.type}),u=Object(Zi.a)(o);try{for(j=function(){var t=b.value;e.modify({id:e.identify(d),fields:Object($e.a)({},is(t.attribute.id),(function(e){var n=Object(ve.a)(e),r=e.findIndex((function(e){return e.id_value===t.id_value}));return-1!==r?n[r]=t:n.push(t),n}))})},u.s();!(b=u.n()).done;)j()}catch(m){u.e(m)}finally{u.f()}return v=(null===s||void 0===s?void 0:s.length)&&o.length?kl.PARTIAL:(null===s||void 0===s?void 0:s.length)&&!o.length?kl.ERROR:kl.SUCCESS,t.abrupt("return",Object($.a)({status:v},l.data.saveValueBatch));case 12:return t.prev=12,t.t0=t.catch(0),p=null===(O=t.t0.graphQLErrors)||void 0===O?void 0:O[0],h=(null===p||void 0===p||null===(f=p.extensions)||void 0===f?void 0:f.code)?p.extensions.code===Fi.ErrorTypes.VALIDATION_ERROR?Object.values(p.extensions.fields).join("\n"):a("error.".concat(p.extensions.code)):t.t0.message,t.abrupt("return",{status:kl.ERROR,error:h});case 17:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e,n){return t.apply(this,arguments)}}(),loading:i}}(),g=m.saveValues,y=m.loading,E=function(e){var t=Object(sn.a)(rs,{update:function(t,n){var r=n.data.deleteValue,i=Object($.a)(Object($.a)({},e),{},{__typename:e.library.gqlNames.type});t.modify({id:t.identify(i),fields:Object($e.a)({},is(r.attribute.id),(function(e){return e.filter((function(e){return e.id_value!==r.id_value}))}))})}}),n=Object(o.a)(t,1)[0],r=Object(F.a)().t;return{deleteValue:function(){var t=Object(it.a)(rt.a.mark((function t(i,a){var l,c,o;return rt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n({variables:{library:e.library.id,attribute:a,recordId:e.id,value:i}});case 3:return t.abrupt("return",{status:kl.SUCCESS});case 6:return t.prev=6,t.t0=t.catch(0),c=t.t0.graphQLErrors[0],o=(null===c||void 0===c||null===(l=c.extensions)||void 0===l?void 0:l.code)?c.extensions.code===Fi.ErrorTypes.VALIDATION_ERROR?c.extensions.fields[a]:r("error.".concat(c.extensions.code)):t.t0.message,t.abrupt("return",{status:kl.ERROR,error:o});case 11:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e,n){return t.apply(this,arguments)}}()}}(n).deleteValue,_=Object(sn.a)(Ha,{variables:{library:i}}),T=Object(o.a)(_,1)[0],S=Object(r.useState)({}),w=Object(o.a)(S,2),I=w[0],k=w[1],R=Object(r.useState)({}),A=Object(o.a)(R,2),C=A[0],N=A[1],L=!!Object.keys(C).length,V=function(){var e=Object(it.a)(rt.a.mark((function e(t){var r,i,a,l,c,o,d,u,j,v;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return",g(n,t.map((function(e){var t=Object($.a)(Object($.a)({},e),{},{attribute:e.attribute.id});switch(e.attribute.type){case b.advanced_link:case b.simple_link:case b.tree:t.value=e.value.id;break;default:t.value=e.value}return t}))));case 2:r=Object($.a)({},C),i=[],a=Object(Zi.a)(t),e.prev=5,a.s();case 7:if((l=a.n()).done){e.next=28;break}o=l.value,d=o.attribute.id,r[d]||(r[d]={}),u={id_value:null!==(c=o.idValue)&&void 0!==c?c:"pending_".concat(Object.keys(r[d]).length+1),modified_at:null,modified_by:null,created_at:null,created_by:null,version:null,attribute:o.attribute},e.t0=o.attribute.type,e.next=e.t0===b.advanced_link||e.t0===b.simple_link?15:e.t0===b.tree?17:21;break;case 15:return u.linkValue=o.value,e.abrupt("break",24);case 17:return j=o.value,v=j.record,u.treeValue={record:v,ancestors:[{record:v}]},e.abrupt("break",24);case 21:return u.value=o.value,u.raw_value=o.value,e.abrupt("break",24);case 24:r[d][u.id_value]=Object($.a)({},u),i.push(u);case 26:e.next=7;break;case 28:e.next=33;break;case 30:e.prev=30,e.t1=e.catch(5),a.e(e.t1);case 33:return e.prev=33,a.f(),e.finish(33);case 36:return N(r),e.abrupt("return",{status:kl.SUCCESS,values:i});case 38:case"end":return e.stop()}}),e,null,[[5,30,33,36]])})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(it.a)(rt.a.mark((function e(){var t,n,r,i;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(L){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,T();case 5:n=e.sent,t=n.data.createRecord,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(2),ge({type:Y.error,content:e.t0.message,priority:q.high}),e.abrupt("return");case 13:return e.prev=13,r=Object.values(C).reduce((function(e,t){var n=Object.values(t).map((function(e){var t;switch(e.attribute.type){case b.advanced_link:case b.simple_link:t=e.linkValue.id;break;case b.tree:var n=e.treeValue;t="".concat(n.record.whoAmI.library.id,"/").concat(n.record.id);break;default:t=e.raw_value}return Object($.a)(Object($.a)({},e),{},{value:t,id_value:null,attribute:e.attribute.id})}));return[].concat(Object(ve.a)(e),Object(ve.a)(n))}),[]),e.next=17,g(t.whoAmI,r);case 17:if((i=e.sent).status!==kl.ERROR&&i.status!==kl.PARTIAL){e.next=23;break}return k(i.errors.reduce((function(e,t){return Object($.a)(Object($.a)({},e),{},Object($e.a)({},t.attribute,t))}),{})),e.abrupt("return");case 23:if(!l){e.next=26;break}return e.next=26,l(t.whoAmI);case 26:a();case 27:e.next=33;break;case 29:return e.prev=29,e.t1=e.catch(13),console.error(e.t1),e.abrupt("return");case 33:case"end":return e.stop()}}),e,null,[[2,9],[13,29]])})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=Object(it.a)(rt.a.mark((function e(t,n){var r;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return",E(t,n));case 2:return delete(r=Object($.a)({},C))[n][t.id_value],N(r),e.abrupt("return",{status:kl.SUCCESS});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),H=n?Object(B.jsx)(Ba,{record:n,size:x.small,withLibrary:!1,withPreview:!1}):c("record_edition.new_record"),z=[Object(B.jsx)(D.a,{"aria-label":c("global.close"),onClick:a,children:c("global.close")},"close")];return s&&z.push(Object(B.jsx)(Ze,{"aria-label":c("global.submit"),onClick:P,disabled:!L||f,loading:y,children:c("global.submit")},"submit")),t?Object(B.jsx)("div",{onClick:function(e){return e.stopPropagation()},onDoubleClick:function(e){return e.stopPropagation()},children:Object(B.jsx)(Zn.a,{visible:t,onCancel:a,destroyOnClose:!0,cancelText:c("global.cancel"),closable:!1,maskClosable:!0,width:"90vw",centered:!0,style:{padding:0,maxWidth:"800px"},bodyStyle:{height:"calc(100vh - 12rem)",overflowY:"auto",padding:0},footer:z,children:f?Object(B.jsx)(ja,{}):Object(B.jsx)(Pl.Provider,{value:{state:j,dispatch:v},children:Object(B.jsx)(Fc.Provider,{value:I,children:Object(B.jsxs)(Cs,{isSidebarCollapsed:j.sidebarCollapsed,children:[Object(B.jsx)(Ns,{children:H}),Object(B.jsx)(Ls,{className:"content",children:p?Object(B.jsx)(ns,{record:n,library:i,onValueSubmit:V,onValueDelete:U,readonly:h}):Object(B.jsx)(tt,{type:te.PERMISSION_ERROR,showActionButton:!1})}),Object(B.jsx)(Vs,{className:"sidebar",children:p&&Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(Ds,{onClick:function(){return v({type:Nl.TOGGLE_SIDEBAR})},children:j.sidebarCollapsed?Object(B.jsx)(na,{}):Object(B.jsx)(ia,{})}),Object(B.jsx)(As,{})," "]})})]})})})})}):Object(B.jsx)(B.Fragment,{})},Us=n(789);!function(e){e.ONLY="ONLY",e.ALL="ALL"}(Fs||(Fs={}));var Bs,Hs=function(e){var t=e.selectionType,n=e.record,r=e.size,i=e.text,a=Object(ml.a)(e,["selectionType","record","size","text"]),l=Ve();return Object(B.jsx)(D.a,Object($.a)(Object($.a)({},a),{},{"aria-label":"select-records",size:r,onClick:function(e){e.stopPropagation();var r={id:n.id,library:n.library.id,label:n.label};t===Fs.ONLY?(l(we()),l(Ie({selectionType:X.search,elementSelected:r}))):t===Fs.ALL&&l(Se({type:X.search,selected:[],allSelected:!0}))},children:i}))},zs=Ke.a.div(Bs||(Bs=Object(Qe.a)(["\n    border-left: 1px solid ",";\n    min-width: 150px;\n"])),Je.a["@divider-color"]);var Gs,Ms,$s,Ws,Ys,qs=function(e){var t=e.record,n=e.previewSize,r=e.lang,i=Object(F.a)().t,a=gt(),l=Object(o.a)(a,1)[0].permissions.delete_record,c=Le((function(e){return{selectionState:e.selection,display:e.display}})).selectionState,s="middle",d=[{title:i("global.edit"),button:Object(B.jsx)(zl,{shape:"circle",record:t,size:s})}];l&&d.push({title:i("items_list.table.actions-tooltips.remove"),icon:Object(B.jsx)(Al.a,{}),size:s,onClick:function(){return qn.b.warn(i("global.feature_not_available"))}});var u=[{title:i("items-list-row.select-only"),button:Object(B.jsx)(Hs,{selectionType:Fs.ONLY,text:i("items-list-row.select-only"),record:t,size:s})},{title:i("items-list-row.select-all"),button:Object(B.jsx)(Hs,{selectionType:Fs.ALL,text:i("items-list-row.select-all"),record:t,size:s})}],b=c.selection.selected.length||c.selection.allSelected;return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(zs,{children:Object(B.jsx)(Ba,{record:t,size:n,lang:r})}),Object(B.jsx)(In,{actions:b?u:d,size:s})]})},Qs=Ke.a.div(Gs||(Gs=Object(Qe.a)(["\n    padding: 5px;\n"]))),Ks=Ke.a.div(Ms||(Ms=Object(Qe.a)(["\n    display: flex;\n    align-items: center;\n"]))),Xs=Ke.a.span($s||($s=Object(Qe.a)(["\n    padding: 0 0.75em;\n    height: 1.75em;\n    margin: 0 1em;\n    border-radius: 2em;\n    background: ",";\n    color: #fff;\n    font-weight: bold;\n"])),Je.a["@primary-color"]),Js=function(e){var t=e.columnName,n=e.data,r=n.value,i=n.type,a=yt(),l=Object(o.a)(a,1)[0].lang,c=Object(F.a)().t,s=Gi().state,d=Wt(s.display.size),j=Array.isArray(r)?r:[r];if(!r||!j.length)return Object(B.jsx)(B.Fragment,{});switch(i){case b.simple:case b.advanced:var v=j.map((function(e){return function(e){switch(n.format){case u.date_range:return tn(e,c);default:return e}}(e)})).join(", ");return Object(B.jsx)(Qs,{children:n.format===u.extended?Object(B.jsx)(fn.a,{overlay:v,children:Object(B.jsx)(Us.a,{size:256,style:{fontSize:"2em"}})}):Object(B.jsx)(zi.a,{ellipsis:{rows:1,tooltip:v},children:v})});case b.simple_link:case b.advanced_link:case b.tree:var O=Object(Ur.a)(j),f=O[0],p=O.slice(1);return Object(B.jsxs)(Ks,{children:[Object(B.jsx)(Ba,{record:f.whoAmI,size:d,lang:l},f.whoAmI.id),p.length?Object(B.jsx)(fn.a,{overlay:p.map((function(e){var t;return null===e||void 0===e||null===(t=e.whoAmI)||void 0===t?void 0:t.label})).join(", "),children:Object(B.jsxs)(Xs,{children:["+ ",p.length]})}):Object(B.jsx)(B.Fragment,{})]});default:return t===It?Object(B.jsx)(qs,{record:r,previewSize:d,lang:l}):Object(B.jsx)(B.Fragment,{})}},Zs=n(790),ed=n(791),td=Ke.a.div(Ws||(Ws=Object(Qe.a)(["\n    display: grid;\n    place-items: center;\n    position: relative;\n    height: 100%;\n    width: 100%;\n"]))),nd=Ke.a.span(Ys||(Ys=Object(Qe.a)(["\n    && {\n        display: ",";\n        color: ",";\n        font-size: 1.5em;\n\n        .ant-checkbox-checked::after {\n            border: none;\n        }\n    }\n\n    [role='row']:hover & {\n        display: block;\n    }\n"])),(function(e){return e.checked?"block":"none"}),(function(e){return e.checked?"".concat(Je.a["@primary-color"]):Je.a["@default-text-color"]}));var rd,id=function(e){var t=e.selected;return Object(B.jsx)(td,{children:Object(B.jsx)(nd,{checked:t,role:"checkbox",children:t?Object(B.jsx)(Zs.a,{}):Object(B.jsx)(ed.a,{})})})},ad=Ke.a.div(rd||(rd=Object(Qe.a)(["\n    // Inherit background from row. If background is transparent, the sticky column won't behave properly\n    background-color: inherit;\n\n    max-width: ",";\n\n    display: flex;\n    align-items: center;\n"])),(function(e){return e.id===wt?"35px":"auto"}));var ld,cd=function(e){var t,n,r,i,a,l,c,o=e.cell,s=e.selected,d=o.getCellProps();o.column.id===It&&(d.style=Object($.a)(Object($.a)({},d.style),{},{flex:"1 0 auto",maxWidth:su,minWidth:su,zIndex:"auto"}));var u={id:null===o||void 0===o||null===(t=o.value)||void 0===t?void 0:t.id,key:null===o||void 0===o||null===(n=o.value)||void 0===n?void 0:n.id,library:null===o||void 0===o||null===(r=o.value)||void 0===r?void 0:r.library,label:null===o||void 0===o||null===(i=o.value)||void 0===i?void 0:i.label,value:null===o||void 0===o||null===(a=o.value)||void 0===a?void 0:a.value,type:null===o||void 0===o||null===(l=o.value)||void 0===l?void 0:l.type,format:null===o||void 0===o||null===(c=o.value)||void 0===c?void 0:c.format};return o.value?Object(B.jsx)(ad,Object($.a)(Object($.a)({},d),{},{id:o.column.id,selected:s,className:"body-cell",children:o.column.id===wt?Object(B.jsx)(id,{selected:s}):Object(B.jsx)(Js,{columnName:o.column.id,data:u})})):Object(B.jsx)(ad,Object($.a)({selected:s},d))};var od=Ke.a.div(ld||(ld=Object(Qe.a)(["\n    position: relative;\n    border: 2px solid transparent;\n\n    // Must set background on row for the case where we just have the infos column (part of the row is empty)\n    background-color: ",";\n\n    &:not(:hover) .floating-menu {\n        display: none;\n    }\n\n    &:hover {\n        border: 2px solid ",";\n        background-color: ",";\n    }\n"])),(function(e){return e.selected?Je.a["@leav-view-panel-label-background-active"]:Je.a["@default-bg"]}),Je.a["@primary-color"],(function(e){return e.selected?Je.a["@leav-view-panel-label-background-active"]:"".concat(Je.a["@leav-background-active"])}));var sd,dd=function(e){var t,n,i,a=e.row,l=a.getRowProps(),c=Object(r.useContext)(Ri),s=Le((function(e){return{selectionState:e.selection,display:e.display}})).selectionState,d=Object(r.useState)(!1),u=Object(o.a)(d,2),b=u[0],j=u[1],v=Ve(),O=null===(t=a.cells[0])||void 0===t||null===(n=t.row)||void 0===n||null===(i=n.original)||void 0===i?void 0:i.record;if(!a.cells.length||"undefined"===typeof O)return Object(B.jsx)(B.Fragment,{});var f=function(e,t,n,r){var i=t?e.searchSelection:e.selection;return i.type===X.search&&!!i.selected.find((function(e){return e.id===n&&e.library===r}))}(s,c,O.id,O.library.id),p=function(e,t){return t?e.searchSelection.type===X.search&&e.searchSelection.allSelected:e.selection.type===X.search&&e.selection.allSelected}(s,c)||f;return Object(B.jsxs)(od,Object($.a)(Object($.a)({},l),{},{onClick:function(){var e={id:O.id,library:O.library.id,label:O.label};v(c?Ae(e):Ie({selectionType:X.search,elementSelected:e}))},onDoubleClick:function(){j(!0)},selected:p,children:[b&&Object(B.jsx)(Ps,{open:b,library:O.library.id,record:O,onClose:function(){j(!1)}}),a.cells.map((function(e){return Object(B.jsx)(cd,{selected:p,cell:e},e.column.id)}))]}))},ud=n(793),bd=n(794),jd=n(745),vd=n(268);!function(e){e.SET_ATTRIBUTES="SET_ATTRIBUTES",e.TOGGLE_ATTRIBUTE_SELECTION="TOGGLE_ATTRIBUTE_SELECTION",e.TOGGLE_ATTRIBUTE_EXPAND="TOGGLE_ATTRIBUTE_EXPAND",e.MOVE_SELECTED_ATTRIBUTE="MOVE_SELECTED_ATTRIBUTE"}(sd||(sd={}));var Od,fd,pd,hd,md,gd={library:"",multiple:!0,canExpandExtendedAttributes:!0,selectedAttributes:[],expandedAttributePath:"",attributes:[]},xd=function(e,t){switch(t.type){case sd.SET_ATTRIBUTES:return Object($.a)(Object($.a)({},e),{},{attributes:t.attributes});case sd.TOGGLE_ATTRIBUTE_EXPAND:var n=Object($.a)({},e);return 0===e.expandedAttributePath.indexOf(t.attributePath)?n.expandedAttributePath=t.attributePath.split(".").slice(0,-1).join("."):n.expandedAttributePath=t.attributePath,n;case sd.TOGGLE_ATTRIBUTE_SELECTION:var r=Object(ve.a)(e.selectedAttributes),i=e.selectedAttributes.findIndex((function(e){return e.path===t.attribute.path}));return r=e.multiple?-1===i?[].concat(Object(ve.a)(r),[t.attribute]):[].concat(Object(ve.a)(r.slice(0,i)),Object(ve.a)(r.slice(i+1))):-1===i?[t.attribute]:[],Object($.a)(Object($.a)({},e),{},{selectedAttributes:r});case sd.MOVE_SELECTED_ATTRIBUTE:var a=Object(ve.a)(e.selectedAttributes),l=t.from,c=t.to;return a[l]?(c>a.length-1&&(c=a.length-1),l<0&&(l=0),a=function(e,t,n){var r=Array.from(e),i=r.splice(t,1),a=Object(o.a)(i,1)[0];return r.splice(n,0,a),r.filter((function(e){return!!e}))}(a,l,c),Object($.a)(Object($.a)({},e),{},{selectedAttributes:a})):e}},yd=i.a.createContext({state:gd,dispatch:function(){return gd}}),Ed=function(){return Object(r.useContext)(yd)},_d=Ke.a.span(Od||(Od=Object(Qe.a)(["\n    color: hsl(0, 0%, 13%);\n    font-weight: 700;\n"]))),Td=Ke.a.span(fd||(fd=Object(Qe.a)(["\n    color: hsl(0, 0%, 45%);\n    font-weight: 400;\n"]))),Sd=Ke.a.form(pd||(pd=Object(Qe.a)(["\n    width: 100%;\n"]))),wd=Ke.a.div(hd||(hd=Object(Qe.a)(["\n    padding: 0.5em;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    width: 100%;\n    cursor: pointer;\n    border: 2px solid transparent;\n\n    &:hover {\n        border-color: ",";\n        background-color: ",";\n    }\n"])),Je.a["@primary-color"],Je.a["@leav-background-active"]),Id=Ke.a.div(md||(md=Object(Qe.a)(["\n    margin-left: 1em;\n"])));var kd,Rd,Ad,Cd,Nd,Ld=function(e){var t=e.attribute,n=(e.depth,e.path),r=e.library,i=e.parentAttribute,a=[n,t.id].filter((function(e){return!!e})).join("."),l=yt(),c=Object(o.a)(l,1)[0].lang,s=Ed(),d=s.state,u=s.dispatch,b=function(){u({type:sd.TOGGLE_ATTRIBUTE_SELECTION,attribute:Qt(t,{path:a,library:r,parentAttributeData:i})})},j=Mt(t.label,c),v=function(e,t){return-1!==t.findIndex((function(t){return t.path===e}))}(a,d.selectedAttributes);return Object(B.jsxs)(wd,{onClick:b,"data-testid":"attribute-in-list",children:[Object(B.jsxs)(Qn.b,{children:[Object(B.jsx)(_d,{children:null!==j&&void 0!==j?j:t.id}),j&&Object(B.jsx)(Td,{children:t.id})]}),Object(B.jsx)(Id,{children:d.multiple?Object(B.jsx)(Xn.a,{checked:v,onChange:b}):Object(B.jsx)(vd.a,{checked:v,onChange:b})})]})},Vd=n(100),Dd=n(792),Fd=Ke.a.div(kd||(kd=Object(Qe.a)(["\n    border-right: 1px solid #f0f0f0;\n    padding: 0.5em;\n    display: flex;\n    align-items: center;\n"]))),Pd=Object(Ke.a)(Qn.b)(Rd||(Rd=Object(Qe.a)(["\n    padding: 0.5em;\n    flex-grow: 1;\n"]))),Ud=Ke.a.div(Ad||(Ad=Object(Qe.a)(["\n    padding: 8px;\n"]))),Bd=function(e){var t=e.selectedAttribute,n=e.handleProps,r=yt(),i=Object(o.a)(r,1)[0].lang,a=Ed().dispatch,l=Mt(t.label,i);return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(Fd,Object($.a)(Object($.a)({},n),{},{children:Object(B.jsx)(Dd.a,{})})),Object(B.jsxs)(Pd,{direction:"vertical",children:[Object(B.jsx)(_d,{children:null!==l&&void 0!==l?l:t.id}),l&&Object(B.jsx)("div",{children:Object(B.jsx)(Td,{children:t.id})})]}),Object(B.jsx)(Ud,{children:Object(B.jsx)(D.a,{icon:Object(B.jsx)(Br.a,{}),size:"small",onClick:function(){a({type:sd.TOGGLE_ATTRIBUTE_SELECTION,attribute:t})}})})]})},Hd=Ke.a.div(Cd||(Cd=Object(Qe.a)(["\n    overflow-y: auto;\n    height: calc(100vh - 15rem);\n\n    &&& > *:first-child {\n        margin-top: 0;\n    }\n\n    &&& > *:last-child {\n        margin-bottom: 0;\n    }\n"]))),zd=Ke.a.div(Nd||(Nd=Object(Qe.a)(["\n    &&& {\n        padding: 0;\n        margin: 0 10px 10px 10px;\n        display: flex;\n        justify-content: space-between;\n        border: 1px solid #f0f0f0;\n        border-radius: 2px;\n        min-height: 3rem;\n        box-shadow: 0 2px 0 rgba(0, 0, 0, 0.015);\n        background: #fff;\n    }\n"])));var Gd,Md,$d=function(){var e=Ed(),t=e.state,n=e.dispatch,r=t.selectedAttributes;return Object(B.jsx)(Hd,{children:Object(B.jsx)(Vd.a,{onDragEnd:function(e){e.destination&&e.destination.index!==e.source.index&&n({type:sd.MOVE_SELECTED_ATTRIBUTE,from:e.source.index,to:e.destination.index})},children:Object(B.jsx)(Vd.c,{droppableId:"list-attributes-selected",children:function(e){return Object(B.jsxs)("div",Object($.a)(Object($.a)({ref:e.innerRef},e.droppableProps),{},{children:[r.map((function(e,t){return e.path!==It&&Object(B.jsx)(Vd.b,{index:t,draggableId:e.path,children:function(t){return Object(B.jsx)(zd,Object($.a)(Object($.a)({ref:t.innerRef},t.draggableProps),{},{children:Object(B.jsx)(Bd,{selectedAttribute:e,handleProps:t.dragHandleProps})}))}},e.path)})),e.placeholder]}))}})})})},Wd=Ke.a.div(Gd||(Gd=Object(Qe.a)(["\n    padding: 0.3rem 1rem 0 1rem;\n    overflow-y: scroll;\n    height: calc(100vh - 15rem);\n"]))),Yd=Ke.a.div(Md||(Md=Object(Qe.a)(["\n    display: Grid;\n    grid-template-columns: repeat(",", 1fr);\n    grid-column-gap: 0.3rem;\n"])),(function(e){return e.multiple?2:1}));var qd=function(e){var t=e.library,n=e.multiple,i=void 0===n||n,a=e.selectedAttributes,l=void 0===a?[]:a,c=e.canExpandExtendedAttributes,s=void 0===c||c,d=e.onSelectionChange,u=Object(F.a)().t,b=Object(r.useRef)(null),j=yt(),v=Object(o.a)(j,1)[0].lang,O=Object(r.useState)(""),f=Object(o.a)(O,2),p=f[0],h=f[1],m=Object(r.useReducer)(xd,Object($.a)(Object($.a)({},gd),{},{library:t,multiple:i,selectedAttributes:l,canExpandExtendedAttributes:s})),g=Object(o.a)(m,2),x=g[0],y=g[1],E=Object(vt.a)(nr,{variables:{library:t},onCompleted:function(e){var t;y({type:sd.SET_ATTRIBUTES,attributes:(null===(t=e.attributes)||void 0===t?void 0:t.list)||[]})}}),_=E.loading,T=E.error;return Object(r.useEffect)((function(){d(x.selectedAttributes)}),[d,x.selectedAttributes]),_?Object(B.jsx)(V.a,{}):Object(B.jsx)(yd.Provider,{value:{state:x,dispatch:y},children:Object(B.jsxs)(Yd,{multiple:x.multiple,children:[Object(B.jsxs)(Wd,{"data-testid":"attributes-list",children:[Object(B.jsx)(Sd,{children:Object(B.jsx)(N.a.Search,{placeholder:u("attributes-list.search"),"aria-label":"search",ref:b,onChange:function(e){var t,n;return n=null!==(t=e.target.value)&&void 0!==t?t:"",void h(n)}})}),T?Object(B.jsx)(tt,{message:T.message}):Object(B.jsx)(rc.b,{children:x.attributes.filter((function(e){return!p||(-1!==Mt(e.label,v).toLowerCase().indexOf(p)||-1!==e.id.indexOf(p))})).map((function(e){return Object(B.jsx)(Ld,{attribute:e,depth:0,library:t,path:""},e.id)}))})]}),i&&Object(B.jsx)($d,{"data-testid":"selected-attributes-list"})]})})};var Qd,Kd,Xd,Jd=function(e){var t,n=e.visible,i=e.onClose,a=Object(F.a)().t,l=yt(),c=Object(o.a)(l,1)[0].lang,s=Gi(),d=s.state,j=s.dispatch,v=Object(r.useState)((null!==(t=null===d||void 0===d?void 0:d.fields)&&void 0!==t?t:[]).map((function(e){var t,n=d.attributes.find((function(t){return t.id===e.id&&t.library===e.library}));return Object($.a)(Object($.a)({},e),{},{path:e.key,label:null!==(t=null===n||void 0===n?void 0:n.label)&&void 0!==t?t:null,multiple_values:!!e.multipleValues})}))),O=Object(o.a)(v,2),f=O[0],p=O[1],h=function(){i()},m=document.getElementsByClassName("ant-modal-wrap");return m.length&&(m[0].style.overflow="initial"),Object(B.jsx)(jd.a,{visible:n,onCancel:h,title:a("table-columns-selection.header"),width:"70rem",centered:!0,footer:[Object(B.jsx)(D.a,{onClick:h,children:a("table-columns-selection.cancel")},"Cancel"),Object(B.jsx)(Ze,{onClick:function(){var e,t=f.filter((function(e){return!d.attributes.some((function(t){return t.id===e.id&&t.library===e.library}))})).map((function(e){var t;return Object($.a)(Object($.a)({},e),{},{isLink:e.type===b.tree,isMultiple:e.multiple_values,format:null!==(t=e.format)&&void 0!==t?t:void 0})})),n=[].concat(Object(ve.a)(null!==(e=null===d||void 0===d?void 0:d.attributes)&&void 0!==e?e:[]),Object(ve.a)(t));j({type:wi.SET_ATTRIBUTES,attributes:n});var r=f.reduce((function(e,t){var r,i,a,l=n.find((function(e){return e.id===t.id&&e.library===t.library}));if(!l)return e;var o=function(e){return(null===e||void 0===e?void 0:e.format)===u.extended&&e.path?"".concat(e.path):e.parentAttributeData?e.parentAttributeData.type===b.tree?"".concat(e.parentAttributeData.id,".").concat(e.library,".").concat(e.id):"".concat(e.parentAttributeData.id,".").concat(e.id):"".concat(e.id)}(t),s="string"===typeof l.label?l.label:Mt(l.label,c),d=t.embeddedFieldData&&{format:null!==(r=null===(i=t.embeddedFieldData)||void 0===i?void 0:i.format)&&void 0!==r?r:u.text,path:t.path},j={id:t.id,library:t.library,label:s,key:o,type:t.type,format:l.format,parentAttributeData:null===t||void 0===t?void 0:t.parentAttributeData,treeData:t.treeData,embeddedData:d,recordLibrary:(null===t||void 0===t||null===(a=t.parentAttributeData)||void 0===a?void 0:a.type)===b.tree?t.path.split(".")[1]:null};return[].concat(Object(ve.a)(e),[j])}),[]);j({type:wi.SET_FIELDS,fields:r}),i()},children:a("table-columns-selection.submit")},"Submit")],children:Object(B.jsx)(qd,{library:d.library.id,selectedAttributes:f,onSelectionChange:p})})},Zd=Ke.a.div(Qd||(Qd=Object(Qe.a)(["\n    border-left: solid 3px transparent;\n    border-right: solid 3px transparent;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    height: 100%;\n\n    ","\n\n    &:hover {\n        border-left: "," 3px solid;\n        border-right: "," 3px solid;\n        box-shadow: 0px 3px 6px #00000029;\n        transition: 200ms ease;\n\n        .wrapper-arrow {\n            background: ",";\n            box-shadow: 0px 3px 6px #00000029;\n            border: 1px solid ",";\n        }\n    }\n"])),(function(e){return e.isHover&&"\n        box-shadow: 0px 3px 6px #00000029;\n\n        .wrapper-arrow {\n            background: ".concat(Je.a["@default-bg"],";\n            box-shadow: 0px 3px 6px #00000029;\n            border: 1px solid ").concat(Je.a["@leav-secondary-divider-color"],";\n        }\n    ")}),Je.a["@primary-color"],Je.a["@primary-color"],Je.a["@default-bg"],Je.a["@leav-secondary-divider-color"]),eu=Ke.a.div(Kd||(Kd=Object(Qe.a)(["\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0.3rem 0.3rem;\n\n    word-break: 'keep-all';\n    user-select: 'none';\n"]))),tu=Ke.a.div(Xd||(Xd=Object(Qe.a)(["\n    border-radius: 50%;\n    cursor: pointer;\n    border: 1px solid transparent;\n    height: 2rem;\n    width: 2rem;\n    display: grid;\n    grid-template-rows: 8px 8px;\n    place-items: center;\n    align-content: center;\n    margin: 0 8px;\n    flex-shrink: 0;\n\n    & > * {\n        transform: scale(0.7);\n    }\n\n    & > span:first-child {\n        opacity: ",";\n    }\n\n    & > span:last-child {\n        opacity: ",";\n    }\n"])),(function(e){var t=e.filterDirection;return e.filterActive&&t===f.asc?1:.5}),(function(e){var t=e.filterDirection;return e.filterActive&&t===f.desc?1:.5}));tu.displayName="WrapperArrow";var nu,ru,iu,au,lu,cu,ou=function(e){var t,n,i,a=e.id,l=e.children,c=e.type,s=Object(F.a)().t,d=Gi(),u=d.state,j=d.dispatch,v=Object(r.useState)(!1),O=Object(o.a)(v,2),p=O[0],h=O[1],m=Object(r.useState)(!1),g=Object(o.a)(m,2),x=g[0],y=g[1];a=It===a?"id":a;var E=function(e,t,n){var r=function(e,t){switch(e=It===e?"id":e,t){case b.tree:case b.simple_link:return"".concat(e,".").concat("id");case b.advanced_link:default:return e}}(e,n);j({type:wi.SET_SORT,sort:{field:r,order:t,active:!0}}),j({type:wi.SET_LOADING,loading:!0})};return Object(B.jsxs)(Zd,{isHover:x,isInfoColumn:It===a,id:a,children:[l,Object(B.jsx)(pn.a,{placement:"bottomCenter",trigger:["click"],overlay:Object(B.jsxs)(dn.a,{style:{transform:"translateY(-8px)"},onMouseEnter:function(){return y(!0)},onMouseLeave:function(){return y(!1)},children:[Object(B.jsx)(dn.a.Item,{onClick:function(){return e=c,void E(a,f.asc,e);var e},children:s("items_list.table.header-cell-menu.sort-ascend")}),Object(B.jsx)(dn.a.Item,{onClick:function(){return e=c,void E(a,f.desc,e);var e},children:s("items_list.table.header-cell-menu.sort-descend")}),Object(B.jsx)(dn.a.Item,{onClick:function(){j({type:wi.CANCEL_SORT})},children:s("items_list.table.header-cell-menu.cancel-sort")}),It!==a&&Object(B.jsx)(dn.a.Item,{onClick:function(){return e=a,void j({type:wi.SET_FIELDS,fields:u.fields.filter((function(t){return t.id!==e}))});var e},children:s("items_list.table.header-cell-menu.hide-column")}),Object(B.jsx)(dn.a.Item,{onClick:function(){return h(!0)},children:s("items_list.table.header-cell-menu.choose-columns")})]}),children:Object(B.jsx)(eu,{children:Object(B.jsxs)(tu,{className:"wrapper-arrow","data-testid":"wrapper-arrow-".concat(u.sort.order),filterDirection:null===(t=u.sort)||void 0===t?void 0:t.order,filterActive:!!(null===(n=u.sort)||void 0===n?void 0:n.active)&&(null===(i=u.sort)||void 0===i?void 0:i.field)===a,style:{fontSize:"130%"},children:[Object(B.jsx)(ud.a,{}),Object(B.jsx)(bd.a,{})]})})}),p&&Object(B.jsx)(Jd,{visible:p,onClose:function(){return h(!1)}})]})},su="350px",du=Ke.a.div(nu||(nu=Object(Qe.a)(["\n    grid-area: data;\n    height: 100%;\n    min-width: 0px;\n    width: 100%;\n    border: 1px solid ",";\n    overflow-y: scroll;\n\n    &.sticky {\n        overflow: scroll;\n\n        .header {\n            position: sticky;\n            top: 0;\n            z-index: 1;\n        }\n\n        .body {\n            position: relative;\n            z-index: 0;\n        }\n\n        [data-sticky-td] {\n            position: sticky;\n        }\n    }\n"])),Je.a["@divider-color"]);du.displayName="CustomTable";var uu,bu,ju,vu,Ou,fu,pu,hu,mu=Ke.a.div(ru||(ru=Object(Qe.a)(["\n    background: ",";\n    width: fit-content;\n    min-width: 100%;\n"])),Je.a["@leav-secondary-action-bg"]),gu=Ke.a.div(iu||(iu=Object(Qe.a)(["\n    margin-left: 3px; // For better alignment with rows\n"]))),xu=Ke.a.div(au||(au=Object(Qe.a)(["\n    background: ",";\n    border-right: 1px solid ",";\n    min-width: 35px;\n    max-width: ",";\n\n    &:last-child {\n        border-right: none;\n    }\n"])),Je.a["@leav-secondary-action-bg"],Je.a["@divider-color"],(function(e){return e.id===wt?"35px":"auto"})),yu=Ke.a.div(lu||(lu=Object(Qe.a)(["\n    width: fit-content;\n    min-width: 100%;\n"]))),Eu=Ke.a.div(cu||(cu=Object(Qe.a)(["\n    align-self: start;\n    grid-area: pagination;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    border-top: 1px solid ",";\n    padding-top: 8px;\n"])),Je.a["@divider-color"]),_u=function(){var e=Object(F.a)().t,t=yt(),n=Object(o.a)(t,1)[0].lang,i=Gi().state,a=Object(r.useState)([]),l=Object(o.a)(a,2),c=l[0],s=l[1],d=Object(r.useState)([]),u=Object(o.a)(d,2),j=u[0],v=u[1],O=Object(r.useState)(!1),f=Object(o.a)(O,2),p=f[0],h=f[1];Object(r.useEffect)((function(){var t=[{Header:"",accessor:wt,key:wt,sticky:"left",width:35,maxWidth:35,minWidth:30},{Header:e("items_list.table.infos"),accessor:It,key:It,sticky:"left"}],n=[];i.attributes.length&&i.fields.length&&(n=i.fields.map((function(e){var t,n,r=e.key.replaceAll(".","");return{Header:Object(B.jsx)(zi.a,{ellipsis:{rows:2,tooltip:e.label},style:{marginBottom:0,textAlign:"center"},children:e.label}),accessor:r,key:e.key,type:e.type,format:(null===(t=e.embeddedData)||void 0===t?void 0:t.format)||e.format,embeddedPath:null===(n=e.embeddedData)||void 0===n?void 0:n.path}})));var r=[].concat(t,Object(ve.a)(n));s((function(e){return Object(Tt.isEqual)(e,r)?e:r}))}),[i.fields,i.attributes,e]),Object(r.useEffect)((function(){var e=i.records.reduce((function(e,t,n){if(n<i.pagination){var r,a=c.reduce((function(e,n){if(!n.type&&n.accessor===It){var r={value:t.whoAmI,type:n.type};return e[n.accessor]=r,e}var i=n.key,a=t.fields[i];if(n.embeddedPath&&n.embeddedPath.length){var l=n.embeddedPath.split(".").slice(1).join(".");try{var c=JSON.parse(t.fields[i]);a=$i()(c,l)}catch(o){a="error"}}return e[n.accessor]={value:a,type:n.type,format:n.format},e}),(r={},Object($e.a)(r,wt,null),Object($e.a)(r,"record",t.whoAmI),r));return[].concat(Object(ve.a)(e),[a])}return e}),[]);e&&v(Object(ve.a)(e))}),[i.records,i.pagination,c,n]);var m=Object(Wi.useTable)({columns:c,data:j},Wi.useFlexLayout,Yi.useSticky),g=m.getTableProps,x=m.getTableBodyProps,y=m.headerGroups,E=m.prepareRow,_=m.rows;return i.loading?Object(B.jsx)(B.Fragment,{children:Object(B.jsx)(V.a,{})}):Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)(du,Object($.a)(Object($.a)({},g()),{},{className:"table sticky","data-testid":"table",onScroll:function(e){var t=e.target.scrollLeft;h(t>0)},scrollHorizontalActive:p,children:[Object(B.jsx)(mu,{className:"header sticky",children:y.map((function(e){return Object(B.jsx)(gu,Object($.a)(Object($.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e){var t=e.getHeaderProps();return e.id===It&&(t.style=Object($.a)(Object($.a)({},t.style),{},{minWidth:su,maxWidth:su})),Object(B.jsx)(xu,Object($.a)(Object($.a)({},t),{},{id:e.id,children:e.key!==wt&&Object(B.jsx)(ou,{id:e.key,type:b.simple,children:e.render("Header")})}))}))}))}))}),Object(B.jsx)(yu,Object($.a)(Object($.a)({},x()),{},{className:"body sticky",children:_.map((function(e){return E(e),Object(B.jsx)(dd,{row:e},e.id)}))}))]})),Object(B.jsx)(Eu,{children:Object(B.jsx)(Ji,{})})]})},Tu=n(795),Su=(uu={},Object($e.a)(uu,x.small,"100px"),Object($e.a)(uu,x.medium,"200px"),Object($e.a)(uu,x.big,"300px"),uu),wu="#333333",Iu="".concat(Je.a["@leav-background-active"],"AA"),ku="".concat(Je.a["@leav-background-active"],"DF"),Ru=Object(Ke.a)(A.a)(bu||(bu=Object(Qe.a)(["\n    && {\n        width: ",";\n        margin: 0.5em;\n        outline: 2px solid transparent;\n\n        & .ant-card-cover {\n            width: ",";\n            height: ",";\n        }\n\n        &:hover {\n            outline-color: ",";\n        }\n    }\n"])),(function(e){return e.$previewSize}),(function(e){return e.$previewSize}),(function(e){return e.$previewSize}),Je.a["@primary-color"]),Au=Ke.a.div(ju||(ju=Object(Qe.a)(["\n    position: relative;\n    border-bottom: 1px solid ",";\n"])),Je.a["@divider-color"]),Cu=Ke.a.div(vu||(vu=Object(Qe.a)(["\n    display: flex;\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n\n    justify-content: center;\n\n    &:hover {\n        .actions {\n            animation: show-actions 300ms ease;\n            opacity: 1;\n            background: ",";\n        }\n    }\n\n    @keyframes show-actions {\n        from {\n            opacity: 0;\n            background: none;\n        }\n        to {\n            opacity: 1;\n            background: ",";\n        }\n    }\n"])),Iu,Iu),Nu=Ke.a.div(Ou||(Ou=Object(Qe.a)(["\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    cursor: pointer;\n\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: ",";\n\n    &:hover {\n        background: ",";\n    }\n"])),(function(e){return e.checked?ku:"none"}),(function(e){return e.checked?ku:Iu})),Lu=Object(Ke.a)(Qn.b)(fu||(fu=Object(Qe.a)(["\n    && {\n        display: none;\n        position: absolute;\n        top: 1em;\n    }\n    ",":hover & {\n        display: inherit;\n    }\n    button {\n        color: ",";\n        border-color: ",";\n    }\n"])),Nu,wu,wu),Vu=Ke.a.div(pu||(pu=Object(Qe.a)(["\n    position: absolute;\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    opacity: 0;\n    width: 100%;\n    height: 100%;\n    grid-gap: 1rem;\n\n    justify-items: center;\n    align-items: center;\n    justify-content: center;\n\n    border-radius: 0.25rem 0.25rem 0 0;\n\n    button {\n        color: ",";\n        border-color: ","66;\n\n        // Arrange buttons, depending on their position on the grid\n        &:nth-child(1) {\n            justify-self: end;\n            align-self: end;\n        }\n        &:nth-child(2) {\n            justify-self: start;\n            align-self: end;\n        }\n        &:nth-child(3) {\n            justify-self: end;\n            align-self: start;\n        }\n        &:nth-child(4) {\n            justify-self: start;\n            align-self: start;\n        }\n    }\n"])),wu,wu),Du=Ke.a.div(hu||(hu=Object(Qe.a)(["\n    font-size: 3em;\n    color: ",";\n"])),Je.a["@primary-color"]);var Fu,Pu,Uu,Bu=function(e){var t,n=e.item,i=Object(F.a)().t,a=gt(),l=Object(o.a)(a,1)[0].permissions.delete_record,c=Gi().state,s=Object(r.useContext)(Ri),d=Object(r.useState)(!1),u=Object(o.a)(d,2),b=u[0],j=u[1],v=Wt(c.display.size),O=Le((function(e){return{selectionState:e.selection}})).selectionState,f=Ve(),p=yt(),h=Object(o.a)(p,1)[0].lang,m=Object(r.useState)(!!O.selection.selected.some((function(e){return e.id===n.whoAmI.id&&e.library===n.whoAmI.library.id}))),g=Object(o.a)(m,2),y=g[0],E=g[1],_=s?O.searchSelection.type===X.search&&O.searchSelection.allSelected:O.selection.type===X.search&&O.selection.allSelected,T=function(){E(!y);var e={id:n.whoAmI.id,library:n.whoAmI.library.id,label:Mt(n.whoAmI.label,h)};f(s?Ae(e):Ie({selectionType:X.search,elementSelected:e}))};Object(r.useEffect)((function(){E(O[s?"searchSelection":"selection"].selected.some((function(e){return e.id===n.whoAmI.id&&e.library===n.whoAmI.library.id})))}),[O.selection,O.searchSelection,n,O,s]);var S=y||_,w=O.selection.selected.length||O.selection.allSelected;return Object(B.jsxs)(B.Fragment,{children:[b&&Object(B.jsx)(Ps,{open:b,record:n.whoAmI,library:n.whoAmI.library.id,onClose:function(){j(!1)}}),Object(B.jsx)(Ru,{$previewSize:Su[v],size:"small",onClick:T,onDoubleClick:function(){return j(!0)},cover:Object(B.jsxs)(Au,{children:[Object(B.jsx)(ka,{label:n.whoAmI.label||n.whoAmI.id,image:(null===(t=n.whoAmI.preview)||void 0===t?void 0:t[v])?Dt(n.whoAmI.preview[v]):"",tile:!0,style:{width:Su[v],height:Su[v]}}),Object(B.jsx)(Cu,{children:S||w?Object(B.jsxs)(Nu,{checked:S,children:[Object(B.jsxs)(Lu,{children:[Object(B.jsx)(Hs,{selectionType:Fs.ONLY,text:i("items-list-row.select-only"),record:n.whoAmI,size:"small"}),Object(B.jsx)(Hs,{selectionType:Fs.ALL,text:i("items-list-row.select-all"),record:n.whoAmI,size:"small"})]}),S&&Object(B.jsx)(Du,{className:"checked-icon",children:Object(B.jsx)(Zs.a,{})})]}):Object(B.jsxs)(Vu,{className:"actions",children:[Object(B.jsx)(fn.a,{title:i("global.select"),children:Object(B.jsx)(D.a,{shape:"circle",icon:Object(B.jsx)(Tu.a,{}),onClick:function(e){e.stopPropagation(),e.preventDefault(),T()}})},"select"),Object(B.jsx)(fn.a,{title:i("global.edit"),children:Object(B.jsx)(zl,{shape:"circle",record:n.whoAmI})},"edit"),l?Object(B.jsx)(fn.a,{title:i("global.delete"),children:Object(B.jsx)(D.a,{shape:"circle",icon:Object(B.jsx)(Al.a,{}),onClick:function(e){e.stopPropagation(),e.preventDefault(),qn.b.warn(i("global.feature_not_available"))}})},"delete"):Object(B.jsx)("div",{})]})})]}),children:Object(B.jsx)(A.a.Meta,{title:Object(B.jsx)(zi.a,{ellipsis:{rows:1,tooltip:!0},style:{marginBottom:0,fontSize:v===x.small?".8em":"1em"},children:n.whoAmI.label||n.whoAmI.id})})})]})},Hu=Ke.a.div(Fu||(Fu=Object(Qe.a)(["\n    height: 30rem;\n    width: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n"]))),zu=Ke.a.div(Pu||(Pu=Object(Qe.a)(["\n    grid-area: data;\n    height: 100%;\n    overflow-y: scroll;\n    border-radius: 0.25rem 0.25rem 0 0;\n    border-bottom: none;\n    display: flex;\n    flex-direction: row;\n    flex-wrap: wrap;\n    justify-content: space-evenly;\n    align-content: flex-start;\n"]))),Gu=Ke.a.div(Uu||(Uu=Object(Qe.a)(["\n    grid-area: pagination;\n    display: flex;\n    justify-content: space-around;\n    border: 1px solid ",";\n    padding: 0.5rem;\n"])),Je.a["@divider-color"]);var Mu=function(){var e=Gi().state;return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(zu,{children:e.loading?Object(B.jsx)(Hu,{children:Object(B.jsx)(V.a,{size:"large"})}):Object(B.jsx)(B.Fragment,{children:e.records.map((function(e){return Object(B.jsx)(Bu,{item:e},e.whoAmI.id)}))})}),Object(B.jsx)(Gu,{children:Object(B.jsx)(Ji,{})})]})};var $u,Wu,Yu=function(){switch(Gi().state.display.type){case h.list:return Object(B.jsx)(_u,{});case h.timeline:return Object(B.jsx)("div",{children:"Not supported yet"});case h.cards:default:return Object(B.jsx)(Mu,{})}},qu=function(e,t,n){var r,i=[],a=Object(Zi.a)(e);try{for(a.s();!(r=a.n()).done;){var l=r.value,c="IS_EMPTY"===l.condition||"IS_NOT_EMPTY"===l.condition;(l.value||c)&&function(){var e=l.field.split("."),r={type:l.condition in S?_.TREE:_.ATTRIBUTE,index:i.length,key:l.field,value:c?null:{value:l.condition===Z.BETWEEN?JSON.parse(l.value):l.value},active:!0,condition:Z[l.condition]||S[l.condition]},a=n.find((function(n){return n.library===t&&n.id===e[0]}));if(a){if(a.type!==b.simple&&a.type!==b.advanced||(r.attribute=a),$t(a.type)){var s=Object(o.a)(e,2)[1];if(s){var d=n.find((function(e){var t;return e.library===(null===a||void 0===a||null===(t=a.linkedLibrary)||void 0===t?void 0:t.id)&&e.id===s}));r.attribute=Object($.a)(Object($.a)({},d),{},{parentAttribute:Object($.a)(Object($.a)({},a),{},{format:Lt})})}else r.attribute=a}if(a.type===b.tree){var u=Object(o.a)(e,3),j=u[1],v=u[2];if(j||v)if(j&&!v){var O,f;r.type=_.LIBRARY,r.parentAttribute=Object($.a)(Object($.a)({},a),{},{format:Lt}),r.library={id:j,label:null!==(O=null===(f=a.linkedTree.libraries.filter((function(e){return e.library.id===j})))||void 0===f?void 0:f[0].library.label)&&void 0!==O?O:null}}else{var p,h,m=n.find((function(e){return e.library===j&&e.id===v}));r.attribute=m,r.parentTreeLibrary=Object($.a)(Object($.a)({},r),{},{type:_.LIBRARY,library:{id:j,label:null!==(p=null===(h=a.linkedTree.libraries.filter((function(e){return e.library.id===j})))||void 0===h?void 0:h[0].library.label)&&void 0!==p?p:null},parentAttribute:Object($.a)(Object($.a)({},a),{},{format:Lt})})}else r.attribute=Object($.a)(Object($.a)({},a),{},{format:Lt})}}else l.condition in S&&(r.tree={id:l.treeId});i=[].concat(Object(ve.a)(i),[r])}()}}catch(s){a.e(s)}finally{a.f()}return i},Qu=function(e){var t=e.filter((function(e){return e.active})).reduce((function(e,t){var n,r=[];if(t.condition===w.THROUGH&&(t.condition=Z.EQUAL),null===t.value)r=[{field:t.condition in Z?t.key:null,condition:v[t.condition],treeId:null===(n=t.tree)||void 0===n?void 0:n.id}];else if("string"===typeof t.value.value&&t.value.value.match(/\n/g)){var i=t.value.value.split("\n").filter(Boolean);r.push({operator:O.OPEN_BRACKET});var a,l=Object(Zi.a)(i);try{for(l.s();!(a=l.n()).done;){var c=a.value;r.push({field:t.condition in Z?t.key:null,value:c,condition:v[t.condition]}),r.push({operator:O.OR})}}catch(d){l.e(d)}finally{l.f()}r.pop(),r.push({operator:O.CLOSE_BRACKET})}else{var o,s;r=[{field:t.condition in Z?t.key:null,value:t.condition===Z.BETWEEN?JSON.stringify(t.value.value):null===t||void 0===t||null===(o=t.value)||void 0===o?void 0:o.value.toString(),condition:v[t.condition],treeId:null===(s=t.tree)||void 0===s?void 0:s.id}]}return e.concat.apply(e,Object(ve.a)(r).concat([{operator:O.AND}]))}),[]);return t.pop(),t},Ku=n(418),Xu=n.n(Ku),Ju=function(e,t){return(e.parentAttributeData.type===b.tree?t.record:t)[e.id]},Zu=function(e){var t=e.items,n=e.fields;return t.map((function(e,t){var r=function(e,t){return e.reduce((function(e,n){var r=n.key;if(n.format===u.extended){var i=r.split("."),a=Object(Ur.a)(i),l=a[0],c=a.slice(1);try{if(!c.length)return e[r]=t[l],e;var o=JSON.parse(t[l]);if(o)return e[r]=Xu.a.get(o,c),e}catch(j){return console.error(j),e[r]="error",e}}switch(n.type){case b.simple_link:case b.advanced_link:if((null===n||void 0===n?void 0:n.parentAttributeData)&&t[n.parentAttributeData.id]){var s=t[n.parentAttributeData.id][n.id];Object(Tt.isArray)(t[n.parentAttributeData.id])&&(s=t[n.parentAttributeData.id].map((function(e){return e.record[n.id]}))),Array.isArray(s)&&(s=s.shift()),e[r]=s}else e[r]=t[n.id];return e;case b.tree:return(null===n||void 0===n?void 0:n.parentAttributeData)&&t[n.parentAttributeData.id]?e[r]=t[n.parentAttributeData.id][n.id]:e[r]=t[n.id],e;case b.simple:case b.advanced:default:if(!(null===n||void 0===n?void 0:n.parentAttributeData))return e[r]=t[n.id],e;if(!t[n.parentAttributeData.id])return e[r]=null,e;if(Object(Tt.isArray)(t[n.parentAttributeData.id]))return e[r]=t[n.parentAttributeData.id].map((function(e){return Ju(n,e)})),e;var d=t[n.parentAttributeData.id];return e[r]=Ju(n,d),e}}),{})}(n,e);return{index:t+1,whoAmI:Object($.a)({},e.whoAmI),fields:r}}))},eb=n(806),tb=n(796),nb=n(797),rb=n(798),ib=function(e){var t=e.type,n=e.style;switch(t){case h.list:return Object(B.jsx)(tb.a,{style:n});case h.cards:return Object(B.jsx)(nb.a,{style:n});case h.timeline:return Object(B.jsx)(rb.a,{style:n})}},ab=Object(Ke.a)(dn.a)($u||($u=Object(Qe.a)(["\n    min-width: 11em;\n"]))),lb=Object(Ke.a)(dn.a.Item)(Wu||(Wu=Object(Qe.a)(["\n    display: flex;\n    justify-content: space-between;\n"])));var cb=function(){var e,t,n=Object(F.a)().t,i=Gi(),a=i.state,l=i.dispatch,c=Object(r.useState)(!1),s=Object(o.a)(c,2),d=s[0],u=s[1],b=(e={},Object($e.a)(e,p.SMALL,n("items_list.display.small")),Object($e.a)(e,p.MEDIUM,n("items_list.display.medium")),Object($e.a)(e,p.BIG,n("items_list.display.big")),e);!function(e){e.LESS="LESS",e.MORE="MORE"}(t||(t={}));var j=function(e){l({type:wi.SET_DISPLAY,display:{type:e,size:a.display.size}})},v=function(e){var n=Object.keys(b).indexOf(a.display.size);n=(n=e===t.LESS?n-1:n+1)<0?0:n>2?2:n,l({type:wi.SET_DISPLAY,display:{type:a.display.type,size:p[Object.keys(b)[n]]}})};return Object(B.jsx)(pn.a,{visible:d,onVisibleChange:function(){return u(!d)},trigger:["click"],placement:"bottomRight",overlay:Object(B.jsxs)(ab,{children:[Object(B.jsxs)(lb,{children:[Object(B.jsx)(D.a,{shape:"circle",disabled:a.display.size===p.SMALL,onClick:function(){return v(t.LESS)},size:"small",children:"-"})," ".concat(b[a.display.size]," "),Object(B.jsx)(D.a,{shape:"circle",disabled:a.display.size===p.BIG,onClick:function(){return v(t.MORE)},size:"small",children:"+"})]}),Object(B.jsx)(dn.a.Divider,{}),Object(B.jsx)(dn.a.Item,{onClick:function(){return j(h.list)},icon:Object(B.jsx)(tb.a,{}),children:n("view.type-list")}),Object(B.jsx)(dn.a.Item,{onClick:function(){return j(h.cards)},icon:Object(B.jsx)(nb.a,{}),children:n("view.type-cards")})]}),children:Object(B.jsxs)(D.a,{children:[Object(B.jsx)(ib,{type:a.display.type}),Object(B.jsx)(wo.a,{})]})})},ob=n(799);var sb=function(){var e=Object(F.a)().t,t=Object(r.useState)(!1),n=Object(o.a)(t,2),i=n[0],a=n[1],l=Object(B.jsxs)(dn.a,{children:[Object(B.jsxs)(dn.a.Item,{disabled:!0,children:[e("items_list.table.header-cell-menu.sort-advance"),Object(B.jsx)(hi,{})]}),Object(B.jsxs)(dn.a.Item,{disabled:!0,children:[e("items_list.table.header-cell-menu.regroup"),Object(B.jsx)(hi,{})]})]});return Object(B.jsx)(B.Fragment,{children:Object(B.jsx)(pn.a,{visible:i,onVisibleChange:function(){return a(!i)},trigger:["click"],overlay:l,children:Object(B.jsx)(D.a,{children:Object(B.jsx)(ob.a,{})})})})};var db,ub=function(){var e=Object(F.a)().t,t=Object(r.useContext)(Ri),n=Gi().state,i=Le((function(e){return{selectionState:e.selection,display:e.display}})).selectionState,a=Ve(),l=yt(),c=Object(o.a)(l,1)[0].lang;return Object(B.jsx)("span",{"data-testid":"dropdown-menu-selection",children:Object(B.jsx)(pn.a,{overlay:Object(B.jsxs)(dn.a,{children:[!t&&Object(B.jsx)(dn.a.Item,{onClick:function(){t||a(Se({type:X.search,selected:[],allSelected:!0}))},children:e("items-menu-dropdown.select-all",{nb:n.totalCount})}),Object(B.jsx)(dn.a.Item,{onClick:function(){var e=Object(ve.a)(i.selection.selected);if(n.records){var r,l=Object(Zi.a)(n.records);try{for(l.s();!(r=l.n()).done;){var o=r.value;e=[].concat(Object(ve.a)(e),[{id:o.whoAmI.id,library:o.whoAmI.library.id,label:Mt(o.whoAmI.label,c)}])}}catch(s){l.e(s)}finally{l.f()}}a(t?ke({type:X.search,selected:e,allSelected:!1}):Se({type:X.search,selected:e,allSelected:!1}))},children:e("items-menu-dropdown.select-visible",{nb:n.records.length})})]}),children:Object(B.jsx)(D.a,{type:"text",icon:Object(B.jsx)(wo.a,{}),children:e("items-list-row.nb-elements",{nbItems:n.totalCount})})})})},bb=n(803),jb=n(804),vb=n(800),Ob=n(805),fb=Object(Ot.a)(db||(db=Object(Qe.a)(["\n    mutation ADD_VIEW($view: ViewInput!) {\n        saveView(view: $view) {\n            id\n        }\n    }\n"]))),pb=n(801),hb=n(802),mb=function(e){var t,n,r,i,a=e.filter,l=e.updateFilterValue,c=(null===a||void 0===a||null===(t=a.value)||void 0===t||null===(n=t.value)||void 0===n?void 0:n.from)&&(null===a||void 0===a||null===(r=a.value)||void 0===r||null===(i=r.value)||void 0===i?void 0:i.to)?a.value.value:null,s=c?[zc()(1e3*Number(c.from)),zc()(1e3*Number(c.to))]:null;return Object(B.jsx)(Mc.a.RangePicker,{popupStyle:{background:Je.a["@default-bg"]},disabled:!a.active,onChange:function(e){if(e){var t=Object(o.a)(e,2),n=t[0],r=t[1];n.utcOffset(0).startOf("day"),r.utcOffset(0).startOf("day"),l(Object($.a)(Object($.a)({},a.value),{},{value:{from:String(n.unix()),to:String(r.unix())}}))}else l(null)},value:s})};function gb(e){var t=e.tree,n=e.selectedNodeKey,i=e.onSubmit,a=e.visible,l=e.onClose,c=Object(F.a)().t,s=Object(r.useState)({id:n,key:n,title:"",children:[]}),d=Object(o.a)(s,2),u=d[0],b=d[1],j=function(){l()};return Object(B.jsx)(jd.a,{visible:a,onCancel:j,title:c("tree-node-selection.title"),width:"70rem",bodyStyle:{maxHeight:"80vh",overflowY:"auto"},centered:!0,footer:[Object(B.jsx)(D.a,{onClick:j,children:c("global.cancel")},"cancel"),Object(B.jsx)(Ze,{onClick:function(){i(u),l()},children:c("global.apply")},"add")],destroyOnClose:!0,children:Object(B.jsx)(Fo,{tree:t,onSelect:function(e,t){b(t?e:void 0)},selectedNode:u.key})})}var xb,yb=function(e){var t,n=e.filter,r=e.updateFilterValue,i=function(e){e?(e.utcOffset(0).startOf("day"),r(Object($.a)(Object($.a)({},n.value),{},{value:e.unix()}))):r(null)},a=(null===n||void 0===n||null===(t=n.value)||void 0===t?void 0:t.value)?zc()(1e3*Number(n.value.value)):null;return Object(B.jsx)(Mc.a,{popupStyle:{background:Je.a["@default-bg"]},disabled:!n.active,onOk:i,onChange:i,value:a})},Eb=function(e){var t=e.filter,n=e.updateFilterValue;return Object(B.jsx)(N.a,{type:"number",disabled:!t.active,value:Number(t.value.value),onChange:function(e){var r,i=Number(null!==(r=e.target.value)&&void 0!==r?r:0);n(Object($.a)(Object($.a)({},t.value),{},{value:i}))}})},_b=Object(Ke.a)(N.a.TextArea)(xb||(xb=Object(Qe.a)(["\n    background: "," 0% 0% no-repeat padding-box;\n    box-shadow: ",";\n    border: ",";\n    border-radius: 3px;\n"])),Je.a["@default-bg"],Je.a["@leav-small-shadow"],Je.a["@leav-border"]),Tb=function(e){var t=e.filter,n=e.updateFilterValue,r=t.value.value?String(t.value.value):null,i=r?r.split("\n").length:1,a=i<=5?i:5;return Object(B.jsx)(_b,{disabled:!t.active,rows:a,value:r,onChange:function(e){var r,i=(null!==(r=e.target.value)&&void 0!==r?r:"").toString();n(Object($.a)(Object($.a)({},t.value),{},{value:i}))},"data-testid":"filter-textarea"})};var Sb,wb=function(e){var t=e.children,n=e.secondary,r=void 0!==n&&n,i=Object(ml.a)(e,["children","secondary"]);return Object(B.jsx)(D.a,Object($.a)(Object($.a)({icon:Object(B.jsx)(wo.a,{}),type:"text",style:{minWidth:"50%",padding:"0 .5em"}},i),{},{children:Object(B.jsx)(Yn.a.Text,{ellipsis:{tooltip:!0},type:r?"secondary":null,style:{width:"calc(100% - 1em)"},children:t})}))},Ib=(Sb={},Object($e.a)(Sb,u.text,[Z.CONTAINS,Z.NOT_CONTAINS,Z.EQUAL,Z.NOT_EQUAL,Z.BEGIN_WITH,Z.END_WITH,Z.IS_EMPTY,Z.IS_NOT_EMPTY]),Object($e.a)(Sb,u.extended,[Z.CONTAINS,Z.NOT_CONTAINS,Z.EQUAL,Z.NOT_EQUAL,Z.BEGIN_WITH,Z.END_WITH,Z.IS_EMPTY,Z.IS_NOT_EMPTY]),Object($e.a)(Sb,u.encrypted,[Z.IS_EMPTY,Z.IS_NOT_EMPTY]),Object($e.a)(Sb,u.numeric,[Z.EQUAL,Z.NOT_EQUAL,Z.GREATER_THAN,Z.LESS_THAN,Z.IS_EMPTY,Z.IS_NOT_EMPTY]),Object($e.a)(Sb,u.boolean,[Z.EQUAL,Z.NOT_EQUAL]),Object($e.a)(Sb,u.date,[Z.EQUAL,Z.NOT_EQUAL,Z.GREATER_THAN,Z.LESS_THAN,Z.IS_EMPTY,Z.IS_NOT_EMPTY,Z.TODAY,Z.TOMORROW,Z.YESTERDAY,Z.LAST_MONTH,Z.NEXT_MONTH,Z.BETWEEN]),Object($e.a)(Sb,u.date_range,[Z.CONTAINS,Z.START_ON,Z.START_AFTER,Z.START_BEFORE,Z.END_ON,Z.END_AFTER,Z.END_BEFORE,Z.IS_EMPTY,Z.IS_NOT_EMPTY]),Sb);var kb=function(e,t,n){return function(e){return[{text:e("filters.contains"),value:Z.CONTAINS},{text:e("filters.not-contains"),value:Z.NOT_CONTAINS},{text:e("filters.equal"),value:Z.EQUAL},{text:e("filters.not-equal"),value:Z.NOT_EQUAL},{text:e("filters.begin-with"),value:Z.BEGIN_WITH},{text:e("filters.end-with"),value:Z.END_WITH},{text:e("filters.greater-than"),textByFormat:Object($e.a)({},u.date,e("filters.before")),value:Z.GREATER_THAN},{text:e("filters.less-than"),textByFormat:Object($e.a)({},u.date,e("filters.after")),value:Z.LESS_THAN},{text:e("filters.today"),value:Z.TODAY},{text:e("filters.tomorrow"),value:Z.TOMORROW},{text:e("filters.yesterday"),value:Z.YESTERDAY},{text:e("filters.last-month"),value:Z.LAST_MONTH},{text:e("filters.next-month"),value:Z.NEXT_MONTH},{text:e("filters.between"),value:Z.BETWEEN},{text:e("filters.start-on"),value:Z.START_ON},{text:e("filters.start-after"),value:Z.START_AFTER},{text:e("filters.start-before"),value:Z.START_BEFORE},{text:e("filters.end-on"),value:Z.END_ON},{text:e("filters.end-after"),value:Z.END_AFTER},{text:e("filters.end-before"),value:Z.END_BEFORE},{text:e("filters.is-empty"),value:Z.IS_EMPTY},{text:e("filters.is-not-empty"),value:Z.IS_NOT_EMPTY},{text:e("filters.values-count-equal"),value:Z.VALUES_COUNT_EQUAL},{text:e("filters.values-count-greater-than"),value:Z.VALUES_COUNT_GREATER_THAN},{text:e("filters.values-count-lower-than"),value:Z.VALUES_COUNT_LOWER_THAN},{text:e("filters.through"),value:Z.THROUGH}]}(n).filter((function(n){if(n.value===Z.THROUGH&&t)return!0;if(e.type===_.LIBRARY&&Ib[u.text].includes(n.value))return!0;if(e.type===_.ATTRIBUTE){var r,i,a=e;if((null===(r=e.attribute)||void 0===r?void 0:r.format)&&(null===(i=Ib[a.attribute.format])||void 0===i?void 0:i.includes(n.value))||a.attribute.isMultiple&&(l=n.value,[Z.VALUES_COUNT_EQUAL,Z.VALUES_COUNT_GREATER_THAN,Z.VALUES_COUNT_LOWER_THAN].includes(l)))return!0}var l;return!1}))},Rb=function(e){var t=e.filter,n=Object(F.a)().t,r=Gi(),i=r.state,a=r.dispatch,l=function(e){return[{text:e("filters.classified-in"),value:S.CLASSIFIED_IN},{text:e("filters.not-classified-in"),value:S.NOT_CLASSIFIED_IN}]}(n),c=Object(B.jsx)(dn.a,{children:l.map((function(e){return Object(B.jsx)(dn.a.Item,{onClick:function(){return function(e){var n=i.filters.map((function(n){return n.index===t.index?Object($.a)(Object($.a)({},t),{},{condition:S[e]}):n}));a({type:wi.SET_FILTERS,filters:n})}(e.value)},children:e.text},e.value)}))});return Object(B.jsx)(pn.a,{disabled:!t.active,overlay:c,trigger:["click"],children:Object(B.jsx)(wb,{"data-testid":"filter-condition-dropdown",children:l.filter((function(e){return e.value===t.condition}))[0].text})})},Ab=function(e){return[Z.IS_EMPTY,Z.IS_NOT_EMPTY,Z.TODAY,Z.TOMORROW,Z.YESTERDAY,Z.LAST_MONTH,Z.NEXT_MONTH].includes(e)};var Cb,Nb,Lb,Vb,Db,Fb,Pb,Ub,Bb,Hb=function(e){var t=e.filter,n=e.updateFilterValue;return Object(B.jsx)(ll.a,{disabled:!t.active,"data-test-id":"filter-input-boolean",checked:!!t.value.value,onChange:function(e){n(Object($.a)(Object($.a)({},t.value),{},{value:e}))}})},zb=Ke.a.span(Cb||(Cb=Object(Qe.a)(["\n    padding: 0 1rem;\n    height: 100%;\n    display: grid;\n    place-items: center;\n"]))),Gb=function(e){var t,n,i,a,l=e.filter,c=e.updateFilterValue,o=Object(F.a)().t,s=Gi(),d=s.state,j=s.dispatch,v=((null===(t=l.attribute)||void 0===t?void 0:t.format)===u.extended||l.type===_.LIBRARY||$t(null===(n=l.attribute)||void 0===n?void 0:n.type)||(null===(i=l.attribute)||void 0===i?void 0:i.type)===b.tree)&&"undefined"===typeof(null===(a=l.attribute)||void 0===a?void 0:a.parentAttribute)&&"undefined"===typeof l.parentTreeLibrary&&l.condition!==Z.THROUGH,O=kb(l,v,o),f=!Nt.find((function(e){return l.type===_.LIBRARY&&e===u.text||l.type===_.ATTRIBUTE&&e===l.attribute.format})),p=Object(B.jsx)(dn.a,{children:O.filter((function(e){return e.value!==Z.THROUGH||v})).map((function(e){var t,n,i;return Object(B.jsxs)(r.Fragment,{children:[e.value===Z.THROUGH&&Object(B.jsx)(dn.a.Divider,{}),Object(B.jsx)(dn.a.Item,{onClick:function(){return function(e){var t=d.filters.map((function(t){if(t.index===l.index){var n,r=Object($.a)({},l.value);return Ab(e)?r=null:(null===r||"object"===typeof(null===(n=r)||void 0===n?void 0:n.value)&&e!==Z.BETWEEN)&&(r.value=Jb(l.attribute.format)),Object($.a)(Object($.a)({},l),{},{value:r,condition:Z[e]})}return t}));j({type:wi.SET_FILTERS,filters:t})}(e.value)},children:null!==(t=null===(n=e.textByFormat)||void 0===n?void 0:n[null===l||void 0===l||null===(i=l.attribute)||void 0===i?void 0:i.format])&&void 0!==t?t:null===e||void 0===e?void 0:e.text})]},e.value)}))});if(f){var h,m,g,x=O.filter((function(e){return e.value===l.condition}))[0];return Object(B.jsx)(pn.a,{disabled:!l.active||l.condition===Z.THROUGH,overlay:p,trigger:["click"],children:Object(B.jsx)(wb,{"aria-label":"filter-condition",children:null!==(h=null===x||void 0===x||null===(m=x.textByFormat)||void 0===m?void 0:m[null===l||void 0===l||null===(g=l.attribute)||void 0===g?void 0:g.format])&&void 0!==h?h:null===x||void 0===x?void 0:x.text})})}switch(l.attribute.format){case u.boolean:return Object(B.jsx)(zb,{children:Object(B.jsx)(Hb,{filter:l,updateFilterValue:c})});default:return Object(B.jsx)(B.Fragment,{})}},Mb=Ke.a.div(Nb||(Nb=Object(Qe.a)(["\n    background: ",";\n    padding: 8px 8px 8px 0px;\n    border-radius: 3px;\n    display: grid;\n    grid-template-columns: 1.375rem 1fr;\n    margin-bottom: 8px;\n    border: 2px solid transparent;\n\n    ","\n"])),Je.a["@leav-secondary-item-background"],(function(e){return e.active?"\n        :hover,\n        :active {\n            border: 2px solid ".concat(Je.a["@primary-color"],";\n\n            &&& .filter-handle {\n                color: ").concat(Je.a["@primary-color"],";\n            }\n        }\n    "):"opacity: .5;"})),$b=Ke.a.div(Lb||(Lb=Object(Qe.a)(["\n    content: '....';\n    width: 20px;\n    height: 30px;\n    display: inline-block;\n    overflow: hidden;\n    line-height: 5px;\n    padding: 3px 4px;\n    vertical-align: middle;\n    margin: auto;\n    font-size: 12px;\n    font-family: sans-serif;\n    letter-spacing: 2px;\n    color: ",";\n    text-shadow: 1px 0 1px black;\n\n    &::after {\n        content: '.. .. .. ..';\n    }\n"])),Je.a["@divider-color"]),Wb=Ke.a.div(Vb||(Vb=Object(Qe.a)(["\n    display: grid;\n    grid-template-rows: ",";\n    row-gap: 8px;\n"])),(function(e){return e.hasParent?"auto auto 1fr":"auto 1fr"})),Yb=Ke.a.div(Db||(Db=Object(Qe.a)(["\n    display: grid;\n    grid-template-columns: 1fr 1.5rem;\n    align-items: center;\n    column-gap: 8px;\n    min-width: 0;\n"]))),qb=Ke.a.div(Fb||(Fb=Object(Qe.a)(["\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    justify-items: space-around;\n    align-items: center;\n    justify-content: center;\n\n    background: "," 0% 0% no-repeat padding-box;\n    box-shadow: ",";\n    border: ",";\n    border-radius: 3px;\n\n    min-width: 0;\n"])),Je.a["@default-bg"],Je.a["@leav-small-shadow"],Je.a["@leav-border"]),Qb=Ke.a.div(Pb||(Pb=Object(Qe.a)(["\n    display: grid;\n    place-items: center;\n    height: 32px;\n\n    background: "," 0% 0% no-repeat padding-box;\n    box-shadow: ",";\n    border: ",";\n    border-radius: 3px;\n"])),Je.a["@default-bg"],Je.a["@leav-small-shadow"],Je.a["@leav-border"]),Kb=Ke.a.div(Ub||(Ub=Object(Qe.a)(["\n    display: flex;\n    align-content: flex-start;\n"]))),Xb=Object(Ke.a)(D.a)(Bb||(Bb=Object(Qe.a)(["\n    && {\n        border: none;\n        color: ",";\n\n        :hover {\n            border: none;\n            color: ",";\n        }\n    }\n"])),Je.a["@leav-secondary-font-color"],Je.a["@leav-secondary-font-color"]),Jb=function(e){switch(e){case u.boolean:return!0;case u.date:return zc()().utcOffset(0).startOf("day").unix();case u.numeric:return 0;default:return""}};var Zb,ej=function(e){var t,n=e.filter,i=e.handleProps,a=Object(F.a)().t,l=yt(),c=Object(o.a)(l,1)[0].lang,s=Gi(),d=s.state,j=s.dispatch,O=Object(r.useState)(!1),f=Object(o.a)(O,2),p=f[0],h=f[1],m=gt(),g=Object(o.a)(m,1)[0],x=function(e){var t=d.filters.map((function(t){return t.index===n.index?Object($.a)(Object($.a)({},t),{},{value:e}):t}));j({type:wi.SET_FILTERS,filters:t})},y=Object(B.jsxs)(dn.a,{children:[Object(B.jsx)(dn.a.Item,{onClick:function(){var e=d.filters.map((function(e){return e.index===n.index?Object($.a)(Object($.a)({},e),{},{active:!e.active}):e}));j({type:wi.SET_FILTERS,filters:e})},children:n.active?a("filters.deactivate"):a("filters.activate")}),Object(B.jsx)(dn.a.Item,{onClick:function(){j({type:wi.SET_FILTERS,filters:d.filters.filter((function(e){return e.index!==n.index}))})},children:a("global.delete")})]}),E=Object(r.useCallback)((function(e){var t,n=e.filter.condition in Z&&!(e.filter.condition in S)&&!Nt.find((function(t){var n;return t===(null===(n=e.filter.attribute)||void 0===n?void 0:n.format)})),r=e.filter.condition in S;if(n){if(Ab(e.filter.condition))return Object(B.jsx)(B.Fragment,{});switch(null===(t=e.filter.attribute)||void 0===t?void 0:t.format){case u.date:return e.filter.condition===Z.BETWEEN?Object(B.jsx)(mb,Object($.a)({},e)):Object(B.jsx)(yb,Object($.a)({},e));case u.date_range:return Object(B.jsx)(yb,Object($.a)({},e));case u.numeric:return Object(B.jsx)(Eb,Object($.a)({},e));case u.text:default:return Object(B.jsx)(Tb,Object($.a)({},e))}}else if(r)return Object(B.jsx)(D.a,{disabled:!e.filter.active,onClick:function(){return h(!0)},children:e.filter.value.label||a("global.select")});return Object(B.jsx)(B.Fragment,{})}),[a]),T=function(e){return e?e.map((function(e){return Object($.a)(Object($.a)({},e),{},{type:b.simple,multiple_values:void 0,linked_tree:void 0})})):[]},I=!(n.condition!==w.THROUGH&&!(null===(t=n.attribute)||void 0===t?void 0:t.parentAttribute)&&!n.parentTreeLibrary&&n.type!==_.LIBRARY);return Object(B.jsxs)(B.Fragment,{children:[p&&Object(B.jsx)(gb,{selectedNodeKey:n.value.value||n.tree.id,tree:n.tree,onSubmit:function(e){return x(function(e){return"undefined"===typeof e||e.id===n.tree.id?{value:null}:{value:e.id,label:String(e.title)}}(e))},onClose:function(){return h(!1)},visible:p}),Object(B.jsxs)(Mb,{"data-testid":"filter",active:n.active,children:[Object(B.jsx)($b,Object($.a)({className:"filter-handle"},i)),Object(B.jsxs)(Wb,{hasParent:I,children:[I&&Object(B.jsxs)(Kb,{children:[Object(B.jsxs)("span",{children:[a("filters.through"),":\xa0"]}),Object(B.jsx)("span",{children:function(){var e,t,r,i,a,l,o,s;return Mt(n.condition===w.THROUGH?null===(e=n.attribute)||void 0===e?void 0:e.label:(null===(t=n.attribute)||void 0===t||null===(r=t.parentAttribute)||void 0===r?void 0:r.label)||(null===(i=n.parentAttribute)||void 0===i?void 0:i.label),c)||"".concat(Mt(n.condition===w.THROUGH?null===(a=n.parentAttribute)||void 0===a?void 0:a.label:null===(l=n.parentTreeLibrary)||void 0===l||null===(o=l.parentAttribute)||void 0===o?void 0:o.label,c)," > ").concat(Mt(n.condition===w.THROUGH?null===n||void 0===n?void 0:n.library.label:null===(s=n.parentTreeLibrary)||void 0===s?void 0:s.library.label,c)," ")}()}),Object(B.jsx)(Xb,{disabled:!n.active,size:"small",onClick:function(){var e,t=Object(ve.a)(d.filters),r=n.type===_.ATTRIBUTE&&"undefined"!==typeof n.parentTreeLibrary?n.parentTreeLibrary.parentAttribute:n.type===_.ATTRIBUTE?null!==(e=n.attribute.parentAttribute)&&void 0!==e?e:n.attribute:n.parentAttribute,i={type:_.ATTRIBUTE,index:n.index,key:null===r||void 0===r?void 0:r.id,value:{value:Jb(r.format)},active:!0,condition:v[Xt(r.format)],attribute:r},a=d.filters.findIndex((function(e){return e.index===n.index}));t.splice(a,1,i),j({type:wi.SET_FILTERS,filters:t})},shape:"circle",icon:Object(B.jsx)(We.a,{})})]}),Object(B.jsxs)(Yb,{children:[Object(B.jsxs)(qb,{children:[Object(B.jsx)(nj,{libraryId:g.id,button:Object(B.jsx)(wb,{secondary:n.condition===w.THROUGH,children:function(){return n.condition===w.THROUGH?"".concat(a("global.select"),"..."):n.type===_.ATTRIBUTE?Mt(null===(e=n.attribute)||void 0===e?void 0:e.label,c)||(null===(t=n.attribute)||void 0===t?void 0:t.id):n.type===_.TREE?Mt(n.tree.label,c)||n.tree.id:Mt(n.library.label,c)||n.library.id;var e,t}()}),filter:n,attributes:function(){if(n.type===_.ATTRIBUTE){var e,t,r,i,a;if(n.condition===w.THROUGH&&(null===(e=n.attribute)||void 0===e?void 0:e.format)===u.extended)return T(n.attribute.embedded_fields);if(n.condition===w.THROUGH&&"undefined"===typeof n.attribute.linkedTree)return null===(t=n.attribute.linkedLibrary)||void 0===t?void 0:t.attributes;if("undefined"!==typeof n.attribute.parentAttribute)return(null===(r=n.attribute.parentAttribute)||void 0===r||null===(i=r.linkedLibrary)||void 0===i?void 0:i.attributes)||T(null===(a=n.attribute.parentAttribute)||void 0===a?void 0:a.embedded_fields);if("undefined"!==typeof n.parentTreeLibrary)return n.parentTreeLibrary.parentAttribute.linkedTree.libraries.find((function(e){return e.library.id===n.parentTreeLibrary.library.id})).library.attributes;if("undefined"!==typeof n.attribute.linkedTree&&n.condition===w.THROUGH)return[]}if(n.type===_.LIBRARY){if(n.condition!==w.THROUGH)return[];var l;if(n.condition===w.THROUGH)return(null===(l=n.parentAttribute.linkedTree)||void 0===l?void 0:l.libraries.find((function(e){return e.library.id===n.library.id}))).library.attributes}return g.attributes}(),libraries:function(){var e,t;return n.type===_.LIBRARY?null===(e=n.parentAttribute.linkedTree)||void 0===e?void 0:e.libraries:n.type===_.ATTRIBUTE&&"undefined"!==typeof n.attribute.linkedTree&&n.condition===w.THROUGH?null===(t=n.attribute.linkedTree)||void 0===t?void 0:t.libraries:[]}(),trees:n.type===_.TREE||n.condition!==w.THROUGH&&n.type===_.ATTRIBUTE&&!n.parentTreeLibrary&&!n.attribute.parentAttribute?g.trees:[]}),(n.type===_.ATTRIBUTE||n.type===_.LIBRARY)&&Object(B.jsx)(Gb,{filter:n,updateFilterValue:x}),n.type===_.TREE&&Object(B.jsx)(Rb,{filter:n})]}),Object(B.jsx)(pn.a,{overlay:y,placement:"bottomRight",children:Object(B.jsx)(Qb,{children:Object(B.jsx)(vb.a,{})})})]}),Object(B.jsx)(E,{filter:n,updateFilterValue:x})]})]})]})},tj=Object(Ke.a)(dn.a.ItemGroup)(Zb||(Zb=Object(Qe.a)(["\n    max-height: 75vh;\n    overflow-y: auto;\n\n    .ant-dropdown-menu-item-group-title {\n        display: none;\n    }\n"])));var nj=function(e){var t=e.libraryId,n=e.button,i=e.attributes,a=e.libraries,l=e.trees,c=e.filter,s=Object(F.a)().t,d=Gi(),u=d.state,j=d.dispatch,v=yt(),O=Object(o.a)(v,1)[0].lang,f=Object(r.useState)(!1),p=Object(o.a)(f,2),h=p[0],m=p[1],g=Object(r.useState)(),x=Object(o.a)(g,2),y=x[0],E=x[1],T=Ve(),I=function(e){var t=Object(ve.a)(u.filters);if("undefined"!==typeof c){var n=u.filters.findIndex((function(e){return e.index===c.index}));t.splice(n,1,Object($.a)(Object($.a)({},e),{},{index:c.index}))}else t.push(e);j({type:wi.SET_FILTERS,filters:t}),T(ce({visible:!0,type:K.filters}))},k=function(e){return Object($.a)(Object($.a)({},e),{},{localizedLabel:Mt(e.label,O)||e.id})},R=function(e){var t=new RegExp("".concat(y),"i");return!y||!!e.id.match(t)||!!e.localizedLabel.match(t)},A=l.map(k).filter(R),C=i.map(k).filter(R),L=a.map((function(e){return Object($.a)(Object($.a)({},e),{},{library:k(e.library)})})).filter((function(e){return R(e.library)})),V=function(e){return u.filters.some((function(t){var n,r,i,a,l;return(null===t||void 0===t?void 0:t.key)===e||(null===(n=t.attribute)||void 0===n||null===(r=n.parentAttribute)||void 0===r?void 0:r.id)===e||(null===(i=t.parentAttribute)||void 0===i?void 0:i.id)===e||(null===(a=t.parentTreeLibrary)||void 0===a||null===(l=a.parentAttribute)||void 0===l?void 0:l.id)===e}))},D=Object(B.jsxs)(dn.a,{children:[Object(B.jsx)(dn.a.Item,{children:Object(B.jsx)(N.a.Search,{placeholder:s("global.search"),onChange:function(e){E(e.target.value)}})}),Object(B.jsx)(dn.a.Divider,{}),Object(B.jsxs)(tj,{children:[A.length&&Object(B.jsx)(dn.a.ItemGroup,{title:s("filters.trees-group"),children:A.map((function(e){return Object(B.jsx)(dn.a.Item,{icon:Object(B.jsx)(pb.a,{}),onClick:function(){return I(function(e){return{type:_.TREE,index:Date.now(),active:!0,key:e.id,condition:S[S.CLASSIFIED_IN],tree:e,value:{value:null}}}(e))},children:V(e.id)?Object(B.jsx)(Hr.a,{color:"blue",text:e.localizedLabel}):e.localizedLabel},e.id)}))}),C.length&&Object(B.jsx)(dn.a.ItemGroup,{title:s("filters.attributes-group"),children:C.map((function(e){return Object(B.jsx)(dn.a.Item,{icon:Object(B.jsx)(hb.a,{}),onClick:function(){return I(function(e){var n,r,i,a=e.id;if("undefined"!==typeof(null===c||void 0===c?void 0:c.parentTreeLibrary))a="".concat(null===c||void 0===c?void 0:c.parentTreeLibrary.key,".").concat(e.id);else if((null===c||void 0===c?void 0:c.condition)===w.THROUGH&&c.type===_.LIBRARY)a="".concat(c.key,".").concat(e.id);else if((null===c||void 0===c?void 0:c.condition)===w.THROUGH){var l;a="".concat(null===c||void 0===c||null===(l=c.attribute)||void 0===l?void 0:l.id,".").concat(e.id)}else if(null===c||void 0===c||null===(n=c.attribute)||void 0===n?void 0:n.parentAttribute){var o;a="".concat(null===c||void 0===c||null===(o=c.attribute)||void 0===o?void 0:o.parentAttribute.id,".").concat(e.id)}var s={type:_.ATTRIBUTE,index:Date.now(),active:!0,key:a,condition:Z[Xt(e.format)],attribute:{id:e.id,type:e.type,format:$t(e.type)||e.type===b.tree?Lt:e.format,label:e.label,isLink:$t(e.type),isMultiple:e.multiple_values,linkedLibrary:e.linked_library,linkedTree:e.linked_tree,library:(null===(r=e.linked_library)||void 0===r?void 0:r.id)||t,embedded_fields:e.embedded_fields},value:{value:Jb(e.format)}};if((null===c||void 0===c?void 0:c.condition)===w.THROUGH)s.attribute.parentAttribute=null===c||void 0===c?void 0:c.attribute;else if(null===c||void 0===c||null===(i=c.attribute)||void 0===i?void 0:i.parentAttribute){var d;s.attribute.parentAttribute=null===c||void 0===c||null===(d=c.attribute)||void 0===d?void 0:d.parentAttribute}return(null===c||void 0===c?void 0:c.type)===_.LIBRARY?s.parentTreeLibrary=c:"undefined"!==typeof(null===c||void 0===c?void 0:c.parentTreeLibrary)&&(s.parentTreeLibrary=null===c||void 0===c?void 0:c.parentTreeLibrary),s}(e))},children:V(e.id)?Object(B.jsx)(Hr.a,{color:"blue",text:e.localizedLabel}):e.localizedLabel},e.id)}))}),L.length&&Object(B.jsx)(dn.a.ItemGroup,{title:s("filters.libraries-group"),children:L.map((function(e){return Object(B.jsx)(dn.a.Item,{icon:Object(B.jsx)(rn.a,{}),onClick:function(){return I(function(e){var t,n,r,i=(null===c||void 0===c?void 0:c.type)!==_.LIBRARY?"".concat(null===(t=c.attribute)||void 0===t?void 0:t.id,".").concat(e.id):"".concat(null===(n=c.parentAttribute)||void 0===n?void 0:n.id,".").concat(e.id);return{type:_.LIBRARY,index:Date.now(),active:!0,key:i,condition:Z[Xt(Lt)],library:{id:e.id,label:e.label},value:{value:Jb(Lt)},parentAttribute:(null===c||void 0===c?void 0:c.condition)===w.THROUGH&&null!==(r=c.attribute)&&void 0!==r?r:c.parentAttribute}}(e.library))},children:e.library.localizedLabel},e.library.id)}))})]})]});return Object(B.jsx)(pn.a,{disabled:!!c&&!c.active,visible:h,onVisibleChange:function(){return m(!h)},overlay:D,trigger:["click"],children:n})};var rj=function(e){var t,n,r,i,a=e.activeLibrary,l=Object(F.a)().t,c=yt(),s=Object(o.a)(c,1)[0],d=s.lang,u=s.defaultLang,b=Ve(),j=Le((function(e){return e})).display,v=Gi(),O=v.state,f=v.dispatch,m=Object(sn.a)(fb),g=Object(o.a)(m,1)[0],x=function(){var e=Object(it.a)(rt.a.mark((function e(){var t;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O.view.current.id===Ct.id){e.next=12;break}return e.prev=1,t=[],O.view.current.display.type===h.list&&(t=O.fields.map((function(e){return e.key}))),e.next=6,g({variables:{view:Object($.a)(Object($.a)({},St.a.omit(O.view.current,"owner")),{},{library:a.id,sort:O.sort.active?{field:O.sort.field,order:O.sort.order}:void 0,display:O.display,filters:Qu(O.filters),settings:[{name:At,value:t}]})}});case 6:f({type:wi.SET_VIEW,view:{current:Object($.a)(Object($.a)({},O.view.current),{},{sort:O.sort.active?{field:O.sort.field,order:O.sort.order}:void 0,display:O.display,filters:O.filters,settings:[{name:At,value:t}]}),reload:!0,sync:!1}}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=Object(it.a)(rt.a.mark((function e(t){var n,r;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object($.a)(Object($.a)({},St.a.omit(Ct,["id","owner"])),{},{label:Object($e.a)({},u,l("view.add-view.title")),library:a.id,display:{type:t,size:p.MEDIUM},filters:[]}),e.next=3,g({variables:{view:n}});case 3:r=e.sent,f({type:wi.SET_VIEW,view:{current:Object($.a)(Object($.a)({},n),{},{owner:!0,id:r.data.saveView.id,filters:[]}),reload:!0,sync:!1}}),f({type:wi.SET_USER_VIEWS_ORDER,userViewsOrder:[].concat(Object(ve.a)(O.userViewsOrder),[r.data.saveView.id])});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=Object(B.jsx)(dn.a,{children:Object(B.jsxs)(dn.a.ItemGroup,{title:l("view.add-view.title"),children:[Object(B.jsx)(dn.a.Item,{onClick:function(){return y(h.list)},icon:Object(B.jsx)(tb.a,{}),children:l("view.type-list")}),Object(B.jsx)(dn.a.Item,{onClick:function(){return y(h.cards)},icon:Object(B.jsx)(nb.a,{}),children:l("view.type-cards")})]})});return Object(B.jsxs)(Qn.b,{size:"large",children:[Object(B.jsxs)(D.a.Group,{children:[Object(B.jsx)(fn.a,{title:Mt(null===(t=O.view.current)||void 0===t?void 0:t.label,d)||l("select-view.default-view"),children:Object(B.jsx)(D.a,{icon:Object(B.jsx)(ib,{style:{marginRight:"8px"},type:O.view.current.display.type}),"data-testid":"dropdown-view-options",onClick:function(){var e=!j.side.visible||j.side.type!==K.view;b(ce({visible:e,type:K.view}))},color:null===(n=O.view.current)||void 0===n?void 0:n.color,style:{width:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:Object(B.jsx)(B.Fragment,{children:Mt(null===(r=O.view.current)||void 0===r?void 0:r.label,d)||l("select-view.default-view")})})}),Object(B.jsx)(D.a,{disabled:O.view.sync,icon:Object(B.jsx)(bb.a,{}),onClick:function(){f({type:wi.SET_VIEW,view:{current:O.view.current,reload:!0,sync:!1}})}}),Object(B.jsx)(D.a,{icon:Object(B.jsx)(jb.a,{}),onClick:x,disabled:O.view.sync||(null===(i=O.view.current)||void 0===i?void 0:i.id)===Ct.id||!O.view.current.owner}),Object(B.jsx)(pn.a,{overlay:E,trigger:["click"],children:Object(B.jsx)(D.a,{icon:Object(B.jsx)(vb.a,{})})})]}),Object(B.jsx)(Hr.a,{dot:!!O.filters.length,children:Object(B.jsxs)(D.a.Group,{children:[Object(B.jsx)(D.a,{onClick:function(){b(ce({visible:!j.side.visible||j.side.type!==K.filters,type:K.filters}))},icon:Object(B.jsx)(Ob.a,{}),children:l("filters.filters")}),Object(B.jsx)(nj,{libraryId:a.id,button:Object(B.jsx)(D.a,{icon:Object(B.jsx)(gl.a,{}),type:"default"}),attributes:a.attributes,trees:a.trees,libraries:[]})]})})]})};var ij,aj=function(){var e=Gi(),t=e.state,n=e.dispatch,r=Object(F.a)().t,i=function(e){n({type:wi.SET_QUERY_FILTERS,queryFilters:Qu(t.filters)}),n({type:wi.SET_LOADING,loading:!0})};return Object(B.jsx)(N.a.Search,{style:{maxWidth:500,minWidth:250},placeholder:r("search.placeholder"),value:t.fullText,onChange:function(e){n({type:wi.SET_FULLTEXT,fullText:e.target.value})},onPressEnter:i,onSearch:i,loading:t.loading,allowClear:!0})},lj=Ke.a.div(ij||(ij=Object(Qe.a)(["\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    width: 100%;\n"])));var cj,oj,sj,dj,uj=function(e){var t=e.refetch,n=Object(F.a)().t,i=gt(),a=Object(o.a)(i,1)[0],l=Object(r.useState)(!1),c=Object(o.a)(l,2),s=c[0],d=c[1],u=a.permissions.create_record,b=Object(r.useContext)(Ri);return Object(B.jsxs)(lj,{children:[(null===a||void 0===a?void 0:a.id)&&Object(B.jsx)(rj,{activeLibrary:a}),Object(B.jsxs)(Qn.b,{size:"large",children:[Object(B.jsx)(ub,{}),Object(B.jsx)(aj,{})]}),Object(B.jsxs)(Qn.b,{size:"large",children:[!b&&u&&Object(B.jsx)(Ze,{icon:Object(B.jsx)(gl.a,{}),className:"primary-btn",onClick:function(){d(!0)},children:n("items_list.new")}),Object(B.jsxs)(Qn.b,{size:"small",children:[Object(B.jsx)(sb,{}),Object(B.jsx)(cb,{}),Object(B.jsx)(D.a,{icon:Object(B.jsx)(eb.a,{}),onClick:function(){return t&&t()}})]})]}),s&&Object(B.jsx)(Ps,{record:null,library:a.id,open:s,onClose:function(){d(!1)}})]})},bj=n(809),jj=n(419),vj=n.n(jj),Oj=n(808),fj=n(807),pj=Object(tr.a)(cj||(cj=Object(Qe.a)(["\n    query EXPORT($library: ID!, $attributes: [ID!], $filters: [RecordFilterInput!]) {\n        export(library: $library, attributes: $attributes, filters: $filters)\n    }\n"]))),hj=$n.a.Step;!function(e){e[e.ATTRIBUTE_SELECTION=0]="ATTRIBUTE_SELECTION",e[e.PROCESSING=1]="PROCESSING",e[e.DONE=2]="DONE"}(dj||(dj={}));var mj=Ke.a.div(oj||(oj=Object(Qe.a)(["\n    margin-top: 2em;\n"]))),gj=Ke.a.div(sj||(sj=Object(Qe.a)(["\n    text-align: center;\n"])));var xj=function(e){var t=e.onClose,n=e.open,i=Object(F.a)().t,a=Le((function(e){return{selectionState:e.selection}})).selectionState,l=Gi().state,c=Ve(),s=gt(),d=Object(o.a)(s,1)[0],u=Object(r.useState)([]),j=Object(o.a)(u,2),f=j[0],p=j[1],h=Object(r.useState)(dj.ATTRIBUTE_SELECTION),m=Object(o.a)(h,2),g=m[0],x=m[1],y=Object(r.useState)(""),E=Object(o.a)(y,2),_=E[0],T=E[1],S=Object(ki.a)(pj,{fetchPolicy:"no-cache",onCompleted:function(e){x(dj.DONE),T(e.export)},onError:function(e){var t={type:Y.error,priority:q.high,channel:Q.passive,content:"".concat(i("error.error_occurred"),": ").concat(e.message)};c(ge(t)),x(dj.DONE)}}),w=Object(o.a)(S,2),I=w[0],k=w[1].error,R=i(g===dj.DONE?"global.close":"export.start");return Object(B.jsxs)(Zn.a,{title:i("export.title"),okText:R,cancelText:i("global.cancel"),onOk:function(){g!==dj.DONE?function(){var e;if(x(dj.PROCESSING),a.selection.type===X.search&&a.selection.allSelected)e=l.queryFilters;else{var t=a.selection.selected.map((function(e){return e.id}));e=t.length?[{operator:O.OPEN_BRACKET}].concat(Object(ve.a)(t.reduce((function(e,n,r){return e.push({field:"id",condition:v.EQUAL,value:n}),r<t.length-1&&e.push({operator:O.OR}),e}),[])),[{operator:O.CLOSE_BRACKET}]):[]}var n=f.length?f.map((function(e){var t;return(null===e||void 0===e||null===(t=e.parentAttributeData)||void 0===t?void 0:t.type)===b.tree?"".concat(null===e||void 0===e?void 0:e.parentAttributeData.id,".").concat(e.id):e.path})):["id"];I({variables:{library:(null===d||void 0===d?void 0:d.id)||"",attributes:n,filters:e}})}():t()},onCancel:t,visible:n,closable:!0,width:"90vw",centered:!0,confirmLoading:g===dj.PROCESSING,bodyStyle:{height:"calc(100vh - 10rem)"},okButtonProps:{className:"submit-btn"},destroyOnClose:!0,children:[Object(B.jsxs)($n.a,{current:g,style:{marginBottom:"2em"},children:[Object(B.jsx)(hj,{title:i("export.attributes_selection")}),Object(B.jsx)(hj,{title:i("export.export_generation"),icon:g===dj.PROCESSING?Object(B.jsx)(zn.a,{}):null}),Object(B.jsx)(hj,{title:i("export.export_done"),status:k?"error":void 0})]}),Object(B.jsxs)(mj,{children:[g===dj.ATTRIBUTE_SELECTION&&Object(B.jsx)(qd,{library:d.id,multiple:!0,onSelectionChange:p,selectedAttributes:f,canExpandExtendedAttributes:!1}),g===dj.PROCESSING&&Object(B.jsx)(gj,{"data-test-id":"processing",children:i("global.processing")+"..."}),g===dj.DONE&&Object(B.jsx)(gj,{"data-test-id":"done",children:k?Object(B.jsx)(tt,{message:k.message}):Object(B.jsx)(qe.a,{status:"success",title:i("export.export_done"),extra:[Object(B.jsx)(D.a,{type:"primary",icon:Object(B.jsx)(fj.a,{}),href:Dt(_),children:i("export.download_file")},"download-file")]})})]})]})};var yj,Ej,_j,Tj,Sj=function(){var e=Object(F.a)().t,t=Object(r.useState)(),n=Object(o.a)(t,2),i=n[0],a=n[1],l=[{key:"export",icon:Object(B.jsx)(Oj.a,{rotate:270}),title:e("export.title"),modalComp:xj}],c=function(){return a("")};return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(pn.a,{overlay:Object(B.jsx)(dn.a,{children:l.map((function(e){return Object(B.jsx)(dn.a.Item,{icon:e.icon,title:e.title,onClick:(t=e.key,function(){a(t)}),children:e.title},e.key);var t}))}),children:Object(B.jsxs)(D.a,{children:[e("menu-selection.actions")," ",Object(B.jsx)(wo.a,{})]})}),l.filter((function(e){return i===e.key})).map((function(e){return Object(B.jsx)(e.modalComp,{open:i===e.key,onClose:c},e.key)}))]})},wj=Ke.a.div(yj||(yj=Object(Qe.a)(["\n    display: ",";\n    place-items: center;\n\n    position: absolute;\n    top: 0;\n\n    width: 100%;\n    background: ",";\n    height: 4rem;\n    z-index: 11;\n\n    animation: ",";\n\n    & > div {\n        display: grid;\n        place-items: center;\n        grid-template-columns: repeat(4, auto);\n        column-gap: 1rem;\n    }\n\n    @keyframes moveToBottom {\n        from {\n            top: -100px;\n        }\n        to {\n            top: 0;\n        }\n    }\n"])),(function(e){return e.active?"grid":"none"}),Je.a["@default-bg"],(function(e){return e.active?"moveToBottom .3s ease":"none"})),Ij=Ke.a.div(Ej||(Ej=Object(Qe.a)(["\n    && {\n        display: flex;\n        padding: 0;\n    }\n"]))),kj=Object(Ke.a)(D.a)(_j||(_j=Object(Qe.a)(["\n    && {\n        padding: 0 1em;\n        display: flex;\n        align-items: center;\n        border-right-color: transparent;\n        border-top-right-radius: 0;\n        border-bottom-right-radius: 0;\n    }\n"]))),Rj=Object(Ke.a)(D.a)(Tj||(Tj=Object(Qe.a)(["\n    && {\n        border-top-left-radius: 0;\n        border-bottom-left-radius: 0;\n        display: flex;\n        padding: 0 1em;\n        align-items: center;\n    }\n"])));var Aj,Cj,Nj,Lj,Vj=function(e){var t=e.active,n=Object(F.a)().t,i=Object(r.useContext)(Ri),a=Le((function(e){return{selectionState:e.selection,display:e.display}})).selectionState,l=Ve(),c=Gi().state,s=yt(),d=Object(o.a)(s,1)[0].lang,u=Object(r.useState)(0),b=Object(o.a)(u,2),j=b[0],v=b[1];Object(r.useEffect)((function(){v(i?a.searchSelection.selected.length:a.selection.selected.length)}),[a.selection,a.searchSelection,i,v]);var O=i?a.searchSelection.type===X.search&&a.searchSelection.allSelected:a.selection.type===X.search&&a.selection.allSelected;return Object(B.jsx)(wj,{active:t,children:Object(B.jsxs)("div",{children:[Object(B.jsx)(pn.a,{overlay:Object(B.jsxs)(dn.a,{children:[Object(B.jsx)(dn.a.Item,{onClick:function(){var e=Object(ve.a)(a.selection.selected);if(c.records){var t,n=Object(Zi.a)(c.records);try{for(n.s();!(t=n.n()).done;){var r=t.value;e=[].concat(Object(ve.a)(e),[{id:r.whoAmI.id,library:r.whoAmI.library.id,label:Mt(r.whoAmI.label,d)}])}}catch(o){n.e(o)}finally{n.f()}}e=vj()(e,(function(e){return"".concat(e.id,"_").concat(e.library)})),l(i?ke({type:X.search,selected:e,allSelected:!1}):Se({type:X.search,selected:e,allSelected:!1}))},children:n("items-menu-dropdown.select-visible",{nb:c.records.length})}),!i&&Object(B.jsx)(dn.a.Item,{onClick:function(){i||l(Se({type:X.search,selected:[],allSelected:!0}))},children:n("items-menu-dropdown.select-all",{nb:c.totalCount})}),Object(B.jsx)(dn.a.Item,{onClick:function(){l(i?Re():we())},children:n("menu-selection.unselect-all")})]}),children:Object(B.jsxs)(Ij,{children:[Object(B.jsxs)(kj,{children:[n("menu-selection.nb-selected",{nbSelected:O?c.totalCount:j,total:c.totalCount}),Object(B.jsx)(wo.a,{style:{paddingLeft:12}})]}),Object(B.jsx)(Rj,{onClick:function(){l(i?Re():we())},children:Object(B.jsx)(bj.a,{})})]})}),!i&&Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(Sj,{}),Object(B.jsx)("div",{children:Object(B.jsx)(D.a,{icon:Object(B.jsx)(Al.a,{}),onClick:function(){qn.b.warn(n("global.feature_not_available"))},children:n("global.delete")})})]})]})})},Dj=(n(716),Ke.a.div(Aj||(Aj=Object(Qe.a)(["\n    width: 100%;\n    display: flex;\n    flex-flow: column nowrap;\n    border-right: "," 1px solid;\n    overflow-y: auto;\n    width: 1000px;\n"])),Je.a["@divider-color"])),Fj=Ke.a.div(Cj||(Cj=Object(Qe.a)(["\n    width: 100%;\n    background-color: ",";\n    display: grid;\n    grid-template-columns: repeat(2, auto);\n    justify-content: space-between;\n    padding: 0.3rem 0.3rem 0.3rem 1rem;\n    font-weight: 700;\n    border-bottom: 1px solid ",";\n\n    & > * {\n        :first-of-type {\n            display: grid;\n            column-gap: 8px;\n            grid-template-columns: repeat(3, auto);\n            align-items: center;\n            justify-items: center;\n        }\n\n        :last-of-type {\n            display: flex;\n            align-items: center;\n            justify-content: flex-end;\n            column-gap: 8px;\n            grid-template-columns: repeat(2, auto);\n        }\n    }\n"])),Je.a["@leav-view-panel-background-title"],Je.a["@divider-color"]),Pj=Ke.a.div(Nj||(Nj=Object(Qe.a)(["\n    height: calc(100% - 7rem);\n    overflow: auto;\n"]))),Uj=Ke.a.div(Lj||(Lj=Object(Qe.a)(["\n    display: grid;\n"])));var Bj,Hj=function(){var e=Object(F.a)().t,t=Gi(),n=t.state,r=t.dispatch,i=Ve(),a=n.filters.sort((function(e,t){return e.index-t.index})),l=n.filters.every((function(e){return!1===e.active}));return Object(B.jsxs)(Dj,{children:[Object(B.jsxs)(Fj,{children:[Object(B.jsx)(pn.a,{overlay:Object(B.jsxs)(dn.a,{children:[Object(B.jsx)(dn.a.Item,{disabled:l,onClick:function(){r({type:wi.SET_FILTERS,filters:n.filters.map((function(e){return Object($.a)(Object($.a)({},e),{},{active:!1})}))})},children:e("filters.disable-filters")}),Object(B.jsx)(dn.a.Item,{disabled:!n.filters.length,onClick:function(){r({type:wi.SET_FILTERS,filters:[]}),r({type:wi.SET_QUERY_FILTERS,queryFilters:[]})},children:e("filters.remove-filters")}),Object(B.jsxs)(dn.a.Item,{disabled:!0,children:[e("filters.add-condition")," ",Object(B.jsx)(hi,{})]})]}),children:Object(B.jsxs)(D.a,{type:"text",children:[e("filters.filters"),Object(B.jsx)(wo.a,{style:{marginTop:"5px",marginLeft:"-3px"}})]})}),Object(B.jsxs)("div",{children:[Object(B.jsx)(D.a,{disabled:!n.filters.length,onClick:function(){r({type:wi.SET_QUERY_FILTERS,queryFilters:Qu(n.filters)}),r({type:wi.SET_LOADING,loading:!0})},children:e("filters.apply")}),Object(B.jsx)(D.a,{onClick:function(){i(ce({visible:!1,type:K.filters}))},icon:Object(B.jsx)(na,{})})]})]}),Object(B.jsx)(Pj,{children:Object(B.jsx)(Vd.a,{onDragEnd:function(e,t){if(e.destination){var i=n.filters.map((function(t){return Object($.a)(Object($.a)({},t),{},{index:e.source.index===t.index?e.destination.index:e.destination.index===t.index?e.source.index:t.index})})).sort((function(e,t){return e.index-t.index}));r({type:wi.SET_FILTERS,filters:i})}},children:Object(B.jsx)(Vd.c,{droppableId:"droppable",children:function(e){return Object(B.jsxs)(Uj,Object($.a)(Object($.a)({},e.droppableProps),{},{ref:e.innerRef,children:[a.map((function(e){return Object(B.jsx)(Vd.b,{draggableId:e.index.toString(),index:e.index,children:function(t){return Object(B.jsx)("div",Object($.a)(Object($.a)({ref:t.innerRef},t.draggableProps),{},{children:Object(B.jsx)(ej,{filter:e,handleProps:t.dragHandleProps},e.index)}))}},e.index)})),e.placeholder]}))}})})})]})},zj=Object(Ot.a)(Bj||(Bj=Object(Qe.a)(["\n    query GET_VIEWS_LIST($libraryId: String!) {\n        views(library: $libraryId) {\n            totalCount\n            list {\n                id\n                display {\n                    size\n                    type\n                }\n                shared\n                created_by {\n                    id\n                    whoAmI {\n                        id\n                        label\n                        library {\n                            id\n                            gqlNames {\n                                query\n                                type\n                            }\n                        }\n                    }\n                }\n                label\n                description\n                color\n                filters {\n                    field\n                    value\n                    tree {\n                        id\n                        label\n                    }\n                    condition\n                    operator\n                }\n                sort {\n                    field\n                    order\n                }\n                settings {\n                    name\n                    value\n                }\n            }\n        }\n    }\n"])));var Gj,Mj,$j,Wj,Yj,qj,Qj,Kj=function(e){var t=e.visible,n=e.onClose,i=e.view,a=Object(F.a)().t,l=Gi(),c=l.state,s=l.dispatch,d=gt(),u=Object(o.a)(d,1)[0],b=yt(),j=Object(o.a)(b,1)[0],v=j.availableLangs,O=j.defaultLang,f=C.a.useForm(),p=Object(o.a)(f,1)[0],m=Object(r.useState)(!1),g=Object(o.a)(m,2),x=g[0],y=g[1],E=Object(sn.a)(fb),_=Object(o.a)(E,1)[0],T=function(){var e=Object(it.a)(rt.a.mark((function e(){return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p.submit();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(it.a)(rt.a.mark((function e(t){var r;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y(!0),r={id:i.id,library:u.id,display:{type:t.type,size:i.display.size},shared:t.shared,label:t.label,description:Object.values(t.description).every((function(e){return""===e}))?null:t.description,settings:i.settings,filters:Qu(i.filters),sort:i.sort},e.prev=2,e.next=5,_({variables:{view:r}});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.error(e.t0);case 10:i.shared!==t.shared&&(s({type:wi.SET_USER_VIEWS_ORDER,userViewsOrder:t.shared?c.userViewsOrder.filter((function(e){return e!==i.id})):[].concat(Object(ve.a)(c.userViewsOrder),[i.id])}),s({type:wi.SET_SHARED_VIEWS_ORDER,sharedViewsOrder:t.shared?[].concat(Object(ve.a)(c.sharedViewsOrder),[i.id]):c.sharedViewsOrder.filter((function(e){return e!==i.id}))})),s({type:wi.SET_VIEW,view:{current:i.id===c.view.current.id?Object($.a)(Object($.a)({},c.view.current),{},{label:t.label,description:Object.values(t.description).every((function(e){return""===e}))?null:t.description,display:{type:t.type,size:i.display.size},shared:t.shared}):c.view.current,reload:!0,sync:!1}}),y(!1),n();case 14:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsx)(jd.a,{forceRender:!0,title:a("view.edit-view.title"),visible:t,onCancel:function(){p.resetFields(),n()},onOk:T,confirmLoading:x,children:Object(B.jsxs)(C.a,{labelCol:{span:8},wrapperCol:{span:16},form:p,onFinish:S,children:[v.map((function(e){return Object(B.jsxs)("div",{children:[Object(B.jsx)("h2",{children:a("language.".concat(e))}),Object(B.jsx)(C.a.Item,{label:a("view.edit-view.label"),name:["label",e],initialValue:i.label[e],rules:O===e?[{required:!0}]:[],"data-testid":"viewName-input-".concat(e),children:Object(B.jsx)(N.a,{})}),Object(B.jsx)(C.a.Item,{label:a("view.edit-view.description"),initialValue:i.description&&i.description[e]||"",name:["description",e],"data-testid":"description-input-".concat(e),children:Object(B.jsx)(N.a,{})}),Object(B.jsx)(Qa.a,{})]},e)})),Object(B.jsx)(C.a.Item,{label:a("view.edit-view.type"),name:"type","data-testid":"input-type",initialValue:i.display.type,children:Object(B.jsxs)(Kn.a,{children:[Object(B.jsx)(Kn.a.Option,{value:h.list,children:a("view.type-list")}),Object(B.jsx)(Kn.a.Option,{value:h.cards,children:a("view.type-cards")})]})}),Object(B.jsx)(C.a.Item,{name:"shared",initialValue:i.shared,valuePropName:"checked","data-testid":"input-shared",wrapperCol:{offset:8,span:16},children:Object(B.jsx)(Xn.a,{children:a("view.edit-view.shared")})})]})})},Xj=n(810),Jj=Object(Ot.a)(Gj||(Gj=Object(Qe.a)(["\n    mutation DELETE_VIEW($viewId: String!) {\n        deleteView(viewId: $viewId) {\n            id\n        }\n    }\n"]))),Zj=ib,ev=Ke.a.div(Mj||(Mj=Object(Qe.a)(["\n    width: 100%;\n"]))),tv=Ke.a.div($j||($j=Object(Qe.a)(["\n    background: ",";\n    padding: 0.5rem;\n    display: flex;\n    align-items: center;\n"])),(function(e){return e.selected?"".concat(Je.a["@leav-background-active"]," "):"none"})),nv=Ke.a.div(Wj||(Wj=Object(Qe.a)(["\n    content: '....';\n    width: 20px;\n    height: 30px;\n    display: inline-block;\n    line-height: 5px;\n    padding: 3px 4px;\n    vertical-align: middle;\n    font-size: 12px;\n    font-family: sans-serif;\n    letter-spacing: 2px;\n    color: ",";\n    text-shadow: 1px 0 1px black;\n\n    &::after {\n        content: '.. .. .. ..';\n    }\n"])),Je.a["@divider-color"]),rv=Ke.a.div(Yj||(Yj=Object(Qe.a)(["\n    display: flex;\n    align-items: center;\n    margin-left: 10px;\n"]))),iv=Ke.a.div(qj||(qj=Object(Qe.a)(["\n    opacity: 0.8;\n    margin-left: 10px;\n    overflow: hidden;\n"]))),av=Object(Ke.a)(D.a)(Qj||(Qj=Object(Qe.a)(["\n    background-color: ",";\n    transform: scale(0.8);\n    &:hover {\n        background-color: ",";\n    }\n"])),Je.a["@default-bg"],Je.a["@default-bg"]);var lv,cv,ov,sv,dv,uv,bv=function(e){var t,n=e.view,i=e.onEdit,a=e.handleProps,l=Object(F.a)().t,c=yt(),s=Object(o.a)(c,1)[0],d=s.lang,u=s.defaultLang,b=gt(),j=Object(o.a)(b,1)[0],v=Gi(),O=v.state,f=v.dispatch,p=Object(r.useState)({expand:!1,key:0}),h=Object(o.a)(p,2),m=h[0],g=h[1],x=Object(sn.a)(fb),y=Object(o.a)(x,1)[0],E=Object(sn.a)(Jj),_=Object(o.a)(E,1)[0],T=function(){var e=Object(it.a)(rt.a.mark((function e(t){return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.domEvent.stopPropagation(),e.next=3,_({variables:{viewId:n.id}});case 3:f({type:wi.SET_VIEW,view:{current:n.id===O.view.current.id?Ct:O.view.current,reload:!0,sync:!1}}),f(n.shared?{type:wi.SET_SHARED_VIEWS_ORDER,sharedViewsOrder:O.sharedViewsOrder.filter((function(e){return e!==n.id}))}:{type:wi.SET_USER_VIEWS_ORDER,userViewsOrder:O.userViewsOrder.filter((function(e){return e!==n.id}))});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(it.a)(rt.a.mark((function e(t){var r;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.domEvent.stopPropagation(),e.prev=1,e.next=4,y({variables:{view:Object($.a)(Object($.a)({},St.a.omit(n,"owner")),{},{label:Object($e.a)({},u,"".concat(Mt(n.label,d)," (").concat(l("global.copy"),")")),filters:Qu(n.filters),id:void 0,library:j.id,shared:!1})}});case 4:r=e.sent,f({type:wi.SET_VIEW,view:{current:O.view.current,reload:!0,sync:!1}}),f({type:wi.SET_USER_VIEWS_ORDER,userViewsOrder:[].concat(Object(ve.a)(O.userViewsOrder),[r.data.saveView.id])}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),w=n.id===(null===(t=O.view.current)||void 0===t?void 0:t.id),I=Mt(n.label,d);return Object(B.jsxs)(tv,{selected:w,onClick:function(){f({type:wi.SET_VIEW,view:{current:n,reload:!0,sync:!1}})},color:n.color,children:[Object(B.jsx)(nv,Object($.a)({className:"view-handle"},a)),Object(B.jsxs)(ev,{children:[Object(B.jsxs)(rv,{"data-testid":"view-title",children:[Object(B.jsx)(Zj,{type:n.display.type}),Object(B.jsx)(Yn.a.Text,{ellipsis:{tooltip:!0},style:{padding:"0 .5em",width:"calc(100% - 1em)"},children:I})]}),n.description&&Object(B.jsxs)(iv,{children:[Object(B.jsx)(Yn.a.Paragraph,{ellipsis:{rows:3,expandable:!0,onExpand:function(){g({expand:!0,key:m.key})},symbol:l("view.see-more")},style:{marginBottom:0},children:Mt(n.description,d)},m.key),m.expand&&Object(B.jsx)("a",{href:"!#",onClick:function(e){e.preventDefault(),g({expand:!1,key:m.key+1})},children:l("global.close")})]})]}),Object(B.jsx)(pn.a,{overlay:Object(B.jsxs)(dn.a,{children:[Object(B.jsx)(dn.a.Item,{disabled:!n.owner,onClick:function(e){e.domEvent.stopPropagation(),i(n.id)},children:l("global.edit")}),Object(B.jsx)(dn.a.Item,{onClick:S,children:l("global.duplicate")}),Object(B.jsx)(dn.a.Item,{disabled:!n.owner,onClick:T,children:l("view.delete")})]}),children:Object(B.jsx)(av,{onClick:function(e){return e.stopPropagation()},icon:Object(B.jsx)(Xj.a,{})})})]},n.id)},jv=Ke.a.div(lv||(lv=Object(Qe.a)(["\n    width: 100%;\n    display: flex;\n    flex-flow: column nowrap;\n    border-right: "," 1px solid;\n    overflow-y: auto;\n"])),Je.a["@divider-color"]),vv=Ke.a.div(cv||(cv=Object(Qe.a)(["\n    width: 100%;\n    background-color: ",";\n    display: grid;\n    grid-template-columns: repeat(2, auto);\n    justify-content: space-between;\n    padding: 0.3rem 0.3rem 0.3rem 1rem;\n    font-weight: 700;\n    border-bottom: 1px solid ",";\n\n    & > * {\n        :first-of-type {\n            display: grid;\n            column-gap: 8px;\n            grid-template-columns: repeat(3, auto);\n            align-items: center;\n            justify-items: center;\n        }\n\n        :last-of-type {\n            display: grid;\n            align-items: center;\n            justify-content: flex-end;\n            column-gap: 8px;\n            grid-template-columns: repeat(2, auto);\n        }\n    }\n"])),Je.a["@leav-view-panel-background-title"],Je.a["@divider-color"]),Ov=Ke.a.div(ov||(ov=Object(Qe.a)(["\n    width: 100%;\n    border-top: "," 1px solid;\n    border-bottom: "," 1px solid;\n    padding: 0.3rem;\n    padding-left: 1rem;\n    font-weight: 700;\n    font-size: 14px;\n"])),Je.a["@item-active-bg"],Je.a["@item-active-bg"]),fv=Ke.a.div(sv||(sv=Object(Qe.a)(["\n    width: 100%;\n"]))),pv=Ke.a.div(dv||(dv=Object(Qe.a)(["\n    margin: 1rem;\n"]))),hv=Object(Ke.a)(Hr.a)(uv||(uv=Object(Qe.a)(["\n    margin-left: 8px;\n    && > * {\n        background-color: ",";\n        color: ",";\n    }\n"])),Je.a["@divider-color"],Je.a["@default-text-color"]),mv=function(e){return function(t,n){var r=e.indexOf(t.id),i=e.indexOf(n.id),a=-1!==r,l=-1!==i;return a&&l?r-i:a&&!l?-1:!a&&l?1:Number(t.id)-Number(n.id)}};var gv,xv=function(){var e,t=Object(F.a)().t,n=_t(),i=Object(o.a)(n,1)[0],a=yt(),l=Object(o.a)(a,1)[0].lang,c=Object(r.useState)(""),s=Object(o.a)(c,2),d=s[0],u=s[1],b=Gi(),j=b.state,v=b.dispatch,O=Object(r.useState)(!1),f=Object(o.a)(O,2),p=f[0],h=f[1],m=Ve(),g="user_views_order_"+j.library.id,x="shared_views_order_"+j.library.id,y=Object(vt.a)(zj,{variables:{libraryId:j.library.id||""}}),E=y.data,_=y.loading,T=y.error,S=y.refetch,w=Object(vt.a)(Rn,{variables:{keys:[g,x]},onCompleted:function(e){var t,n;v({type:wi.SET_USER_VIEWS_ORDER,userViewsOrder:(null===(t=e.userData)||void 0===t?void 0:t.data[g])||[]}),v({type:wi.SET_SHARED_VIEWS_ORDER,sharedViewsOrder:(null===(n=e.userData)||void 0===n?void 0:n.data[x])||[]})}}),I=Object(sn.a)(kn),k=Object(o.a)(I,1)[0];if(Object(r.useEffect)((function(){j.view.reload&&S()}),[j.view,S,v]),_)return Object(B.jsx)("div",{children:Object(B.jsx)(V.a,{})});var R=null!==(e=null===E||void 0===E?void 0:E.views.list.reduce((function(e,t){var n,r=t.filters.map((function(e){var t;return Object($.a)(Object($.a)({},e),{},{treeId:null===(t=e.tree)||void 0===t?void 0:t.id})})),a=Object($.a)(Object($.a)({},St.a.omit(t,["created_by","__typename"])),{},{owner:t.created_by.id===(null===i||void 0===i?void 0:i.userId),filters:Array.isArray(r)?qu(r,j.library.id,j.attributes):[],sort:St.a.omit(t.sort,["__typename"]),display:St.a.omit(t.display,["__typename"]),settings:null===(n=t.settings)||void 0===n?void 0:n.map((function(e){return St.a.omit(e,"__typename")}))});return d&&!Mt(a.label,l).toUpperCase().includes(d.toUpperCase())?e:a.shared?Object($.a)(Object($.a)({},e),{},{sharedViews:[].concat(Object(ve.a)(e.sharedViews),[a])}):Object($.a)(Object($.a)({},e),{},{userViews:[].concat(Object(ve.a)(e.userViews),[a])})}),{sharedViews:[],userViews:[]}))&&void 0!==e?e:{sharedViews:[],userViews:[]},A=R.sharedViews,C=R.userViews;if(T||w.error)return Object(B.jsx)(tt,{message:(T||w.error).message});if(!A||!C)return Object(B.jsx)(tt,{message:t("error.error_occurred")});var L=function(e){h(e)},P=function(){var e=Object(it.a)(rt.a.mark((function e(t,n){var r,i,a,l;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.destination){e.next=2;break}return e.abrupt("return");case 2:r="user"===t.source.droppableId,i=(r?U:H).map((function(e){return e.id})),a=i[t.source.index],i.splice(t.source.index,1),i.splice(t.destination.index,0,a),v(r?{type:wi.SET_USER_VIEWS_ORDER,userViewsOrder:i}:{type:wi.SET_SHARED_VIEWS_ORDER,sharedViewsOrder:i}),k({variables:{key:l=r?g:x,value:i,global:!1},update:function(e,t){var n={query:Rn,variables:{keys:[g,x]}},r=e.readQuery(n);e.writeQuery(Object($.a)(Object($.a)({},n),{},{data:{userData:{global:r.userData.global,data:Object($.a)(Object($.a)({},r.userData.data),{},Object($e.a)({},l,t.data.saveUserData))}}}))}});case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),U=C.sort(mv(j.userViewsOrder)),H=A.sort(mv(j.sharedViewsOrder));return Object(B.jsxs)(jv,{children:[p&&Object(B.jsx)(Kj,{view:p,visible:!!p,onClose:function(){h(!1)}}),Object(B.jsxs)(vv,{children:[Object(B.jsx)("span",{children:t("view.views")}),Object(B.jsx)(D.a,{onClick:function(){m(ce({visible:!1,type:K.view}))},icon:Object(B.jsx)(na,{})})]}),Object(B.jsx)(pv,{children:Object(B.jsx)(N.a.Search,{placeholder:t("view.search"),onSearch:function(e){u(e)}})}),Object(B.jsx)(Ov,{children:t("view.shared-views")}),Object(B.jsx)(Vd.a,{onDragEnd:P,children:Object(B.jsx)(Vd.c,{droppableId:"shared",children:function(e){return Object(B.jsxs)(fv,Object($.a)(Object($.a)({},e.droppableProps),{},{ref:e.innerRef,children:[H.map((function(e,t){return Object(B.jsx)(Vd.b,{draggableId:t.toString(),index:t,children:function(t){return Object(B.jsx)("div",Object($.a)(Object($.a)(Object($.a)({ref:t.innerRef},t.draggableProps),t.dragHandleProps),{},{children:Object(B.jsx)(bv,{view:e,onEdit:function(){return L(e)},handleProps:t.dragHandleProps},e.id)}))}},t)})),e.placeholder]}))}})}),Object(B.jsxs)(Ov,{children:[t("view.my-views"),Object(B.jsx)(hv,{count:C.length})]}),Object(B.jsx)(Vd.a,{onDragEnd:P,children:Object(B.jsx)(Vd.c,{droppableId:"user",children:function(e){return Object(B.jsxs)(fv,Object($.a)(Object($.a)({},e.droppableProps),{},{ref:e.innerRef,children:[U.map((function(e,t){return Object(B.jsx)(Vd.b,{draggableId:t.toString(),index:t,children:function(t){return Object(B.jsx)("div",Object($.a)(Object($.a)(Object($.a)({ref:t.innerRef},t.draggableProps),t.dragHandleProps),{},{children:Object(B.jsx)(bv,{view:e,onEdit:function(){return L(e)},handleProps:t.dragHandleProps},e.id)}))}},t)})),e.placeholder]}))}})})]})},yv=Ke.a.div(gv||(gv=Object(Qe.a)(["\n    grid-area: side;\n    display: ",";\n    position: relative;\n    height: calc(100vh - 7rem);\n    overflow: hidden;\n"])),(function(e){return e.visible?"flex":"none"}));var Ev,_v,Tv=function(){var e=Le((function(e){return e.display.side})),t=e.visible,n=e.type;return Object(B.jsxs)(yv,{visible:t,className:t?"wrapped-filter-open":"wrapped-filter-close",children:[t&&n===K.filters&&Object(B.jsx)(Hj,{}),t&&n===K.view&&Object(B.jsx)(xv,{})]})},Sv=Ke.a.div(Ev||(Ev=Object(Qe.a)(["\n    display: grid;\n\n    ","\n\n    height: calc(100vh - 7rem);\n    position: relative;\n    overflow: auto;\n"])),(function(e){return e.showSide?"\n            grid-template-columns: ".concat(kt," calc(100% - ").concat(kt,");\n            grid-template-rows: 92% auto;\n            grid-template-areas:\n                'side data'\n                'side pagination';"):"\n            grid-template-columns: auto;\n            grid-template-rows: 92% auto;\n            grid-template-areas:\n                'data'\n                'pagination';"})),wv=Ke.a.div(_v||(_v=Object(Qe.a)(["\n    border-bottom: 1px solid rgb(235, 237, 240);\n    padding: 0 1rem;\n    height: 4rem;\n\n    display: flex;\n    align-content: center;\n    justify-content: space-around;\n"])));var Iv=function(e){var t,n=e.selectionMode,i=e.library,a=yt(),l=Object(o.a)(a,1)[0].lang,c=_t(),s=Object(o.a)(c,1)[0],d=Le((function(e){return e})),j=d.display,v=d.selection,O=Object(r.useReducer)(Vi,Object($.a)(Object($.a)({},Li),{},{library:i})),f=Object(o.a)(O,2),p=f[0],h=f[1],m=Object(sn.a)(kn),g=Object(o.a)(m,1)[0],x="selected_view_"+i.id,y=i.permissions.access_library,E=i.attributes.reduce((function(e,t){if((null===t.format||t.format&&Object.values(u).includes(t.format))&&t.type&&Object.values(b).includes(t.type)){var n=[{id:t.id,type:t.type,format:t.format,label:t.label,isLink:$t(t.type),isMultiple:t.multiple_values,linkedLibrary:t.linked_library,linkedTree:t.linked_tree,library:i.id,embedded_fields:t.embedded_fields}];if((t.type===b.simple_link||t.type===b.advanced_link)&&t.linked_library){var r=t.linked_library.id,a=t.linked_library.attributes.map((function(e){return{id:e.id,type:e.type,format:e.format,label:e.label,isLink:$t(e.type),isMultiple:e.multiple_values,linkedLibrary:t.linked_library,linkedTree:t.linked_tree,library:r}}));n.push.apply(n,Object(ve.a)(a))}if(t.type===b.tree&&t.linked_tree){var l=t.linked_tree.libraries.map((function(e){var t=e.library.id;return e.library.attributes.map((function(e){return{id:e.id,type:e.type,format:e.format,label:e.label,isLink:$t(e.type),isMultiple:e.multiple_values,library:t}}))})).flat();n.push.apply(n,Object(ve.a)(l))}return[].concat(Object(ve.a)(e),n)}return e}),[]),_=i.defaultView?{id:i.defaultView.id,owner:!0,library:i.id,label:i.defaultView.label,description:i.defaultView.description,display:i.defaultView.display,color:i.defaultView.color,shared:i.defaultView.shared,filters:qu(null!==(t=i.defaultView.filters)&&void 0!==t?t:[],i.id,E),sort:i.defaultView.sort,settings:i.defaultView.settings}:Object($.a)(Object($.a)({},Ct),{},{label:Ct.label});Object(vt.a)(Rn,{fetchPolicy:"no-cache",variables:{keys:[x]},skip:!y,onCompleted:function(e){var t,n=(null===(t=e.userData)||void 0===t?void 0:t.data[x])||_.id;h({type:wi.SET_ATTRIBUTES,attributes:E}),n===_.id?h({type:wi.SET_VIEW,view:{current:_,reload:!0,sync:!1}}):S({variables:{viewId:n}})}});var T=Object(ki.a)(Bi,{onCompleted:function(e){var t,n=e.view.filters.map((function(e){var t;return Object($.a)(Object($.a)({},e),{},{treeId:null===(t=e.tree)||void 0===t?void 0:t.id})})),r=Object($.a)(Object($.a)({},St.a.omit(e.view,["created_by","__typename"])),{},{owner:e.view.created_by.id===(null===s||void 0===s?void 0:s.userId),filters:Array.isArray(e.view.filters)?qu(n,p.library.id,p.attributes):[],sort:St.a.omit(e.view.sort,["__typename"]),display:St.a.omit(e.view.display,["__typename"]),settings:null===(t=e.view.settings)||void 0===t?void 0:t.map((function(e){return St.a.omit(e,"__typename")}))});h({type:wi.SET_VIEW,view:{current:r,reload:!0,sync:!1}})},onError:function(){return h({type:wi.SET_VIEW,view:{current:_,reload:!0,sync:!1}})}}),S=Object(o.a)(T,1)[0],w=Object(ki.a)(Ui(i.gqlNames.query,p.fields),{fetchPolicy:"network-only",onCompleted:function(e){var t,n=e?e[i.gqlNames.query||""].list:[],r=Zu({items:n,fields:p.fields});h({type:wi.SET_TOTAL_COUNT,totalCount:null===(t=e[i.gqlNames.query])||void 0===t?void 0:t.totalCount}),h({type:wi.SET_RECORDS,records:r}),h({type:wi.SET_LOADING,loading:!1})}}),I=Object(o.a)(w,2),k=I[0],R=I[1],A=R.error,C=R.refetch;if(Object(r.useEffect)((function(){var e,t,n,r;if(p.view.reload&&y){var a=function(e){var t,n=e.split("."),r=function(e,t,n){var r=e.split("."),i=n.find((function(e){return e.library===t&&e.id===r[0]}));if(i){if(i.type===b.simple||i.type===b.advanced)return i;if($t(i.type)){if(r[1]){var a=n.find((function(e){var t;return e.library===(null===i||void 0===i||null===(t=i.linkedLibrary)||void 0===t?void 0:t.id)&&e.id===r[1]}));return Object($.a)(Object($.a)({},a),{},{parentAttribute:Object($.a)(Object($.a)({},i),{},{format:Lt})})}return i}if(i.type===b.tree){var l=Object(o.a)(r,3),c=l[1],s=l[2];return c||s?c&&!s?i:n.find((function(e){return e.library===r[1]&&e.id===r[2]})):Object($.a)(Object($.a)({},i),{},{format:Lt})}}}(e,i.id,p.attributes),a=null;if(3===n.length){var c=n[0],s=p.attributes.find((function(e){return c===e.id&&i.id===e.library}));s&&(t={id:s.id,type:s.type},a=n[1])}if(!r)return null;var d="string"===typeof r.label?r.label:Mt(r.label,l);return{key:e,id:r.id,library:r.library,label:d,format:r.format,type:r.type,parentAttributeData:t,recordLibrary:a}},c=(null===(e=p.view.current.settings)||void 0===e?void 0:e.find((function(e){return e.name===At})))?null===(t=p.view.current)||void 0===t?void 0:t.settings.find((function(e){return e.name===At})).value.reduce((function(e,t){var n=a(t);return n?[].concat(Object(ve.a)(e),[n]):e}),[]):[];h({type:wi.SET_FIELDS,fields:c});var s=Qu(p.view.current.filters);h({type:wi.SET_FILTERS,filters:p.view.current.filters}),h({type:wi.SET_QUERY_FILTERS,queryFilters:s});var d=(null===(n=p.view.current.sort)||void 0===n?void 0:n.field)||Rt.field,u=(null===(r=p.view.current.sort)||void 0===r?void 0:r.order)||Rt.order;k({variables:{limit:p.pagination,offset:p.offset,filters:s,sortField:d,sortOrder:u,fullText:p.fullText}}),g({variables:{key:x,value:p.view.current.id,global:!1}}),h({type:wi.SET_SORT,sort:{field:d,order:u,active:!0}}),h({type:wi.SET_DISPLAY,display:p.view.current.display}),h({type:wi.SET_VIEW,view:{current:p.view.current,reload:!1,sync:!0}})}}),[x,g,k,p.view,p.attributes,p.library.id,p.fullText,p.offset,p.pagination,p.queryFilters,p.sort,l,h,i,y]),Object(r.useEffect)((function(){var e,t,n,r;y&&(p.loading&&k({variables:{limit:p.pagination,offset:p.offset,filters:p.queryFilters,sortField:null!==(e=null===(t=p.sort)||void 0===t?void 0:t.field)&&void 0!==e?e:Rt.field,sortOrder:null!==(n=null===(r=p.sort)||void 0===r?void 0:r.order)&&void 0!==n?n:Rt.order,fullText:p.fullText}}))}),[p.fullText,p.offset,p.pagination,p.queryFilters,p.sort,p.loading,i.gqlNames.query,k,y]),A)return Object(B.jsx)(tt,{message:A.message});if(!y)return Object(B.jsx)(tt,{type:te.PERMISSION_ERROR});var N=n?!!v.searchSelection.selected.length||v.searchSelection.type===X.search&&v.searchSelection.allSelected:!!v.selection.selected.length||v.selection.type===X.search&&v.selection.allSelected;return Object(B.jsx)(Di.Provider,{value:{state:p,dispatch:h},children:Object(B.jsxs)(Ri.Provider,{value:n,children:[Object(B.jsxs)(wv,{children:[Object(B.jsx)(uj,{refetch:C}),Object(B.jsx)(Vj,{active:N})]}),Object(B.jsxs)(Sv,{showSide:j.side.visible,className:j.side.visible?"wrapper-open":"wrapper-close",children:[Object(B.jsx)(Tv,{}),Object(B.jsx)(Yu,{})]})]})})};var kv,Rv,Av,Cv,Nv,Lv,Vv,Dv,Fv,Pv=function(e){var t,n,i,a=e.library,l=yt(),c=Object(o.a)(l,1)[0].lang,s=Object(F.a)().t,d=Ve(),u=gt(),b=Object(o.a)(u,2),j=b[0],v=b[1],O=Le((function(e){return e})).activePanel,f=Xl({library:a}),p=f.loading,h=f.data,m=f.error,g=null===h||void 0===h||null===(t=h.libraries)||void 0===t||null===(n=t.list[0])||void 0===n?void 0:n.permissions.access_library;return Object(r.useEffect)((function(){var e;if(!p&&!m&&(null===h||void 0===h||null===(e=h.libraries)||void 0===e?void 0:e.list.length)&&O===J.LIBRARY&&g){var t=h.libraries.list[0],n=Mt(t.label,c);if(a!==(null===j||void 0===j?void 0:j.id)){var r=t.gqlNames,i=r.query,l=r.type,o=r.filter,u=r.searchableFields,b=t.attributes;v({id:a,name:n,filter:o,attributes:b,gql:{searchableFields:u,query:i,type:l},trees:t.linkedTrees,permissions:t.permissions})}var f={content:s("notification.active-lib",{lib:n}),type:Y.basic};d(he(f))}}),[j,h,d,m,c,a,p,s,v,O,g]),p?Object(B.jsx)(ja,{}):m?Object(B.jsx)(tt,{message:m.message}):(null===h||void 0===h||null===(i=h.libraries)||void 0===i?void 0:i.list.length)?g?Object(B.jsx)(Iv,{selectionMode:!1,library:h.libraries.list[0]},a):Object(B.jsx)(tt,{type:te.PERMISSION_ERROR}):Object(B.jsx)(tt,{message:s("lib_detail.not_found")})},Uv=Ke.a.div(kv||(kv=Object(Qe.a)(["\n    min-width: ",";\n    max-width: ",";\n\n    display: grid;\n    grid-template-columns: 1fr;\n    justify-items: center;\n    grid-template-rows: 25rem auto;\n    word-break: break-all;\n\n    background: ",";\n    border-right: 1px solid ",";\n\n    .header-detail {\n        width: 100%;\n    }\n"])),Je.a["@leav-navigation-column-details-width"],Je.a["@leav-navigation-column-details-width"],Je.a["@default-bg"],Je.a["@divider-color"]),Bv=Ke.a.div(Rv||(Rv=Object(Qe.a)(["\n    display: flex;\n    flex-flow: column nowrap;\n    justify-content: start;\n\n    & > * {\n        margin: 1rem;\n    }\n"]))),Hv=Ke.a.div(Av||(Av=Object(Qe.a)(["\n    span {\n        font-weight: 600;\n    }\n"]))),zv=Ke.a.div(Cv||(Cv=Object(Qe.a)(["\n    padding: 2rem;\n    height: 25rem;\n    width: 100%;\n"]))),Gv=function(e){var t,n=e.treeElement,r=Object(F.a)().t,i=n.record,a=i.whoAmI.label?i.whoAmI.label:r("navigation.list.info.no-label"),l=null===(t=i.whoAmI.preview)||void 0===t?void 0:t.big;return Object(B.jsxs)(Uv,{"data-testid":"details-column",children:[Object(B.jsx)(zv,{children:Object(B.jsx)(ka,{label:i.whoAmI.label?a:i.id,color:i.whoAmI.color,image:l&&Dt(l),tile:!0,style:{maxHeight:"20rem",maxWidth:"100%",height:"100%"}},i.id)}),Object(B.jsxs)(Bv,{children:[Object(B.jsxs)(Hv,{children:[Object(B.jsxs)("span",{children:[r("navigation.list.info.id"),":"]})," ",i.id]}),Object(B.jsxs)(Hv,{children:[Object(B.jsxs)("span",{children:[r("navigation.list.info.label"),":"]})," ",a]})]})]})},Mv=n(816),$v=n(811),Wv=n(812),Yv=n(813),qv=n(814),Qv=Ke.a.img(Nv||(Nv=Object(Qe.a)(["\n    transform: translate(0px, -1px) rotate(90deg);\n"]))),Kv=function(){return Object(B.jsx)("div",{children:Object(B.jsx)(Qv,{src:gn,alt:"icon ellipsis vertical"})})},Xv=Object(Ke.a)(mn.a)(Lv||(Lv=Object(Qe.a)(["\n    &&& {\n        background: ",";\n        font-weight: 600;\n\n        &&&&:hover,\n        &&&&:active,\n        &&&&:focus {\n            background: ",";\n        }\n    }\n"])),Je.a["@default-bg"],Je.a["@default-bg"]),Jv=function(e){return Object(B.jsx)(Xv,Object($.a)(Object($.a)({},e),{},{children:e.children}))},Zv=Object(Ot.a)(Vv||(Vv=Object(Qe.a)(["\n    mutation ADD_TREE_ELEMENT($treeId: ID!, $element: TreeElementInput!, $parent: ID, $order: Int) {\n        treeAddElement(treeId: $treeId, element: $element, parent: $parent, order: $order) {\n            id\n        }\n    }\n"]))),eO=Object(Ot.a)(Dv||(Dv=Object(Qe.a)(["\n    mutation REMOVE_TREE_ELEMENT($treeId: ID!, $nodeId: ID!, $deleteChildren: Boolean) {\n        treeDeleteElement(treeId: $treeId, nodeId: $nodeId, deleteChildren: $deleteChildren)\n    }\n"]))),tO=Object(Ot.a)(Fv||(Fv=Object(Qe.a)(["\n    query GET_TREE_LIBRARIES($treeId: ID!) {\n        trees(filters: {id: $treeId}) {\n            totalCount\n            list {\n                id\n                libraries {\n                    library {\n                        id\n                        label\n                    }\n                }\n            }\n        }\n    }\n"]))),nO=function(e){var t=Object(ls.a)();return{refreshTreeContent:function(){t.refetchQueries({updateCache:function(t){var n=t.extract();Object.keys(n.ROOT_QUERY).filter((function(t){return t.match(new RegExp("treeNodeChildren(.*)".concat(e)))})).forEach((function(e){return t.evict({fieldName:e})})),t.gc()}})}}};var rO,iO=function(e){var t,n,i,a=e.activeTree,l=e.isDetail,c=e.parent,s=Object(F.a)().t,d=Le((function(e){return{selectionState:e.selection,navigation:e.navigation}})),u=d.selectionState,b=d.navigation,j=Ve(),v=(Object(ls.a)(),yt()),O=Object(o.a)(v,1)[0].lang,f=Object(r.useState)(!1),p=Object(o.a)(f,2),h=p[0],m=p[1],g=Object(r.useState)(!1),x=Object(o.a)(g,2),y=x[0],E=x[1],_=Object(r.useState)(""),T=Object(o.a)(_,2),S=T[0],w=T[1],I=Object(r.useState)(!1),k=Object(o.a)(I,2),R=k[0],A=k[1],C=Object(r.useState)(""),N=Object(o.a)(C,2),L=N[0],V=N[1],D=Object(vt.a)(tO,{variables:{treeId:a.id}}).data,P=Object(sn.a)(Zv),U=Object(o.a)(P,1)[0],H=Object(sn.a)(eO),z=Object(o.a)(H,1)[0],G=nO(a.id).refreshTreeContent,M=function(e){V(e),m(!0)},W=function(){var e=Object(it.a)(rt.a.mark((function e(t){var n,r,i,l,o,d,u,b,v,O,f,p,h,m,g,x,y,E;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.selected.length){e.next=32;break}n={countValid:0,errors:{}},r=Object(Zi.a)(t.selected),e.prev=3,r.s();case 5:if((i=r.n()).done){e.next=19;break}return l=i.value,o={id:l.id,library:l.library},e.prev=8,e.next=11,U({variables:{treeId:a.id,element:o,parent:null!==(d=c.id)&&void 0!==d?d:null}});case 11:n=Object($.a)(Object($.a)({},n),{},{countValid:n.countValid+1}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(8),e.t0.graphQLErrors&&e.t0.graphQLErrors.length&&(v=null===(u=e.t0.graphQLErrors[0].extensions.fields)||void 0===u?void 0:u.parent,O=null===(b=e.t0.graphQLErrors[0].extensions.fields)||void 0===b?void 0:b.element,v&&(n.errors[v]=[].concat(Object(ve.a)(null!==(f=n.errors[v])&&void 0!==f?f:[]),[l.id])),O&&(n.errors[O]=[].concat(Object(ve.a)(null!==(p=n.errors[O])&&void 0!==p?p:[]),[l.label||l.id])));case 17:e.next=5;break;case 19:e.next=24;break;case 21:e.prev=21,e.t1=e.catch(3),r.e(e.t1);case 24:return e.prev=24,r.f(),e.finish(24);case 27:for(n.countValid&&(h={channel:Q.trigger,type:Y.success,content:s("navigation.notifications.success-add",{nb:n.countValid})},j(ge(h))),delete n.countValid,m=Object.keys(n.errors),g=0,x=m;g<x.length;g++)y=x[g],E={channel:Q.trigger,type:Y.warning,content:s("navigation.notifications.error-add",{elements:n.errors[y].reduce((function(e,t){return e?"".concat(e,", ").concat(t):"".concat(t)}),""),errorMessage:y})},j(ge(E));G();case 32:case"end":return e.stop()}}),e,null,[[3,21,24,27],[8,14]])})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(it.a)(rt.a.mark((function e(t){var n,r,i,l,o,d,u;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,U({variables:{treeId:a.id,element:{id:t.id,library:t.library.id},parent:null!==(r=c.id)&&void 0!==r?r:null}});case 3:n={channel:Q.trigger,type:Y.success,content:s("navigation.notifications.success-add",{nb:1})},e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),e.t0.graphQLErrors&&e.t0.graphQLErrors.length?(d=null===(i=e.t0.graphQLErrors[0].extensions.fields)||void 0===i?void 0:i.parent,u=null===(l=e.t0.graphQLErrors[0].extensions.fields)||void 0===l?void 0:l.element,n={channel:Q.trigger,type:Y.error,content:s("navigation.notifications.error-add",{elements:null!==(o=t.label)&&void 0!==o?o:t.id,errorMessage:d||u||""})}):n={channel:Q.trigger,type:Y.error,content:e.t0.message};case 9:j(ge(n)),G();case 11:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),K=function(e){return function(){A(!0),w(e)}},X=function(){var e=Object(it.a)(rt.a.mark((function e(){var t,n;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.record.whoAmI.label,e.prev=1,e.next=4,z({variables:{treeId:a.id,nodeId:c.id}});case 4:n={channel:Q.trigger,type:Y.success,content:s("navigation.notifications.success-detach",{nb:1})},e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),n={channel:Q.trigger,type:Y.error,content:s("navigation.notifications.error-detach",{elementName:null!==t&&void 0!==t?t:c.record.id,errorMessage:e.t0.message})};case 10:j(ge(n)),G();case 12:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}(),J=null!==(t=null===D||void 0===D?void 0:D.trees.list[0].libraries)&&void 0!==t?t:[],Z=c?c.permissions.edit_children:a.permissions.edit_children,ee=!!c&&c.permissions.detach;return Object(B.jsxs)(B.Fragment,{children:[h&&Object(B.jsx)(nc,{visible:h,setVisible:m,submitAction:W,libId:L}),y&&Object(B.jsx)(Ps,{open:y,library:c.record.whoAmI.library.id,record:c.record.whoAmI,onClose:function(){return E(!1)}}),R&&Object(B.jsx)(Ps,{open:R,library:S,record:null,onClose:function(){return A(!1)},afterCreate:q}),!u.selection.selected.length&&Object(B.jsxs)(B.Fragment,{children:[Z&&Object(B.jsx)(B.Fragment,{children:J.length>1?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(pn.a,{overlay:Object(B.jsx)(dn.a,{children:null===D||void 0===D?void 0:D.trees.list[0].libraries.map((function(e){return Object(B.jsx)(dn.a.Item,{onClick:function(){return M(e.library.id)},children:Mt(e.library.label,O)},e.library.id)}))}),children:Object(B.jsx)(Jv,{icon:Object(B.jsx)($v.a,{})})}),Object(B.jsx)(pn.a,{overlay:Object(B.jsx)(dn.a,{children:null===D||void 0===D?void 0:D.trees.list[0].libraries.map((function(e){return Object(B.jsx)(dn.a.Item,{onClick:K(e.library.id),children:Mt(e.library.label,O)},e.library.id)}))}),children:Object(B.jsx)(Jv,{icon:Object(B.jsx)(gl.a,{})})})]}):Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(Jv,{icon:Object(B.jsx)($v.a,{}),"aria-label":"add-by-search",onClick:function(){var e,t;return M(null!==(e=null===(t=J[0])||void 0===t?void 0:t.library.id)&&void 0!==e?e:null)}}),Object(B.jsx)(Jv,{icon:Object(B.jsx)(gl.a,{}),"aria-label":"add-by-creation",onClick:K(null!==(n=null===(i=J[0])||void 0===i?void 0:i.library.id)&&void 0!==n?n:null)})]})}),Object(B.jsx)("span",{"data-testid":"dropdown-tree-actions",children:Object(B.jsx)(pn.a,{placement:"bottomRight",overlay:Object(B.jsxs)(dn.a,{children:[!!c&&Object(B.jsxs)(B.Fragment,{children:[!l&&Object(B.jsx)(dn.a.Item,{icon:Object(B.jsx)(Wv.a,{}),onClick:function(){var e=[].concat(Object(ve.a)(b.path),[Object($.a)(Object($.a)({},c),{},{showDetails:!0})]);j(be(e))},children:s("navigation.actions.details")}),Object(B.jsx)(dn.a.Item,{icon:Object(B.jsx)(Yv.a,{}),onClick:function(){return E(!0)},children:s("navigation.actions.edit")})]}),Object(B.jsx)(dn.a.Item,{icon:Object(B.jsx)(Wl.a,{}),onClick:function(){return qn.b.warn(s("global.feature_not_available"))},children:s("navigation.actions.classified_in")}),Z&&Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(dn.a.Divider,{}),Object(B.jsx)(dn.a.Item,{icon:Object(B.jsx)(qv.a,{}),onClick:function(){return qn.b.warn(s("global.feature_not_available"))},children:s("navigation.actions.order")}),ee&&Object(B.jsx)(dn.a.Item,{icon:Object(B.jsx)(Al.a,{}),onClick:X,children:s("navigation.actions.detach")})]})]}),children:Object(B.jsx)(Jv,{icon:Object(B.jsx)(Kv,{})})})})]})]})},aO=n(815),lO=Object(Ot.a)(rO||(rO=Object(Qe.a)(["\n    mutation MOVE_TREE_ELEMENT($treeId: ID!, $nodeId: ID!, $parentTo: ID, $order: Int) {\n        treeMoveElement(treeId: $treeId, nodeId: $nodeId, parentTo: $parentTo, order: $order) {\n            id\n        }\n    }\n"])));var cO=function(e){var t=e.parent,n=(e.depth,Object(F.a)().t),r=Le((function(e){return{selectionState:e.selection,navigation:e.navigation}})),i=r.selectionState,a=r.navigation,l=Ve(),c=wr(),s=Object(o.a)(c,1)[0],d=Object(sn.a)(eO),u=Object(o.a)(d,1)[0],b=Object(sn.a)(Zv),j=Object(o.a)(b,1)[0],v=Object(sn.a)(lO),O=Object(o.a)(v,1)[0],f=nO(s.id).refreshTreeContent,p=function(e,t,r){if(r.countValid){var i={channel:Q.trigger,type:Y.success,content:n(e,{nb:r.countValid})};l(ge(i))}delete r.countValid;for(var a=0,c=Object.keys(r.errors);a<c.length;a++){var o=c[a],s={channel:Q.trigger,type:Y.warning,content:n(t,{elements:r.errors[o].reduce((function(e,t){return e?"".concat(e,", ").concat(t):"".concat(t)}),""),errorMessage:o})};l(ge(s))}},h=function(){var e=Object(it.a)(rt.a.mark((function e(){var r,a,c,o,d,u,b,v,O,h,m,g,x,y;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i.selection.selected.length){e.next=32;break}a={countValid:0,errors:{}},c=null!==(r=t.id)&&void 0!==r?r:null,o=Object(Zi.a)(i.selection.selected),e.prev=4,o.s();case 6:if((d=o.n()).done){e.next=20;break}return u=d.value,b={id:u.id,library:u.library},e.prev=9,e.next=12,j({variables:{treeId:s.id,element:b,parent:c}});case 12:a=Object($.a)(Object($.a)({},a),{},{countValid:a.countValid+1}),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(9),e.t0.graphQLErrors&&e.t0.graphQLErrors.length&&(h=null===(v=e.t0.graphQLErrors[0].extensions.fields)||void 0===v?void 0:v.parent,m=null===(O=e.t0.graphQLErrors[0].extensions.fields)||void 0===O?void 0:O.element,h&&(a.errors[h]=[].concat(Object(ve.a)(null!==(g=a.errors[h])&&void 0!==g?g:[]),[u.id])),m&&(a.errors[m]=[].concat(Object(ve.a)(null!==(x=a.errors[m])&&void 0!==x?x:[]),[u.label||u.id])));case 18:e.next=6;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(4),o.e(e.t1);case 25:return e.prev=25,o.f(),e.finish(25);case 28:p("navigation.notifications.success-add","navigation.notifications.error-add",a),f(),e.next=34;break;case 32:y={channel:Q.trigger,type:Y.warning,content:n("navigation.notifications.warning-add-no-selection")},l(ge(y));case 34:l(we());case 35:case"end":return e.stop()}}),e,null,[[4,22,25,28],[9,15]])})));return function(){return e.apply(this,arguments)}}(),m=function(){var e=Object(it.a)(rt.a.mark((function e(){var n,r,a,c,o,d,u,b,j,v,h,m;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r={countValid:0,errors:{}},a=null!==(n=null===t||void 0===t?void 0:t.id)&&void 0!==n?n:null,c=Object(Zi.a)(i.selection.selected),e.prev=3,c.s();case 5:if((o=c.n()).done){e.next=18;break}return d=o.value,e.prev=7,e.next=10,O({variables:{treeId:s.id,nodeId:d.nodeId,parentTo:a}});case 10:r.countValid++,e.next=16;break;case 13:e.prev=13,e.t0=e.catch(7),e.t0.graphQLErrors&&e.t0.graphQLErrors.length&&(j=null===(u=e.t0.graphQLErrors[0].extensions.fields)||void 0===u?void 0:u.parent,v=null===(b=e.t0.graphQLErrors[0].extensions.fields)||void 0===b?void 0:b.element,j&&(r.errors[j]=[].concat(Object(ve.a)(null!==(h=r.errors[j])&&void 0!==h?h:[]),[d.id])),v&&(r.errors[v]=[].concat(Object(ve.a)(null!==(m=r.errors[v])&&void 0!==m?m:[]),[d.label||d.id])));case 16:e.next=5;break;case 18:e.next=23;break;case 20:e.prev=20,e.t1=e.catch(3),c.e(e.t1);case 23:return e.prev=23,c.f(),e.finish(23);case 26:f(),p("navigation.notifications.success-move","navigation.notifications.error-move",r),l(we());case 29:case"end":return e.stop()}}),e,null,[[3,20,23,26],[7,13]])})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=Object(it.a)(rt.a.mark((function e(){var t,n,r,c,o,d,b,j,v,O,h,m;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.selection.type!==X.navigation){e.next=33;break}t={countValid:0,errors:{}},n=[],r=Object(Zi.a)(i.selection.selected),e.prev=4,r.s();case 6:if((c=r.n()).done){e.next=20;break}return o=c.value,e.prev=8,e.next=11,u({variables:{treeId:s.id,nodeId:o.nodeId}});case 11:t.countValid++,n.push(o.nodeId),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(8),e.t0.graphQLErrors&&e.t0.graphQLErrors.length&&(j=null===(d=e.t0.graphQLErrors[0].extensions.fields)||void 0===d?void 0:d.parent,v=null===(b=e.t0.graphQLErrors[0].extensions.fields)||void 0===b?void 0:b.element,j&&(t.errors[j]=[].concat(Object(ve.a)(null!==(O=t.errors[j])&&void 0!==O?O:[]),[o.id])),v&&(t.errors[v]=[].concat(Object(ve.a)(null!==(h=t.errors[v])&&void 0!==h?h:[]),[o.label||o.id])));case 18:e.next=6;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(4),r.e(e.t1);case 25:return e.prev=25,r.f(),e.finish(25);case 28:f(),p("navigation.notifications.success-detach","navigation.notifications.error-detach",t),l(we()),m=a.path.filter((function(e){return!n.includes(e.id)})),l(be(m));case 33:case"end":return e.stop()}}),e,null,[[4,22,25,28],[8,15]])})));return function(){return e.apply(this,arguments)}}(),x=i.selection.type===X.navigation,y=i.selection.type===X.navigation&&i.selection.parent===(null===t||void 0===t?void 0:t.id),E=t?t.permissions.edit_children:s.permissions.edit_children;return i.selection.selected.length?Object(B.jsxs)(B.Fragment,{children:[!y&&E&&Object(B.jsx)(Jv,{icon:Object(B.jsx)(gl.a,{}),onClick:h,"aria-label":"add-selection",title:n("navigation.actions.add-selected")}),x&&E&&!y&&Object(B.jsx)(Jv,{onClick:m,icon:Object(B.jsx)(aO.a,{}),"aria-label":"move-selection",title:n("navigation.actions.move-selected")}),x&&Object(B.jsx)(Jv,{onClick:g,"aria-label":"detach-selection",icon:Object(B.jsx)(Al.a,{}),title:n("navigation.actions.detach-selected")})]}):Object(B.jsx)(B.Fragment,{})};var oO,sO=function(e){var t=e.depth,n=e.isDetail,r=t,i=Le((function(e){return e.navigation})),a=wr(),l=Object(o.a)(a,1)[0],c=i.path[r-1];return l?Object(B.jsxs)(D.a.Group,{style:{height:"30px"},children:[Object(B.jsx)(cO,{parent:c,depth:t}),Object(B.jsx)(iO,{activeTree:l,parent:c,isDetail:n})]}):Object(B.jsx)(B.Fragment,{})},dO=Ke.a.header(oO||(oO=Object(Qe.a)(["\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 1rem;\n    background: ",";\n    height: 4rem;\n    flex-shrink: 0;\n    cursor: pointer;\n    max-width: ",";\n\n    &:not(:hover) .select-all-checkbox {\n        visibility: hidden;\n    }\n"])),Je.a["@item-active-bg"],Je.a["@leav-navigation-column-details-width"]);var uO,bO,jO,vO=function(e){var t=e.depth,n=e.isDetail,r=e.isActive,i=e.treeElement,a=e.children,l=Object(F.a)().t,c=Le((function(e){return{navigation:e.navigation,selectionState:e.selection}})),s=c.navigation,d=c.selectionState,u=Ve(),b=t,j=wr(),v=Object(o.a)(j,1)[0],O=d.selection.selected.length,f=s.path[b-1],p=(null===i||void 0===i?void 0:i.record)?i.record.whoAmI.label||i.record.id:(null===v||void 0===v?void 0:v.label)||(null===v||void 0===v?void 0:v.id);return Object(B.jsxs)(dO,{onClick:function(){r||u(be(f?s.path.slice(0,b):[]))},isActive:r,children:[O&&r?Object(B.jsxs)(fn.a,{title:l("navigation.header.nb-selection",{nb:O,selectionType:l("search.type.".concat(X[d.selection.type]))}),placement:"right",children:[O,Object(B.jsx)(D.a,{icon:Object(B.jsx)(Mv.a,{}),"aria-label":"clear-selection",onClick:function(){u(we())},style:{border:"none",color:"#000"},ghost:!0})]}):Object(B.jsxs)(B.Fragment,{children:[r&&!n&&Object(B.jsx)(Xn.a,{className:"select-all-checkbox",onClick:function(){var e,t=a.filter((function(e){return e.permissions.access_tree})).map((function(e){return{id:e.record.whoAmI.id,nodeId:e.id,library:e.record.whoAmI.library.id,label:e.record.whoAmI.label}}));u(Se({type:X.navigation,selected:t,parent:null!==(e=null===i||void 0===i?void 0:i.id)&&void 0!==e?e:null}))}}),Object(B.jsx)(zi.a,{ellipsis:{tooltip:p,rows:1},style:{marginBottom:0,marginRight:".5em"},children:p})]}),r&&Object(B.jsx)(sO,{depth:t,isDetail:n})]})},OO=n(817),fO=n(818),pO=Ke.a.div(uO||(uO=Object(Qe.a)(["\n    position: relative;\n    display: grid;\n\n    place-items: flex-start;\n    align-items: center;\n    max-width: ",";\n\n    grid-template-columns: ",";\n    padding: 1rem;\n    background: ",";\n\n    &:hover {\n        ",";\n\n        .checkbox-wrapper {\n            opacity: 1;\n        }\n    }\n\n    .counter {\n        justify-self: flex-end;\n    }\n"])),Je.a["@leav-navigation-column-width"],(function(e){return e.isActive?"1rem auto auto 1rem":"auto auto 1rem"}),(function(e){return e.isInPath?Je.a["@leav-background-active"]:"none"}),(function(e){return e.isInPath?"":"background: ".concat(Je.a["@item-hover-bg"])})),hO=Ke.a.div(bO||(bO=Object(Qe.a)(["\n    & > * > * {\n        justify-content: space-around;\n    }\n"]))),mO=Ke.a.div(jO||(jO=Object(Qe.a)(["\n    opacity: ",";\n    transition: 100ms ease;\n\n    :hover {\n        opacity: 1;\n    }\n"])),(function(e){return e.selectionActive?1:0}));var gO,xO,yO,EO,_O=function(e){var t=e.isActive,n=e.treeElement,r=e.depth,i=yt(),a=Object(o.a)(i,1)[0].lang,l=Object(F.a)().t,c=Le((function(e){return{selectionState:e.selection,navigation:e.navigation}})),s=c.selectionState,d=c.navigation,u=Ve(),b=d.path[r-1],j=n.record.whoAmI.label,v=n.permissions.access_tree,O=Object($.a)(Object($.a)({},n.record.whoAmI),{},{label:null!==j&&void 0!==j?j:""}),f=d.path.some((function(e){return e.record.id===n.record.id&&e.record.whoAmI.library.id===n.record.whoAmI.library.id})),p=s.selection.selected.some((function(e){return e.nodeId===n.id}));return Object(B.jsxs)(pO,{onClick:function(){if(v){var e=[].concat(Object(ve.a)(d.path.slice(0,r)),[Object($.a)({},n)]);u(be(e))}},isInPath:f,isActive:t,children:[!v&&Object(B.jsx)(fn.a,{title:l("navigation.access_denied"),children:Object(B.jsx)(OO.a,{})}),t&&v&&Object(B.jsx)(mO,{onClick:function(e){e.preventDefault(),e.stopPropagation()},className:"checkbox-wrapper",selectionActive:!!s.selection.selected.length,children:Object(B.jsx)(ac.a,{onClick:function(e){if(e.preventDefault(),e.stopPropagation(),s.selection.selected.find((function(e){return e.nodeId===n.id}))){var t=s.selection.selected.filter((function(e){return e.nodeId!==n.id})),r={type:X.navigation,selected:t,parent:null===b||void 0===b?void 0:b.id};u(Se(r))}else{var i=Mt(n.record.whoAmI.label,a),l={id:n.record.whoAmI.id,nodeId:n.id,library:n.record.whoAmI.library.id,label:i},c=[l];s.selection.type===X.navigation&&(null===b||void 0===b?void 0:b.id)===s.selection.parent&&(c=[].concat(Object(ve.a)(s.selection.selected),[l]));var o={type:X.navigation,selected:c,parent:null===b||void 0===b?void 0:b.id};u(Se(o))}},checked:p})}),Object(B.jsx)(fn.a,{title:n.record.whoAmI.label,children:Object(B.jsx)(hO,{children:Object(B.jsx)(Ba,{record:O,size:x.small})})}),!!n.childrenCount&&Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("div",{className:"counter",children:Object(B.jsx)(Hr.a,{count:n.childrenCount,overflowCount:1e3})}),Object(B.jsx)("div",{children:v&&Object(B.jsx)(fO.a,{})})]})]})},TO=Ke.a.div(gO||(gO=Object(Qe.a)(["\n    border-right: 1px solid ",";\n    width: ",";\n    height: 100%;\n    display: flex;\n    flex-flow: column nowrap;\n    flex-shrink: 0;\n\n    background: ",";\n"])),Je.a["@divider-color"],(function(e){return e.showDetails?Je.a["@leav-navigation-column-details-width"]:Je.a["@leav-navigation-column-width"]}),Je.a["@default-bg"]),SO=Ke.a.div(xO||(xO=Object(Qe.a)(["\n    overflow-y: auto;\n    height: 100%;\n"]))),wO=Object(Ke.a)(qi.a)(yO||(yO=Object(Qe.a)(["\n    && {\n        text-align: center;\n        padding: 0.5em 0;\n        border-bottom: 1px solid ",";\n    }\n"])),Je.a["@border-color-base"]),IO=function(e){var t,n,i=e.treeElement,a=e.depth,l=e.isActive,c=wr(),s=Object(o.a)(c,1)[0],d=Object(r.useState)(1),u=Object(o.a)(d,2),b=u[0],j=u[1],v=Object(r.useState)(0),O=Object(o.a)(v,2),f=O[0],p=O[1],h={treeId:null===s||void 0===s?void 0:s.id,node:null!==(t=null===i||void 0===i?void 0:i.id)&&void 0!==t?t:null,pagination:{limit:Vt,offset:(b-1)*Vt}},m=Object(vt.a)(ko,{variables:h,onCompleted:function(e){p(e.treeNodeChildren.totalCount)},skip:!s}),g=m.loading,x=m.error,y=m.data,E=m.refetch,_=m.called,T=Object(r.createRef)();Object(r.useEffect)((function(){var e,t;(null===T||void 0===T||null===(e=T.current)||void 0===e?void 0:e.scrollIntoView)&&l&&(null===(t=T.current)||void 0===t||t.scrollIntoView({behavior:"smooth",block:"end"}))}),[T,l]),Object(r.useEffect)((function(){s&&_&&E(h)}),[b]);var S=null!==(n=null===y||void 0===y?void 0:y.treeNodeChildren.list)&&void 0!==n?n:[],w=!x,I=i&&(!g&&!f||i.showDetails);return Object(B.jsxs)(TO,{ref:T,"data-testid":"navigation-column".concat(I?"-with-details":""),showDetails:I,children:[Object(B.jsx)(vO,{depth:a,treeElement:i,isActive:l,isDetail:I,children:S}),x&&Object(B.jsx)(tt,{message:x.message}),w&&!I&&Object(B.jsxs)(B.Fragment,{children:[f>Vt&&l&&Object(B.jsx)(wO,{simple:!0,current:b,total:f,onChange:function(e){j(e)},pageSize:Vt}),g?Object(B.jsx)(ja,{}):Object(B.jsx)(SO,{children:S.map((function(e){return Object(B.jsx)(_O,{treeElement:e,depth:a,isActive:l},e.id)}))})]}),w&&I&&Object(B.jsx)(Gv,{treeElement:i})]})},kO=Ke.a.div(EO||(EO=Object(Qe.a)(["\n    width: auto;\n    height: calc(100vh - 6rem);\n    display: flex;\n    flex-flow: row nowrap;\n    overflow-x: scroll;\n    overflow-y: hidden;\n"])));var RO=function(e){var t=e.tree,n=Le((function(e){return e.navigation})),i=Ve();Object(r.useEffect)((function(){i(ue(t))}),[t,i]);var a=0===n.path.length;return Object(B.jsxs)(kO,{children:[Object(B.jsx)(IO,{treeElement:null,depth:0,isActive:a},"__root__"),n.path.map((function(e,t){var r;return Object(B.jsx)(IO,{treeElement:e,depth:t+1,isActive:t===n.path.length-1},"".concat(e.record.id,"_").concat(null!==(r=e.showDetails)&&void 0!==r&&r))}))]})};var AO,CO=function(e){var t,n,i=e.tree,a=Object(F.a)().t,l=Ve(),c=Le((function(e){return e})).activePanel,s=yt(),d=Object(o.a)(s,1)[0].lang,u=wr(),b=Object(o.a)(u,2),j=b[0],v=b[1],O=pr({onlyAllowed:!1,treeId:i,skip:!i}),f=O.data,p=O.loading,h=O.error,m=null===f||void 0===f||null===(t=f.trees)||void 0===t||null===(n=t.list[0])||void 0===n?void 0:n.permissions.access_tree;return Object(r.useEffect)((function(){var e;if(c===J.TREE&&m){var t=null===f||void 0===f||null===(e=f.trees)||void 0===e?void 0:e.list[0];if(!p&&t){var n=Mt(t.label,d);v({id:t.id,label:n,libraries:t.libraries.map((function(e){return{id:e.library.id}})),permissions:t.permissions});var r={content:a("notification.active-tree",{tree:n}),type:Y.basic};l(he(r))}}}),[f,p,d,v,a,l,c,j,i,m]),p?Object(B.jsx)(ja,{}):h?Object(B.jsx)(tt,{message:h.message}):m?Object(B.jsx)(RO,{tree:i}):Object(B.jsx)(tt,{type:te.PERMISSION_ERROR})},NO=Ke.a.div(AO||(AO=Object(Qe.a)(["\n    display: ",";\n"])),(function(e){return e.isActive?"block":"none"}));var LO=function(){var e=Ve(),t=Object(et.g)(),n=t.panel,i=t.entityId,a=null===n||void 0===n?void 0:n.toLowerCase();Object.values(J).includes(a)||(a=J.HOME);var l=gt(),c=Object(o.a)(l,1)[0],s=wr(),d=Object(o.a)(s,1)[0],u=a===J.HOME,b=a===J.LIBRARY,j=a===J.TREE,v=b?i:null===c||void 0===c?void 0:c.id,O=j?i:null===d||void 0===d?void 0:d.id;return Object(r.useEffect)((function(){e(re(a))}),[a,e]),Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(NO,{isActive:u,className:J.HOME,children:Object(B.jsx)(Ii,{})}),Object(B.jsx)(NO,{isActive:b,className:J.LIBRARY,children:Object(B.jsx)(Pv,{library:v},v)}),Object(B.jsx)(NO,{isActive:j,className:J.TREE,children:Object(B.jsx)(CO,{tree:O},O)})]})};var VO=function(){return Object(B.jsx)("h1",{children:"404"})},DO="/",FO="/:panel(home)",PO="/:panel(tree|library)/:entityId";var UO=function(){return Object(B.jsxs)(et.c,{children:[Object(B.jsx)(et.a,{exact:!0,path:DO,children:Object(B.jsx)(LO,{})}),Object(B.jsx)(et.a,{exact:!0,path:FO,children:Object(B.jsx)(LO,{})}),Object(B.jsx)(et.a,{exact:!0,path:PO,children:Object(B.jsx)(LO,{})}),Object(B.jsx)(et.a,{children:Object(B.jsx)(VO,{})})]})},BO=nn.a.Header,HO=nn.a.Content,zO=nn.a.Sider;var GO=function(){var e=Object(r.useState)(!1),t=Object(o.a)(e,2),n=t[0],i=t[1];return Object(B.jsx)(B.Fragment,{children:Object(B.jsx)(Ln.a,{children:Object(B.jsxs)(nn.a,{style:{height:"100vh"},children:[Object(B.jsx)(zO,{theme:"light",collapsible:!0,defaultCollapsed:!0,collapsedWidth:60,width:250,style:{borderRight:"1px solid #DDD"},children:Object(B.jsx)(Pr,{})}),Object(B.jsxs)(nn.a,{children:[Object(B.jsx)(BO,{style:{height:Je.a["@leav-header-height"],padding:0},children:Object(B.jsx)(di,{userPanelVisible:n,toggleUserPanelVisible:function(){i((function(e){return!e}))}})}),Object(B.jsx)(nn.a,{style:{overflow:"hidden",position:"relative"},children:Object(B.jsxs)(HO,{style:{background:Je.a["@default-bg"],overflow:"hidden"},children:[Object(B.jsx)(yi,{userPanelVisible:n,hideUserPanel:function(){return i(!1)}}),Object(B.jsx)(UO,{})]})})]})]})})})};var MO=function(){var e,t=Object(F.a)().i18n,n=function(e){var t,n;return[e.language?e.language.split("-")[0]:null!==(t=y[Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_DEFAULT_LANG])&&void 0!==t?t:y.en,(null===(n=e.options)||void 0===n?void 0:n.fallbackLng)?e.options.fallbackLng[0]:""]}(t),i=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_AVAILABLE_LANG?Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_AVAILABLE_LANG.split(",").map((function(e){return y[e]})):[],a=null!==(e=null===y||void 0===y?void 0:y[t.language.split("-")[0]])&&void 0!==e?e:y.en,l=yt(),c=Object(o.a)(l,2),s=c[0],d=c[1],u=gt(),b=Object(o.a)(u,2),j=b[0],v=b[1],O=_t(),f=Object(o.a)(O,2),p=f[0],h=f[1],m=Object(vt.a)(pt),g=m.data,x=m.loading,E=m.error;return Object(r.useEffect)((function(){s.lang.length||d({lang:n,availableLangs:i,defaultLang:a})}),[d,s.lang,n,i,a]),Object(r.useEffect)((function(){j||v(mt)}),[v,j]),Object(r.useEffect)((function(){p||!g||x||h({userId:g.me.id,userName:g.me.whoAmI.label||g.me.login,userPermissions:{}})}),[h,p,x,g]),E?Object(B.jsx)(tt,{message:E.message}):Object(B.jsx)(GO,{})},$O={dark:"".concat("","/explorer-prod/dark-theme.css"),light:"".concat("","/explorer-prod/light-theme.css")};var WO=function(){return Object(B.jsx)(a.ThemeSwitcherProvider,{themeMap:$O,defaultTheme:"light",children:Object(B.jsx)(MO,{})})};var YO=function(e){var t=e.token,n=e.onTokenInvalid;return Object(B.jsx)(G.a,{store:De,children:Object(B.jsx)(jt,{token:t,onTokenInvalid:n,children:Object(B.jsx)(WO,{})})})};var qO=function(e){var t=e.url,n=d(),i=n.getToken,a=n.saveToken,l=n.deleteToken,c=Object(r.useState)(i()),s=Object(o.a)(c,2),u=s[0],b=s[1],j=Object(r.useState)(""),v=Object(o.a)(j,2),O=v[0],f=v[1],p=function(e){a(e),b(e)};return u?Object(B.jsx)(r.Suspense,{fallback:"Loader",children:Object(B.jsx)(YO,{token:u,onTokenInvalid:function(e){return l(),b(""),e&&f(e),Object(B.jsx)(z,{onSuccess:p,message:O,url:t})}})}):Object(B.jsx)(r.Suspense,{fallback:"Loader",children:Object(B.jsx)(z,{onSuccess:p,message:O,url:t})})},QO=n(323),KO=n(420),XO=n(421),JO=n(225);QO.a.use(JO.e).use(XO.a).use(KO.a).init({fallbackLng:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_DEFAULT_LANG,ns:["translations"],defaultNS:"translations",react:{useSuspense:!0}});QO.a,n.p,Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ZO={dark:"".concat("","/explorer-prod/dark-theme.css"),light:"".concat("","/explorer-prod/light-theme.css")};c.a.render(Object(B.jsx)(a.ThemeSwitcherProvider,{themeMap:ZO,defaultTheme:"light",children:Object(B.jsx)(qO,{url:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_AUTH_URL||""})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[717,1,2]]]);
//# sourceMappingURL=main.c3525719.chunk.js.map